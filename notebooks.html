

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>&lt;no title&gt; &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Notebooks with MyST Markdown" href="markdown-notebooks.html" />
    <link rel="prev" title="Markdown Files" href="markdown.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/notebooks.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><no title></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="simple visible nav section-nav flex-column">
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p>PARCIAL CORRECCION</p>
<p>PUNTO 4 EDA</p>
<p>FRAUD EDA</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pandas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pandas in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (2.1.1)
Requirement already satisfied: numpy&gt;=1.22.4 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from pandas) (1.26.1)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from pandas) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from pandas) (2023.3.post1)
Requirement already satisfied: tzdata&gt;=2022.1 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from pandas) (2023.3)
Requirement already satisfied: six&gt;=1.5 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas) (1.16.0)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">matplotlib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: matplotlib in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (3.8.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib) (1.1.1)
Requirement already satisfied: cycler&gt;=0.10 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib) (4.43.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib) (1.4.5)
Requirement already satisfied: numpy&lt;2,&gt;=1.21 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib) (1.26.1)
Requirement already satisfied: packaging&gt;=20.0 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib) (23.2)
Requirement already satisfied: pillow&gt;=6.2.0 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib) (10.1.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib) (3.1.1)
Requirement already satisfied: python-dateutil&gt;=2.7 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib) (2.8.2)
Requirement already satisfied: importlib-resources&gt;=3.2.0 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib) (6.1.0)
Requirement already satisfied: zipp&gt;=3.1.0 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from importlib-resources&gt;=3.2.0-&gt;matplotlib) (3.17.0)
Requirement already satisfied: six&gt;=1.5 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib) (1.16.0)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">seaborn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: seaborn in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (0.13.0)
Requirement already satisfied: numpy!=1.24.0,&gt;=1.20 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from seaborn) (1.26.1)
Requirement already satisfied: pandas&gt;=1.2 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from seaborn) (2.1.1)
Requirement already satisfied: matplotlib!=3.6.1,&gt;=3.3 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from seaborn) (3.8.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.3-&gt;seaborn) (1.1.1)
Requirement already satisfied: cycler&gt;=0.10 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.3-&gt;seaborn) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.3-&gt;seaborn) (4.43.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.3-&gt;seaborn) (1.4.5)
Requirement already satisfied: packaging&gt;=20.0 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.3-&gt;seaborn) (23.2)
Requirement already satisfied: pillow&gt;=6.2.0 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.3-&gt;seaborn) (10.1.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.3-&gt;seaborn) (3.1.1)
Requirement already satisfied: python-dateutil&gt;=2.7 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.3-&gt;seaborn) (2.8.2)
Requirement already satisfied: importlib-resources&gt;=3.2.0 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from matplotlib!=3.6.1,&gt;=3.3-&gt;seaborn) (6.1.0)
Requirement already satisfied: pytz&gt;=2020.1 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from pandas&gt;=1.2-&gt;seaborn) (2023.3.post1)
Requirement already satisfied: tzdata&gt;=2022.1 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from pandas&gt;=1.2-&gt;seaborn) (2023.3)
Requirement already satisfied: zipp&gt;=3.1.0 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from importlib-resources&gt;=3.2.0-&gt;matplotlib!=3.6.1,&gt;=3.3-&gt;seaborn) (3.17.0)
Requirement already satisfied: six&gt;=1.5 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib!=3.6.1,&gt;=3.3-&gt;seaborn) (1.16.0)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">scikit</span><span class="o">-</span><span class="n">learn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: scikit-learn in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (1.3.1)
Requirement already satisfied: numpy&lt;2.0,&gt;=1.17.3 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from scikit-learn) (1.26.1)
Requirement already satisfied: scipy&gt;=1.5.0 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from scikit-learn) (1.11.3)
Requirement already satisfied: joblib&gt;=1.1.1 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from scikit-learn) (1.3.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from scikit-learn) (3.2.0)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">xgboost</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: xgboost in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (2.0.0)
Requirement already satisfied: numpy in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from xgboost) (1.26.1)
Requirement already satisfied: scipy in c:\users\hp\anaconda3\envs\ml_venv\lib\site-packages (from xgboost) (1.11.3)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">joblib</span>
</pre></div>
</div>
</div>
</div>
<p>Cargamos la base de datos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transaction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span> <span class="p">(</span><span class="s2">&quot;C:/Users/hp/Downloads/train_identity/train_transaction.csv&quot;</span><span class="p">)</span>

<span class="n">identity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span> <span class="p">(</span><span class="s2">&quot;C:/Users/hp/Downloads/train_identity/train_identity.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">identity</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span> <span class="s1">&#39;TransactionID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>...</th>
      <th>id_31</th>
      <th>id_32</th>
      <th>id_33</th>
      <th>id_34</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>id_38</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>0</td>
      <td>86400</td>
      <td>68.5</td>
      <td>W</td>
      <td>13926</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>discover</td>
      <td>142.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>0</td>
      <td>86401</td>
      <td>29.0</td>
      <td>W</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>0</td>
      <td>86469</td>
      <td>59.0</td>
      <td>W</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>0</td>
      <td>86499</td>
      <td>50.0</td>
      <td>W</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>0</td>
      <td>86506</td>
      <td>50.0</td>
      <td>H</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>samsung browser 6.2</td>
      <td>32.0</td>
      <td>2220x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>mobile</td>
      <td>SAMSUNG SM-G892A Build/NRD90M</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 434 columns</p>
</div></div></div>
</div>
<p>En la base  de datos existen alrededor de 403 variables. Dentro de estas encontramos TransactionID, teniendo valores reales ya que son direcciones. Por otro lado, la variable isFraud indica si hay fraude(1) o no hay fraude (0). Encontramos la variable TransactionDT y TransactionAmt las culaes indican movimientos, podemos observar que la variable TransactionDT tiene un comportamiento bastante homogeneo, teniendo encuenta su media y cuartil 2. Tambien, la variable TransactionAmt Sigue una distribución sesgada hacia la derecha, lo que quiere decir que exite mayor frecuencia de transaciones hacia este lado izquierdo y existen menos transacciones hacia el lado derecho de la distribución.</p>
<p>VISUALIZACION DE DATOS</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;Distribucion Fraude&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">datos</span><span class="o">.</span><span class="n">isFraud</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span> <span class="p">(</span><span class="s1">&#39;1= yes, 0= no&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08c3992830b02926d9fd9bcb41b67fccad90acc7b8dc3c607e8c137784869465.png" src="_images/08c3992830b02926d9fd9bcb41b67fccad90acc7b8dc3c607e8c137784869465.png" />
</div>
</div>
<p>El gráfico indica que existen menor proporción de fraude. Además podemos notar que hay un desbalance en la variable respuesta lo que podria influir en nuestro analisis.</p>
<p>GRAFICA DE LA DISTRIBUCION DE LAS TRANSACCIONES</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">datos</span><span class="p">[</span><span class="n">datos</span><span class="p">[</span><span class="s1">&#39;TransactionAmt&#39;</span><span class="p">]</span><span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">][</span><span class="s1">&#39;TransactionAmt&#39;</span><span class="p">])</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribucion-transacciones&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probabilidad&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Probabilidad&#39;)
</pre></div>
</div>
<img alt="_images/33d6f91f1058e21b3bb714eda9fab83eb9421ab4f3daa318d5ad414c70f85168.png" src="_images/33d6f91f1058e21b3bb714eda9fab83eb9421ab4f3daa318d5ad414c70f85168.png" />
</div>
</div>
<p>En la grafica anterior se puede notar el sesgo a la derecha y esto es normal porque el comportamiento apropiado es realizar transacciones pequeñas. Igual podemos notar que las transacciones grandes son pocas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="o">.</span><span class="n">ProductCD</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ProductCD
W    439670
C     68519
R     37699
H     33024
S     11628
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;T de compra&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">datos</span><span class="o">.</span><span class="n">ProductCD</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tipo de compra&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f576d491e2204ec0dcc89329b1c7333aa40d29047d8d895d52d2dd4b6884a2d0.png" src="_images/f576d491e2204ec0dcc89329b1c7333aa40d29047d8d895d52d2dd4b6884a2d0.png" />
</div>
</div>
<p>Con respecto a los productos, existe un mayor tipo de compra W, seguido del tipo de compra C, R, H y finalmente S. Con base a esto es posible sugerir que las transacciones que se realizan frecuentemente pertenecen al tipo W.</p>
<p>FUNCION FOR</p>
<p>En este algoritmo, se seleccionan las Columnas tipo Numéricas y se insertan a una lista llamada num_cols que contiene los nombres de las columnas numéricas del conjunto de datos datos. Se realiza un for para Análisis y Visualización de Columnas Numéricas. En este se recorre cada columna numérica en la lista num_col, se verifica si el nombre de la columna comienza con ‘V’ y es un número entre 1 y 339 (Puesto que existen 339 variables de tipo V y no aportan mucho a este análisis). Luego, se imprime el nombre de la columna, su sesgo (skewness) y su curtosis (kurtosis)y finalmente, se crea una figura con dos subplots: un histograma y un boxplot.</p>
<p>Procedi a trabajar solo con 100000 datos ya que no tenia memoria suficiente para trabajar con la base de datos completa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sdatos</span><span class="o">=</span> <span class="n">datos</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">num_cols</span> <span class="o">=</span> <span class="n">sdatos</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">&lt;=</span> <span class="mi">339</span><span class="p">:</span>
        <span class="k">continue</span>  
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Column: &#39;</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skew:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">sdatos</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Kurtosis: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">sdatos</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">sdatos</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sdatos</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  TransactionID
Skew: 0.0
Kurtosis:  -1.2
</pre></div>
</div>
<img alt="_images/0967f4d1096a9abe8d681fbd015505ae8b861e4a5ff1e55b0a0e609aff46488d.png" src="_images/0967f4d1096a9abe8d681fbd015505ae8b861e4a5ff1e55b0a0e609aff46488d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  isFraud
Skew: 6.01
Kurtosis:  34.08
</pre></div>
</div>
<img alt="_images/965a8efc1209677da2b6916065b43a2bec1af016237c130ffe23793875a0804a.png" src="_images/965a8efc1209677da2b6916065b43a2bec1af016237c130ffe23793875a0804a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  TransactionDT
Skew: -0.19
Kurtosis:  -1.22
</pre></div>
</div>
<img alt="_images/baf36bbdb25f37e36ff10cccfb3f51d40fe5c5233e44444047afc1d37edda587.png" src="_images/baf36bbdb25f37e36ff10cccfb3f51d40fe5c5233e44444047afc1d37edda587.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  TransactionAmt
Skew: 6.78
Kurtosis:  70.16
</pre></div>
</div>
<img alt="_images/432c8c5a0a264034487d1dcb1d303f22423ba054697e5dd2a0a5234d413a616a.png" src="_images/432c8c5a0a264034487d1dcb1d303f22423ba054697e5dd2a0a5234d413a616a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  card1
Skew: -0.03
Kurtosis:  -1.15
</pre></div>
</div>
<img alt="_images/608ee6f05ee253f7e7b638420de8e7748146a5c8b37f86cac173f05686a061ce.png" src="_images/608ee6f05ee253f7e7b638420de8e7748146a5c8b37f86cac173f05686a061ce.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  card2
Skew: -0.26
Kurtosis:  -1.31
</pre></div>
</div>
<img alt="_images/7a44f0c32f30a1a802c0d85d5d6cd6d4d68f63f20531bbc37fdc88c46753f33d.png" src="_images/7a44f0c32f30a1a802c0d85d5d6cd6d4d68f63f20531bbc37fdc88c46753f33d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  card3
Skew: 2.11
Kurtosis:  5.94
</pre></div>
</div>
<img alt="_images/6dd325b5101e760565a2c0ba9b88ee681d2e6348950c150606a5fd8f037a3638.png" src="_images/6dd325b5101e760565a2c0ba9b88ee681d2e6348950c150606a5fd8f037a3638.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  card5
Skew: -1.31
Kurtosis:  0.19
</pre></div>
</div>
<img alt="_images/c174557bbeba48683e2f89a38c528360397830218fce33da0b7be2860001fbcd.png" src="_images/c174557bbeba48683e2f89a38c528360397830218fce33da0b7be2860001fbcd.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  addr1
Skew: 0.36
Kurtosis:  -0.56
</pre></div>
</div>
<img alt="_images/71ee661ffc4fa7f3200260f72f49a0fa5c03649f30344df4ed48bef0b68c675d.png" src="_images/71ee661ffc4fa7f3200260f72f49a0fa5c03649f30344df4ed48bef0b68c675d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  addr2
Skew: -7.35
Kurtosis:  64.98
</pre></div>
</div>
<img alt="_images/f8ff3659f3fd9d90c5dfa8b5de3b9483d2caf3307122be3aec645e8b75463f8a.png" src="_images/f8ff3659f3fd9d90c5dfa8b5de3b9483d2caf3307122be3aec645e8b75463f8a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  dist1
Skew: 4.89
Kurtosis:  32.82
</pre></div>
</div>
<img alt="_images/36f0373ec296675327cda35a822d1ffd7c9b23d571799c246b1c95d4385509c5.png" src="_images/36f0373ec296675327cda35a822d1ffd7c9b23d571799c246b1c95d4385509c5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  dist2
Skew: 5.02
Kurtosis:  38.05
</pre></div>
</div>
<img alt="_images/e1a2864013bd9efadef3785da77a633c7e357718507f39fbefa4ff82c43966b0.png" src="_images/e1a2864013bd9efadef3785da77a633c7e357718507f39fbefa4ff82c43966b0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C1
Skew: 11.02
Kurtosis:  132.87
</pre></div>
</div>
<img alt="_images/e758e4d42ce3c8e7d25a953366854eb11f717c817a801564c442562f202b88bd.png" src="_images/e758e4d42ce3c8e7d25a953366854eb11f717c817a801564c442562f202b88bd.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C2
Skew: 10.69
Kurtosis:  126.49
</pre></div>
</div>
<img alt="_images/909e34a71621aeaab98523acb0b810f67a08aa99dd7f23bb8e3e6d4d025c1664.png" src="_images/909e34a71621aeaab98523acb0b810f67a08aa99dd7f23bb8e3e6d4d025c1664.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C3
Skew: 30.08
Kurtosis:  2495.47
</pre></div>
</div>
<img alt="_images/e25fa1fad73976e33c2bd1c008d275434e4329f0a9bdcc5a05423a806824eebf.png" src="_images/e25fa1fad73976e33c2bd1c008d275434e4329f0a9bdcc5a05423a806824eebf.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C4
Skew: 10.05
Kurtosis:  109.9
</pre></div>
</div>
<img alt="_images/8d1f8b2d583e29f2f017e4cf771d800f06954a26a259dab14f548c1387cff9e2.png" src="_images/8d1f8b2d583e29f2f017e4cf771d800f06954a26a259dab14f548c1387cff9e2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C5
Skew: 6.54
Kurtosis:  45.9
</pre></div>
</div>
<img alt="_images/3f1af7f12a8616a06bf6630ad279d0de528c1b1e92d8e701628a2b6bb3f83172.png" src="_images/3f1af7f12a8616a06bf6630ad279d0de528c1b1e92d8e701628a2b6bb3f83172.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C6
Skew: 9.85
Kurtosis:  106.83
</pre></div>
</div>
<img alt="_images/a857dbda140c8211b4f587648109424306f70b545be10c5fc0100d121581d6bd.png" src="_images/a857dbda140c8211b4f587648109424306f70b545be10c5fc0100d121581d6bd.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C7
Skew: 11.11
Kurtosis:  130.97
</pre></div>
</div>
<img alt="_images/c0f05f6a7fc7154091a378ad9f6d5951c0d2bfeeaf6c6662f2fce3d52a63be1b.png" src="_images/c0f05f6a7fc7154091a378ad9f6d5951c0d2bfeeaf6c6662f2fce3d52a63be1b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C8
Skew: 10.91
Kurtosis:  126.87
</pre></div>
</div>
<img alt="_images/df9ffd55dc8fc39a96025f1a1b8229f6ee035128fe9760f18ab6dc4d35db6932.png" src="_images/df9ffd55dc8fc39a96025f1a1b8229f6ee035128fe9760f18ab6dc4d35db6932.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C9
Skew: 6.86
Kurtosis:  54.12
</pre></div>
</div>
<img alt="_images/8171f683f75b9c343b6172e0a212d5ef9b7231fb3a678e3388f974d2550d9eb5.png" src="_images/8171f683f75b9c343b6172e0a212d5ef9b7231fb3a678e3388f974d2550d9eb5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C10
Skew: 10.5
Kurtosis:  116.83
</pre></div>
</div>
<img alt="_images/08cc618006e8e219551db37e4ec73f176aa813015ffb335d350b80c60b0d12ef.png" src="_images/08cc618006e8e219551db37e4ec73f176aa813015ffb335d350b80c60b0d12ef.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C11
Skew: 10.41
Kurtosis:  118.72
</pre></div>
</div>
<img alt="_images/a387b6776ea66f8a8b6c82252deef1216e27972c9e51489256d3dcef19cd62fa.png" src="_images/a387b6776ea66f8a8b6c82252deef1216e27972c9e51489256d3dcef19cd62fa.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C12
Skew: 11.22
Kurtosis:  133.96
</pre></div>
</div>
<img alt="_images/58c8321cb1782a1e6e5e89c78a8586ef2e23e2be8bc172fe11210447dae58f41.png" src="_images/58c8321cb1782a1e6e5e89c78a8586ef2e23e2be8bc172fe11210447dae58f41.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C13
Skew: 8.45
Kurtosis:  83.3
</pre></div>
</div>
<img alt="_images/96827bc50a6c507084cb2d19fe5ca8c827b7d363e030c791402093b717f08550.png" src="_images/96827bc50a6c507084cb2d19fe5ca8c827b7d363e030c791402093b717f08550.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C14
Skew: 9.43
Kurtosis:  98.41
</pre></div>
</div>
<img alt="_images/c941e0f2625292db2fd3a04d4a8c0ca5aad855734cbf0758a4dc526f1c4584e0.png" src="_images/c941e0f2625292db2fd3a04d4a8c0ca5aad855734cbf0758a4dc526f1c4584e0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D1
Skew: 1.92
Kurtosis:  2.5
</pre></div>
</div>
<img alt="_images/7e3a6aa5dc86a75d101ac0f75880ba2688d195885831d7ad349888cb78270aeb.png" src="_images/7e3a6aa5dc86a75d101ac0f75880ba2688d195885831d7ad349888cb78270aeb.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D2
Skew: 0.78
Kurtosis:  -0.73
</pre></div>
</div>
<img alt="_images/221f2cf342c2eda0b5cba7b8e021d0ab7451d37c1622dd075c55bfc83bb1b58d.png" src="_images/221f2cf342c2eda0b5cba7b8e021d0ab7451d37c1622dd075c55bfc83bb1b58d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D3
Skew: 4.06
Kurtosis:  19.14
</pre></div>
</div>
<img alt="_images/65a36336c9e739eee9c1fe399b74119ddd88fb79f64d66a7f8cab6e80adc8f92.png" src="_images/65a36336c9e739eee9c1fe399b74119ddd88fb79f64d66a7f8cab6e80adc8f92.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D4
Skew: 1.05
Kurtosis:  -0.39
</pre></div>
</div>
<img alt="_images/4c61c5d615fd894c08b0df2652d28cdd1e0ff019ceff26a279b20e939a4de30d.png" src="_images/4c61c5d615fd894c08b0df2652d28cdd1e0ff019ceff26a279b20e939a4de30d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D5
Skew: 3.04
Kurtosis:  9.54
</pre></div>
</div>
<img alt="_images/f378871bbe4862639996718396726287d077fca49824098b3bf9203b5749c86f.png" src="_images/f378871bbe4862639996718396726287d077fca49824098b3bf9203b5749c86f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D6
Skew: 2.29
Kurtosis:  4.71
</pre></div>
</div>
<img alt="_images/0682e896099159c2c1376e0b1d8d2cdc51fd1006f9e8230c541dff32315aff21.png" src="_images/0682e896099159c2c1376e0b1d8d2cdc51fd1006f9e8230c541dff32315aff21.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D7
Skew: 2.04
Kurtosis:  3.07
</pre></div>
</div>
<img alt="_images/06805335e423302c82f4c12b69b5d2f4d93199bc583b71acb79d324684c610b5.png" src="_images/06805335e423302c82f4c12b69b5d2f4d93199bc583b71acb79d324684c610b5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D8
Skew: 1.79
Kurtosis:  2.5
</pre></div>
</div>
<img alt="_images/b67a6604d33421649b0977c7737b4066efd3add4137def0fa0696b77f5c5dd19.png" src="_images/b67a6604d33421649b0977c7737b4066efd3add4137def0fa0696b77f5c5dd19.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D9
Skew: -0.69
Kurtosis:  -1.01
</pre></div>
</div>
<img alt="_images/70920c176b5273689036df91bf4125bfa6a02418a95f6bf86c86e4c4c5192350.png" src="_images/70920c176b5273689036df91bf4125bfa6a02418a95f6bf86c86e4c4c5192350.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D10
Skew: 1.24
Kurtosis:  0.08
</pre></div>
</div>
<img alt="_images/c385f0c156b7c9cb52dd0619d1496d9d78fc0e929944e4bea0a7c87534446fbb.png" src="_images/c385f0c156b7c9cb52dd0619d1496d9d78fc0e929944e4bea0a7c87534446fbb.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D11
Skew: 1.04
Kurtosis:  -0.36
</pre></div>
</div>
<img alt="_images/a9fad6f1b05df6aff15973171c4693b8531be350d37930e2a410f5294691e52c.png" src="_images/a9fad6f1b05df6aff15973171c4693b8531be350d37930e2a410f5294691e52c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D12
Skew: 2.39
Kurtosis:  4.51
</pre></div>
</div>
<img alt="_images/499c25ca8bcf85999ccd3ac11e79d02bd00d803c438d9cd753a2a32cf1bdd20f.png" src="_images/499c25ca8bcf85999ccd3ac11e79d02bd00d803c438d9cd753a2a32cf1bdd20f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D13
Skew: 5.53
Kurtosis:  36.26
</pre></div>
</div>
<img alt="_images/7d429b656fd12d5b258666b701144916ba3b16d64ee25ac65831acc663eccd06.png" src="_images/7d429b656fd12d5b258666b701144916ba3b16d64ee25ac65831acc663eccd06.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D14
Skew: 2.83
Kurtosis:  7.58
</pre></div>
</div>
<img alt="_images/76ad80fb9fccca09e06bdb2da4a513fbfe247f3cc2657947721643f8ddd68038.png" src="_images/76ad80fb9fccca09e06bdb2da4a513fbfe247f3cc2657947721643f8ddd68038.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D15
Skew: 0.84
Kurtosis:  -0.84
</pre></div>
</div>
<img alt="_images/fd08ceab105a8a03a0a2eef918bfa69ebb0118a4a455728eef920d7487133040.png" src="_images/fd08ceab105a8a03a0a2eef918bfa69ebb0118a4a455728eef920d7487133040.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_01
Skew: -4.15
Kurtosis:  20.91
</pre></div>
</div>
<img alt="_images/76db9c0d26ce068e0ca0ce9d2e6f61e9347e02e1022637dfff60e02bf4b12de4.png" src="_images/76db9c0d26ce068e0ca0ce9d2e6f61e9347e02e1022637dfff60e02bf4b12de4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_02
Skew: 2.37
Kurtosis:  8.14
</pre></div>
</div>
<img alt="_images/df6bcc165255ca0e19516f270f58771ba1412cf86aad3ce4afcccffa8d732f65.png" src="_images/df6bcc165255ca0e19516f270f58771ba1412cf86aad3ce4afcccffa8d732f65.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_03
Skew: 1.9
Kurtosis:  57.04
</pre></div>
</div>
<img alt="_images/57b84803166ab73303e6acf092dd2dc918595306aed4832bfe3ab9e5d7cb2769.png" src="_images/57b84803166ab73303e6acf092dd2dc918595306aed4832bfe3ab9e5d7cb2769.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_04
Skew: -15.59
Kurtosis:  342.41
</pre></div>
</div>
<img alt="_images/12a146b3e92b996f13a9d81b986eedf286320f308e8d717a2963ed4e9052f2fd.png" src="_images/12a146b3e92b996f13a9d81b986eedf286320f308e8d717a2963ed4e9052f2fd.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_05
Skew: 2.85
Kurtosis:  11.37
</pre></div>
</div>
<img alt="_images/8284853290b06897af0c027ea745647562104e54c28b12d8c430ee367b4c66f6.png" src="_images/8284853290b06897af0c027ea745647562104e54c28b12d8c430ee367b4c66f6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_06
Skew: -4.11
Kurtosis:  18.74
</pre></div>
</div>
<img alt="_images/206dd4e2a43a49976ad6023a1022780741467147f0468b9a577462606828faf0.png" src="_images/206dd4e2a43a49976ad6023a1022780741467147f0468b9a577462606828faf0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_07
Skew: -0.03
Kurtosis:  -0.2
</pre></div>
</div>
<img alt="_images/0ce96663588a6d8151b5b3e0d0d541c2c63fd45b666f06dfb1c6247ae85cf6f0.png" src="_images/0ce96663588a6d8151b5b3e0d0d541c2c63fd45b666f06dfb1c6247ae85cf6f0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_08
Skew: -0.95
Kurtosis:  0.21
</pre></div>
</div>
<img alt="_images/ce409d051a3c2409aed5d27340de95315ca7f268ce9a9c68e36134d3a708d17d.png" src="_images/ce409d051a3c2409aed5d27340de95315ca7f268ce9a9c68e36134d3a708d17d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_09
Skew: -1.08
Kurtosis:  88.83
</pre></div>
</div>
<img alt="_images/5ab441fb625d371185f678e673f8639d69220ad545a9f0057dc0e9ca79cef942.png" src="_images/5ab441fb625d371185f678e673f8639d69220ad545a9f0057dc0e9ca79cef942.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_10
Skew: -15.67
Kurtosis:  390.02
</pre></div>
</div>
<img alt="_images/67ee46561ec81e568490a624014832a5063370cb25d808c9a6de6418fea3b24b.png" src="_images/67ee46561ec81e568490a624014832a5063370cb25d808c9a6de6418fea3b24b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_11
Skew: -4.3
Kurtosis:  19.63
</pre></div>
</div>
<img alt="_images/d15addcbdfe60dc499450c22aa01766cab3f92ec385ead2c620d61847162f22a.png" src="_images/d15addcbdfe60dc499450c22aa01766cab3f92ec385ead2c620d61847162f22a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_13
Skew: -2.37
Kurtosis:  4.68
</pre></div>
</div>
<img alt="_images/bdb1745b2bb7022a819f32d2f1eb66fc59732b6a6841f89762ea75a334e667eb.png" src="_images/bdb1745b2bb7022a819f32d2f1eb66fc59732b6a6841f89762ea75a334e667eb.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_14
Skew: 2.45
Kurtosis:  27.42
</pre></div>
</div>
<img alt="_images/6f063fe85770503e26d6964d581984c6e62490bceb4cb7640a429da2d18f3dfa.png" src="_images/6f063fe85770503e26d6964d581984c6e62490bceb4cb7640a429da2d18f3dfa.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_17
Skew: 0.98
Kurtosis:  0.21
</pre></div>
</div>
<img alt="_images/359beefda209f475e021ad7ba9b32a0e06392e9f9be9dc46afdea1261582afcf.png" src="_images/359beefda209f475e021ad7ba9b32a0e06392e9f9be9dc46afdea1261582afcf.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_18
Skew: 1.66
Kurtosis:  9.56
</pre></div>
</div>
<img alt="_images/f16193033d5eca4176e44097e8d974bbf383f8a3983cd2a679bfbb6876ce0d30.png" src="_images/f16193033d5eca4176e44097e8d974bbf383f8a3983cd2a679bfbb6876ce0d30.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_19
Skew: 0.03
Kurtosis:  -0.89
</pre></div>
</div>
<img alt="_images/dbf786f156ce2cea4c2d9ad807e126e911dc5cb97884c3608a1ef95d4a7403fa.png" src="_images/dbf786f156ce2cea4c2d9ad807e126e911dc5cb97884c3608a1ef95d4a7403fa.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_20
Skew: -0.1
Kurtosis:  -1.49
</pre></div>
</div>
<img alt="_images/612b1b83ce5b4410acc77f30b3b0d79eeee36eb6eb714abcaa902df4d1dbfd30.png" src="_images/612b1b83ce5b4410acc77f30b3b0d79eeee36eb6eb714abcaa902df4d1dbfd30.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_21
Skew: 0.9
Kurtosis:  -0.65
</pre></div>
</div>
<img alt="_images/68cdfe900d5aadb4f91a08fd53bc9e88017a2e70c9fb8763d2c99fbf3a449277.png" src="_images/68cdfe900d5aadb4f91a08fd53bc9e88017a2e70c9fb8763d2c99fbf3a449277.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_22
Skew: 3.83
Kurtosis:  12.87
</pre></div>
</div>
<img alt="_images/90e8422b57ed71fea04ff29ce4f45c59538ac970569c065f72fa82dff0a0428b.png" src="_images/90e8422b57ed71fea04ff29ce4f45c59538ac970569c065f72fa82dff0a0428b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_24
Skew: 0.27
Kurtosis:  -0.46
</pre></div>
</div>
<img alt="_images/ac7b4567f3dde6424aa06ec7c9f28d89b5bcc1824049ce18dfa64b1ab90add4e.png" src="_images/ac7b4567f3dde6424aa06ec7c9f28d89b5bcc1824049ce18dfa64b1ab90add4e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_25
Skew: -0.0
Kurtosis:  -0.39
</pre></div>
</div>
<img alt="_images/bdda4da7b64bf276a80cf4ddb4c3d84dcc91ee5ac7f3c133239794b03de71935.png" src="_images/bdda4da7b64bf276a80cf4ddb4c3d84dcc91ee5ac7f3c133239794b03de71935.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_26
Skew: -0.01
Kurtosis:  -0.79
</pre></div>
</div>
<img alt="_images/2d21b34e52530d98e76690784c8fb5209620829a18d41f84e951e1e66d326085.png" src="_images/2d21b34e52530d98e76690784c8fb5209620829a18d41f84e951e1e66d326085.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  id_32
Skew: 0.87
Kurtosis:  -1.04
</pre></div>
</div>
<img alt="_images/2e1547924acb6c217025bdafbeed8a5a016065f175e5ba8800feb0028d632468.png" src="_images/2e1547924acb6c217025bdafbeed8a5a016065f175e5ba8800feb0028d632468.png" />
</div>
</div>
<p>id_32 ( 0.87 indica que la cola derecha de la distribución es más larga o pesada que la cola izquierda, lo que significa que hay valores más dispersos hacia la derecha de la distribución. El sesgo positivo sugiere que hay valores más dispersos hacia la derecha de la distribución, y la curtosis negativa indica que la distribución tiene colas más finas que una distribución normal. )</p>
<p>Solo se presenta un valor atipico en 0.</p>
<p>ANALIZANDO CARD</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sdatos</span><span class="o">.</span><span class="n">card1</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>card1
7919     2097
6019     2017
9500     2002
15885    1705
17188    1651
         ... 
12028       1
10794       1
5715        1
6776        1
12478       1
Name: count, Length: 7677, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">sdatos</span><span class="p">[</span><span class="n">sdatos</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;card1&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fraud&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">sdatos</span><span class="p">[</span><span class="n">sdatos</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;card1&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;NoFraud&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribución de CARD1 para Target&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Valores Card1&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probabilidad&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e7f2e26a109f33446160e6432159e1a3998641401aeb9e6ffdf6fca49c9e9f13.png" src="_images/e7f2e26a109f33446160e6432159e1a3998641401aeb9e6ffdf6fca49c9e9f13.png" />
</div>
</div>
<p>La gráfica anterior nos indica la distribución de valores para card 1 teniendo en cuenta la variable fraude, podemos observar  que existen transacciones heterogeneas con este tipo de card y en segundo lugar, existe un menor número de transacciones fraudulentas en esta carta.</p>
<p>CARD 2</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sdatos</span><span class="o">.</span><span class="n">card2</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>card2
321.0    7754
111.0    7387
555.0    6787
583.0    6128
490.0    5743
         ... 
578.0       2
576.0       1
522.0       1
223.0       1
557.0       1
Name: count, Length: 499, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">sdatos</span><span class="p">[</span><span class="n">sdatos</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;card2&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fraud&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">sdatos</span><span class="p">[</span><span class="n">sdatos</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;card2&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;NoFraud&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribución de CARD1 por la variable Target&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Valores CARD2&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probabilidad&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/85d7fbeda89ed54f25737f9772cfa882ae1a2d4e5a17458ce27b638dd4f5cf9b.png" src="_images/85d7fbeda89ed54f25737f9772cfa882ae1a2d4e5a17458ce27b638dd4f5cf9b.png" />
</div>
</div>
<p>La gráfica anterior nos muestra la distribución de valores para card 2 teniendo en cuenta el fraude, podemos observar en primer lugar que existen transacciones con altos umbrales y bajos, esta carta parece que se usa más, y se hacen más transacciones con este tipo de tarjeta y en segundo lugar al igual que card 1, existe un menor número de transacciones fraudulentas en esta carta.</p>
<p>CARD 3</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sdatos</span><span class="o">.</span><span class="n">card3</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>card3
150.0    88642
185.0     9666
144.0      281
106.0      183
146.0      169
         ...  
206.0        1
208.0        1
193.0        1
225.0        1
199.0        1
Name: count, Length: 74, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">sdatos</span><span class="p">[</span><span class="n">sdatos</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;card3&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fraud&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">sdatos</span><span class="p">[</span><span class="n">sdatos</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;card3&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;NoFraud&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribución de CARD3 por la variable Target&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Valores CARD3&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probabilidad&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/123c302fb8d4918fac88b82c5e6ad16fc8969f01d3c69706ed797f7259c4b14c.png" src="_images/123c302fb8d4918fac88b82c5e6ad16fc8969f01d3c69706ed797f7259c4b14c.png" />
</div>
</div>
<p>La gráfica muestra la distribución de valores para card 3 en relación con las transacciones fraudulentas. Se nota que esta card se usa menos frecuentemente, con un enfoque en valores intermedios. Además, al igual que card 1 y 2, presenta una menor incidencia de transacciones fraudulentas, lo que sugiere que las transacciones con esta card tienden a ser menos propensas a actividades fraudulentas en comparación con otros atributos.</p>
<p>CARD 4</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sdatos</span><span class="o">.</span><span class="n">card4</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>card4
visa                65602
mastercard          29599
american express     3330
discover             1462
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Tarjeta utilizada&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sdatos</span><span class="o">.</span><span class="n">card4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tipo de tarjeta&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/065aa86c436e31dbd440e1a8299e5bbe393c416c84a96882f3a107f6a38700df.png" src="_images/065aa86c436e31dbd440e1a8299e5bbe393c416c84a96882f3a107f6a38700df.png" />
</div>
</div>
<p>En el gráfico, se destaca que la “Visa” es el tipo de tarjeta más utilizado, seguido de “MasterCard,” “American Express” y “Discover.” Esto sugiere que la mayoría de las transacciones se realizan con tarjetas Visa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">card4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">sdatos</span><span class="p">[</span><span class="s1">&#39;card4&#39;</span><span class="p">],</span> <span class="n">sdatos</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">])</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">card4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">card4</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#etiquetas</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gráfico de Barras Agrupado (Codificado-Tipo de Tarjeta&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7f8c09fc56f37e113f3cf03623b1617e2822abec120fc1970e5d1f933a349ba6.png" src="_images/7f8c09fc56f37e113f3cf03623b1617e2822abec120fc1970e5d1f933a349ba6.png" />
</div>
</div>
<p>En cuanto a las transacciones fraudulentas, se observa que, en general, hay un número relativamente bajo de casos de fraude. Sin embargo, en términos de la distribución de fraudes por tipo de tarjeta, las transacciones con tarjetas “Visa” muestran la mayor cantidad de casos de fraude.</p>
<p>CARD 5</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sdatos</span><span class="o">.</span><span class="n">card5</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>card5
226.0    51346
224.0    12245
166.0     7677
102.0     5748
117.0     3579
         ...  
206.0        1
181.0        1
189.0        1
214.0        1
204.0        1
Name: count, Length: 87, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">sdatos</span><span class="p">[</span><span class="n">sdatos</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;card5&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fraud&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">sdatos</span><span class="p">[</span><span class="n">sdatos</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;card5&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;NoFraud&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribución de CARD5 por la variable Target&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Valores CARD5&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probabilidad&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3cb098f89b4d0dfddd90b845b36b9ba0d5bf13d5441793f304d0125bd27419dd.png" src="_images/3cb098f89b4d0dfddd90b845b36b9ba0d5bf13d5441793f304d0125bd27419dd.png" />
</div>
</div>
<p>La distribución de card 5 es similar a la de card 3, aunque se utiliza un poco más. Se observa que hay un mayor número de transacciones con montos alrededor de 220, y es en este punto donde se detecta la mayor concentración de transacciones fraudulentas asociadas a esta card. Esto sugiere que las transacciones con valores cercanos a 220 en la tarjeta 5 son más propensas a estar relacionadas con actividades fraudulentas en comparación con otros valores.</p>
<p>CARD 6</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">card6</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">sdatos</span><span class="p">[</span><span class="s1">&#39;card6&#39;</span><span class="p">],</span> <span class="n">sdatos</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">])</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">card6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">card6</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#etiquetas</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gráfico de Barras Agrupado entre Codificado y Tipo de card&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/29b78d35c957dd8ac960438b24338ea9025efbb6da97a852d9fbaadcbd858d9f.png" src="_images/29b78d35c957dd8ac960438b24338ea9025efbb6da97a852d9fbaadcbd858d9f.png" />
</div>
</div>
<p>El gráfico muestra que las transacciones con tarjetas de débito son más comunes que las de crédito, y que el número de transacciones fraudulentas es similar, pero mayor en las tarjetas de débito. Esto podría indicar una mayor vulnerabilidad al fraude en las tarjetas de débito, ya que están vinculadas directamente a cuentas bancarias, lo que podría atraer a los defraudadores. Las tarjetas de crédito suelen contar con más medidas de seguridad, lo que podría explicar la menor incidencia de fraudes en ellas.</p>
<p>VALORES FALTANTES</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faltantes</span> <span class="o">=</span> <span class="n">sdatos</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">f_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">faltantes</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Cantidad de Faltantes&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">porcentaje</span> <span class="o">=</span> <span class="p">(</span><span class="n">faltantes</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">sdatos</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">p_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Columna&#39;</span><span class="p">:</span> <span class="n">faltantes</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>   
    <span class="s1">&#39;Valores Faltantes&#39;</span><span class="p">:</span> <span class="n">faltantes</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>  
    <span class="s1">&#39;Porcentaje Faltante&#39;</span><span class="p">:</span> <span class="n">porcentaje</span><span class="o">.</span><span class="n">values</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>Esta función calcula el porcentaje de valores faltantes en cada columna de d0 y se crea un nuevo DF llamado p_df que muestra la columna, la cantidad de valores faltantes y el porcentaje de faltantes para cada atributo del set de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_df</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Columna  Valores Faltantes  Porcentaje Faltante
C1       0                  0.000                  1
V314     0                  0.000                  1
V324     68229              68.229                 1
V323     68229              68.229                 1
V322     68229              68.229                 1
                                                  ..
V185     60417              60.417                 1
V184     60417              60.417                 1
V183     60417              60.417                 1
V182     60417              60.417                 1
isFraud  0                  0.000                  1
Name: count, Length: 434, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corte</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">porcentaje</span> <span class="o">=</span> <span class="p">(</span><span class="n">sdatos</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">sdatos</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c_vacias</span> <span class="o">=</span> <span class="n">porcentaje</span><span class="p">[</span><span class="n">porcentaje</span> <span class="o">&gt;</span> <span class="n">corte</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dv</span> <span class="o">=</span> <span class="n">sdatos</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_vacias</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Se eliminan las columnas que poseen contenidos nulos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>...</th>
      <th>id_20</th>
      <th>id_28</th>
      <th>id_29</th>
      <th>id_31</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>id_38</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>0</td>
      <td>86400</td>
      <td>68.500</td>
      <td>W</td>
      <td>13926</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>discover</td>
      <td>142.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>0</td>
      <td>86401</td>
      <td>29.000</td>
      <td>W</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>0</td>
      <td>86469</td>
      <td>59.000</td>
      <td>W</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>0</td>
      <td>86499</td>
      <td>50.000</td>
      <td>W</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>0</td>
      <td>86506</td>
      <td>50.000</td>
      <td>H</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>144.0</td>
      <td>New</td>
      <td>NotFound</td>
      <td>samsung browser 6.2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>mobile</td>
      <td>SAMSUNG SM-G892A Build/NRD90M</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>3086995</td>
      <td>0</td>
      <td>2005989</td>
      <td>55.385</td>
      <td>C</td>
      <td>2256</td>
      <td>545.0</td>
      <td>185.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>...</td>
      <td>507.0</td>
      <td>New</td>
      <td>NotFound</td>
      <td>mobile safari uiwebview</td>
      <td>F</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>mobile</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>3086996</td>
      <td>0</td>
      <td>2006074</td>
      <td>117.000</td>
      <td>W</td>
      <td>2518</td>
      <td>555.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>3086997</td>
      <td>0</td>
      <td>2006135</td>
      <td>50.000</td>
      <td>S</td>
      <td>2748</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>228.0</td>
      <td>...</td>
      <td>161.0</td>
      <td>Found</td>
      <td>Found</td>
      <td>chrome 63.0</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>desktop</td>
      <td>MacOS</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>3086998</td>
      <td>0</td>
      <td>2006177</td>
      <td>100.000</td>
      <td>H</td>
      <td>16075</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>222.0</td>
      <td>New</td>
      <td>NotFound</td>
      <td>safari generic</td>
      <td>T</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>MacOS</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>3086999</td>
      <td>0</td>
      <td>2006364</td>
      <td>107.950</td>
      <td>W</td>
      <td>4436</td>
      <td>174.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 393 columns</p>
</div></div></div>
</div>
<p>ELIMINACION-CORRELACION</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">dv</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">dv</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> 
        <span class="n">lbl</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">LabelEncoder</span><span class="p">()</span>
        <span class="n">lbl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dv</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="n">dv</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">lbl</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dv</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corte</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="c1">#Se establecen altas correlaciones</span>
<span class="n">porcentajev</span> <span class="o">=</span> <span class="p">(</span><span class="n">sdatos</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">sdatos</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_vacias</span> <span class="o">=</span> <span class="n">porcentajev</span><span class="p">[</span><span class="n">porcentajev</span> <span class="o">&gt;</span> <span class="n">corte</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> <span class="c1">#Se eliman aquellas columnas con valor mayor al punto de corte</span>
</pre></div>
</div>
</div>
</div>
<p>Se genera una matriz de correlación  y se seleccionan los valores debajo de la diagonal principal. Luego, se identifican y retienen las correlaciones que superan el umbral de 0.70, mientras que las demás se eliminan. Este proceso ayuda a resaltar las relaciones fuertes entre las variables, simplificando el análisis de correlación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c_m</span> <span class="o">=</span> <span class="n">dv</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">c_m</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">c_m</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>
<span class="n">to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">upper</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.70</span><span class="p">)]</span>
<span class="n">d1</span><span class="o">=</span><span class="n">dv</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">dv</span><span class="p">[</span><span class="n">to_drop</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>card6</th>
      <th>...</th>
      <th>id_01</th>
      <th>id_02</th>
      <th>id_05</th>
      <th>id_06</th>
      <th>id_11</th>
      <th>id_13</th>
      <th>id_14</th>
      <th>id_19</th>
      <th>id_20</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>0</td>
      <td>68.500</td>
      <td>4</td>
      <td>13926</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>1</td>
      <td>142.0</td>
      <td>1</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>840</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>0</td>
      <td>29.000</td>
      <td>4</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>2</td>
      <td>102.0</td>
      <td>1</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>840</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>0</td>
      <td>59.000</td>
      <td>4</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>4</td>
      <td>166.0</td>
      <td>2</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>840</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>0</td>
      <td>50.000</td>
      <td>4</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>2</td>
      <td>117.0</td>
      <td>2</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>840</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>0</td>
      <td>50.000</td>
      <td>1</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>2</td>
      <td>102.0</td>
      <td>1</td>
      <td>...</td>
      <td>0.0</td>
      <td>70787.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>-480.0</td>
      <td>542.0</td>
      <td>144.0</td>
      <td>423</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>3086995</td>
      <td>0</td>
      <td>55.385</td>
      <td>0</td>
      <td>2256</td>
      <td>545.0</td>
      <td>185.0</td>
      <td>4</td>
      <td>226.0</td>
      <td>1</td>
      <td>...</td>
      <td>-35.0</td>
      <td>407847.0</td>
      <td>-6.0</td>
      <td>-7.0</td>
      <td>100.0</td>
      <td>49.0</td>
      <td>NaN</td>
      <td>345.0</td>
      <td>507.0</td>
      <td>840</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>3086996</td>
      <td>0</td>
      <td>117.000</td>
      <td>4</td>
      <td>2518</td>
      <td>555.0</td>
      <td>150.0</td>
      <td>4</td>
      <td>226.0</td>
      <td>2</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>840</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>3086997</td>
      <td>0</td>
      <td>50.000</td>
      <td>3</td>
      <td>2748</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>4</td>
      <td>228.0</td>
      <td>1</td>
      <td>...</td>
      <td>0.0</td>
      <td>60547.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>-300.0</td>
      <td>312.0</td>
      <td>161.0</td>
      <td>318</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>3086998</td>
      <td>0</td>
      <td>100.000</td>
      <td>1</td>
      <td>16075</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>2</td>
      <td>102.0</td>
      <td>1</td>
      <td>...</td>
      <td>-5.0</td>
      <td>179805.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>100.0</td>
      <td>49.0</td>
      <td>-480.0</td>
      <td>312.0</td>
      <td>222.0</td>
      <td>318</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>3086999</td>
      <td>0</td>
      <td>107.950</td>
      <td>4</td>
      <td>4436</td>
      <td>174.0</td>
      <td>150.0</td>
      <td>4</td>
      <td>226.0</td>
      <td>2</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>840</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 94 columns</p>
</div></div></div>
</div>
<p>Después de este proceso, se observa una reducción de dimensiones, donde el número de variables se reduce. Esto implica que se han preservado únicamente las correlaciones significativas, simplificando el conjunto de datos al eliminar las variables con correlaciones débiles o redundantes.</p>
<p>Rellanando las columnas NaN con la Mediana</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">column_medians</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">d1</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">column_medians</span><span class="p">)</span>
<span class="n">d1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>card6</th>
      <th>...</th>
      <th>id_01</th>
      <th>id_02</th>
      <th>id_05</th>
      <th>id_06</th>
      <th>id_11</th>
      <th>id_13</th>
      <th>id_14</th>
      <th>id_19</th>
      <th>id_20</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>0</td>
      <td>68.500</td>
      <td>4</td>
      <td>13926</td>
      <td>387.0</td>
      <td>150.0</td>
      <td>1</td>
      <td>142.0</td>
      <td>1</td>
      <td>...</td>
      <td>-5.0</td>
      <td>102450.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>352.0</td>
      <td>391.0</td>
      <td>840</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>0</td>
      <td>29.000</td>
      <td>4</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>2</td>
      <td>102.0</td>
      <td>1</td>
      <td>...</td>
      <td>-5.0</td>
      <td>102450.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>352.0</td>
      <td>391.0</td>
      <td>840</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>0</td>
      <td>59.000</td>
      <td>4</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>4</td>
      <td>166.0</td>
      <td>2</td>
      <td>...</td>
      <td>-5.0</td>
      <td>102450.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>352.0</td>
      <td>391.0</td>
      <td>840</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>0</td>
      <td>50.000</td>
      <td>4</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>2</td>
      <td>117.0</td>
      <td>2</td>
      <td>...</td>
      <td>-5.0</td>
      <td>102450.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>352.0</td>
      <td>391.0</td>
      <td>840</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>0</td>
      <td>50.000</td>
      <td>1</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>2</td>
      <td>102.0</td>
      <td>1</td>
      <td>...</td>
      <td>0.0</td>
      <td>70787.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-480.0</td>
      <td>542.0</td>
      <td>144.0</td>
      <td>423</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>3086995</td>
      <td>0</td>
      <td>55.385</td>
      <td>0</td>
      <td>2256</td>
      <td>545.0</td>
      <td>185.0</td>
      <td>4</td>
      <td>226.0</td>
      <td>1</td>
      <td>...</td>
      <td>-35.0</td>
      <td>407847.0</td>
      <td>-6.0</td>
      <td>-7.0</td>
      <td>100.0</td>
      <td>49.0</td>
      <td>-300.0</td>
      <td>345.0</td>
      <td>507.0</td>
      <td>840</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>3086996</td>
      <td>0</td>
      <td>117.000</td>
      <td>4</td>
      <td>2518</td>
      <td>555.0</td>
      <td>150.0</td>
      <td>4</td>
      <td>226.0</td>
      <td>2</td>
      <td>...</td>
      <td>-5.0</td>
      <td>102450.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>352.0</td>
      <td>391.0</td>
      <td>840</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>3086997</td>
      <td>0</td>
      <td>50.000</td>
      <td>3</td>
      <td>2748</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>4</td>
      <td>228.0</td>
      <td>1</td>
      <td>...</td>
      <td>0.0</td>
      <td>60547.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>312.0</td>
      <td>161.0</td>
      <td>318</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>3086998</td>
      <td>0</td>
      <td>100.000</td>
      <td>1</td>
      <td>16075</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>2</td>
      <td>102.0</td>
      <td>1</td>
      <td>...</td>
      <td>-5.0</td>
      <td>179805.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>100.0</td>
      <td>49.0</td>
      <td>-480.0</td>
      <td>312.0</td>
      <td>222.0</td>
      <td>318</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>3086999</td>
      <td>0</td>
      <td>107.950</td>
      <td>4</td>
      <td>4436</td>
      <td>174.0</td>
      <td>150.0</td>
      <td>4</td>
      <td>226.0</td>
      <td>2</td>
      <td>...</td>
      <td>-5.0</td>
      <td>102450.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>352.0</td>
      <td>391.0</td>
      <td>840</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 94 columns</p>
</div></div></div>
</div>
<p>ARBOL DE DECISION</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_a</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_a</span> <span class="o">=</span> <span class="n">d1</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span>
<span class="n">cls1</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">modelo</span><span class="o">=</span><span class="n">cls1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_a</span><span class="p">,</span><span class="n">y_a</span><span class="p">)</span>
<span class="n">y_a</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100000,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">X_a</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d140017558d0ce0963c8afe7cad8593038e9321c3cb0cf27518a1688bb3fb685.png" src="_images/d140017558d0ce0963c8afe7cad8593038e9321c3cb0cf27518a1688bb3fb685.png" />
</div>
</div>
<p>La implementación de un árbol de decisión es valiosa en el Análisis Exploratorio de Datos ya que puede ofrecer indicios sobre las variables que podrían ser más relevantes para el problema. En este caso, se destaca que la variable V44 parece ser la más influyente para clasificar el fraude en el conjunto de datos.</p>
<p>PUNTO 5 (IMPLEMENTACION DE MODELOS CLASIFICACION)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span> 
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">RidgeClassifier</span><span class="p">,</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>  
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span> 
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">balanced_accuracy_score</span> 
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="n">knn_model</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
<span class="n">ridge_model</span> <span class="o">=</span> <span class="n">RidgeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">lasso_model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">nb_model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">xb_model</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">()</span>
<span class="n">svm_model</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">mlp_classifier</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATOS</span><span class="o">=</span><span class="n">d1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">DATOS</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">DATOS</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Division de datos en conjunto de entrenamiento y prueba</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>MODELO LASSO</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M_lasso</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;lasso&#39;</span><span class="p">,</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">))])</span>
<span class="n">M_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">M_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.97827   0.99908   0.98856     19508
           1    0.76623   0.11992   0.20738       492

    accuracy                        0.97745     20000
   macro avg    0.87225   0.55950   0.59797     20000
weighted avg    0.97305   0.97745   0.96935     20000
</pre></div>
</div>
</div>
</div>
<p>Estos resultados son de un modelo sin ajuste (por defecto). El modelo muestra una alta precisión y exhaustividad para la clase no fraude (0), con puntajes de 97.83% y 99.90%, respectivamente. Sin embargo, en la detección de fraude (clase 1), la precisión es del 76.62% y la exhaustividad es del 11.99%, lo que indica que se pueden mejorar las capacidades de detección de fraudes. El puntaje F1 ponderado es de 0.9693, reflejando el rendimiento general del modelo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid_lasso</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lasso__penalty&#39;</span><span class="p">:[</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span><span class="s1">&#39;l2&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;lasso__fit_intercept&#39;</span><span class="p">:[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
                    <span class="s1">&#39;lasso__C&#39;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mf">0.01</span><span class="p">]</span>
                    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_lasso</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;lasso&#39;</span><span class="p">,</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">))])</span>
<span class="n">grid_lasso</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe_lasso</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid_lasso</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">grid_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;lasso&#x27;,
                                        LogisticRegression(random_state=123))]),
             n_jobs=-1,
             param_grid={&#x27;lasso__C&#x27;: [1000, 0.01],
                         &#x27;lasso__fit_intercept&#x27;: [True, False],
                         &#x27;lasso__penalty&#x27;: [&#x27;l1&#x27;, &#x27;l2&#x27;]},
             scoring=&#x27;roc_auc&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" ><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;lasso&#x27;,
                                        LogisticRegression(random_state=123))]),
             n_jobs=-1,
             param_grid={&#x27;lasso__C&#x27;: [1000, 0.01],
                         &#x27;lasso__fit_intercept&#x27;: [True, False],
                         &#x27;lasso__penalty&#x27;: [&#x27;l1&#x27;, &#x27;l2&#x27;]},
             scoring=&#x27;roc_auc&#x27;)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" ><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;lasso&#x27;, LogisticRegression(random_state=123))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" ><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" ><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression(random_state=123)</pre></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best params:</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_lasso</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best cross-validation score: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_lasso</span><span class="o">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test-set score: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_lasso</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best params:
{&#39;lasso__C&#39;: 0.01, &#39;lasso__fit_intercept&#39;: True, &#39;lasso__penalty&#39;: &#39;l2&#39;}

Best cross-validation score: 0.81
Test-set score: 0.98
</pre></div>
</div>
</div>
</div>
<p>El mejor modelo Lasso se obtien con C:0.01, Intercepto y penalty de 12. Esta combinación de párametros garantizan un auc en la validación de 0.81.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_params_lasso</span> <span class="o">=</span> <span class="n">grid_lasso</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">params_lasso</span> <span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">param</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">best_params_lasso</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> 
<span class="n">best_pipe_lasso</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;lasso&#39;</span><span class="p">,</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="o">**</span><span class="n">params_lasso</span><span class="p">))])</span>
<span class="n">best_pipe_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;lasso&#x27;, LogisticRegression(C=0.01, random_state=123))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" ><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;lasso&#x27;, LogisticRegression(C=0.01, random_state=123))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox" ><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox" ><label for="sk-estimator-id-7" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression(C=0.01, random_state=123)</pre></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.97807   0.99923   0.98854     19508
           1    0.78571   0.11179   0.19573       492

    accuracy                        0.97740     20000
   macro avg    0.88189   0.55551   0.59213     20000
weighted avg    0.97334   0.97740   0.96904     20000
</pre></div>
</div>
</div>
</div>
<p>Resultados posteriores al ajuste (tuning) del modelo son similares a los resultados anteriores: Precisión y exhaustividad para la clase 0 siguen siendo 97.80% y 99.92%, mientras que para la clase 1, la precisión es 78.57% y la exhaustividad es 11.17%. Puntaje F1 ponderado sigue siendo 0.9690. Indica que el ajuste de hiperparámetros no tuvo un impacto significativo en el rendimiento del modelo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_scores_lasso</span> <span class="o">=</span> <span class="n">best_pipe_lasso</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_scores_lasso</span><span class="p">)</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Curva ROC (área = </span><span class="si">%0.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">roc_auc</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC - LASSO&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c9bdf594ea85f5f8ab2f9959da86d675437d71a71971abffa7ef6bfc06c8cf98.png" src="_images/c9bdf594ea85f5f8ab2f9959da86d675437d71a71971abffa7ef6bfc06c8cf98.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lasso_score</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_lasso</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LASSO AUC-ROC Score:&quot;</span><span class="p">,</span> <span class="n">lasso_score</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LASSO AUC-ROC Score: 0.8056714485281002
</pre></div>
</div>
</div>
</div>
<p>El puntaje AUC-ROC para LASSO es de 0.805, indicando un rendimiento razonable en la capacidad de clasificación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm_lasso</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm_lasso</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">},</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matriz de confusión Lasso&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/20049eab50a29c3bb3ebea779c2cb19e608b894a670f9e13f7b76094f188f5cb.png" src="_images/20049eab50a29c3bb3ebea779c2cb19e608b894a670f9e13f7b76094f188f5cb.png" />
</div>
</div>
<p>La matriz de confunsión de confusión enfatiza que el modelo es muy bueno para clasificar la categoría No fraude, sin embargo también tiene algunos errores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Lasso&#39;</span><span class="p">,</span> <span class="s1">&#39;precision 0&#39;</span><span class="p">:</span> <span class="mf">0.9780</span><span class="p">,</span> <span class="s1">&#39;precision 1&#39;</span><span class="p">:</span> <span class="mf">0.7662</span><span class="p">,</span> <span class="s1">&#39;recall 0&#39;</span><span class="p">:</span> <span class="mf">0.9992</span> <span class="p">,</span> <span class="s1">&#39;recall 1&#39;</span><span class="p">:</span> <span class="mf">0.1117</span> <span class="p">,</span><span class="s1">&#39;f1-score 0&#39;</span><span class="p">:</span> <span class="mf">0.9885</span><span class="p">,</span> <span class="s1">&#39;f1-score 1&#39;</span><span class="p">:</span> <span class="mf">0.1957</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="mf">0.8056</span><span class="p">},</span> <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>MODELO RIDGE</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_ridge</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">RidgeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">))])</span>
<span class="n">pipe_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pipe_ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.97618   0.99995   0.98792     19508
           1    0.94118   0.03252   0.06287       492

    accuracy                        0.97615     20000
   macro avg    0.95868   0.51623   0.52539     20000
weighted avg    0.97532   0.97615   0.96516     20000
</pre></div>
</div>
</div>
</div>
<p>Los resultados del modelo Ridge sin ajuste de hiperparámetros muestran una alta precisión (97.61%) y exhaustividad (99.99%) para la clase no fraude (0), indicando que se clasifican correctamente la mayoría de las transacciones no fraudulentas. Sin embargo, en la detección de fraude (clase 1), la precisión es del 94.11%, mientras que la exhaustividad es baja (3.25%), lo que sugiere una limitada capacidad para detectar transacciones fraudulentas. El puntaje F1 ponderado es de 0.96516, reflejando el rendimiento global del modelo sin ajuste de hiperparámetros.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid_ridge</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ridge__alpha&#39;</span><span class="p">:[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
                    <span class="s1">&#39;ridge__fit_intercept&#39;</span><span class="p">:[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
                    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_ridge</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span><span class="n">RidgeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">))])</span>
<span class="n">grid_ridge</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe_ridge</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid_ridge</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">grid_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-3 {color: black;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;ridge&#x27;,
                                        RidgeClassifier(random_state=123))]),
             n_jobs=-1,
             param_grid={&#x27;ridge__alpha&#x27;: [0.1, 1.0, 10, 100],
                         &#x27;ridge__fit_intercept&#x27;: [True, False]},
             scoring=&#x27;roc_auc&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox" ><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;ridge&#x27;,
                                        RidgeClassifier(random_state=123))]),
             n_jobs=-1,
             param_grid={&#x27;ridge__alpha&#x27;: [0.1, 1.0, 10, 100],
                         &#x27;ridge__fit_intercept&#x27;: [True, False]},
             scoring=&#x27;roc_auc&#x27;)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox" ><label for="sk-estimator-id-9" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;ridge&#x27;, RidgeClassifier(random_state=123))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-10" type="checkbox" ><label for="sk-estimator-id-10" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-11" type="checkbox" ><label for="sk-estimator-id-11" class="sk-toggleable__label sk-toggleable__label-arrow">RidgeClassifier</label><div class="sk-toggleable__content"><pre>RidgeClassifier(random_state=123)</pre></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best params:</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_ridge</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best cross-validation score: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_ridge</span><span class="o">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test-set score: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_ridge</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best params:
{&#39;ridge__alpha&#39;: 100, &#39;ridge__fit_intercept&#39;: True}

Best cross-validation score: 0.80
Test-set score: 0.98
</pre></div>
</div>
</div>
</div>
<p>Los mejores parámetros de ajuste (tuning) para el modelo Ridge son: ‘alpha’: 100 y ‘fit_intercept’: Verdadero Con estos ajustes, el modelo alcanzó un puntaje de validación cruzada del 80% y un puntaje del 98% en el conjunto de prueba, lo que indica un alto rendimiento y capacidad de generalización del modelo. Estos ajustes ayudaron a mejorar el desempeño del modelo en comparación con la configuración por defecto.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_params_ridge</span> <span class="o">=</span> <span class="n">grid_ridge</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">params_ridge</span> <span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">param</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">best_params_ridge</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> 
<span class="n">best_pipe_ridge</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span><span class="n">RidgeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="o">**</span><span class="n">params_ridge</span><span class="p">))])</span>
<span class="n">best_pipe_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-4 {color: black;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;ridge&#x27;, RidgeClassifier(alpha=100, random_state=123))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-12" type="checkbox" ><label for="sk-estimator-id-12" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;ridge&#x27;, RidgeClassifier(alpha=100, random_state=123))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-13" type="checkbox" ><label for="sk-estimator-id-13" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-14" type="checkbox" ><label for="sk-estimator-id-14" class="sk-toggleable__label sk-toggleable__label-arrow">RidgeClassifier</label><div class="sk-toggleable__content"><pre>RidgeClassifier(alpha=100, random_state=123)</pre></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.97618   0.99995   0.98792     19508
           1    0.94118   0.03252   0.06287       492

    accuracy                        0.97615     20000
   macro avg    0.95868   0.51623   0.52539     20000
weighted avg    0.97532   0.97615   0.96516     20000
</pre></div>
</div>
</div>
</div>
<p>Estos resultados corresponden al modelo Ridge con los mejores hiperparámetros ajustados y el impacto de estos sobre el modelo. El modelo muestra una alta precisión (97.618%) y exhaustividad (99.95%) para la clase no fraude (0), lo que indica una correcta clasificación de la mayoría de las transacciones no fraudulentas. Sin embargo, en la detección de fraude (clase 1), la precisión es del 94.11%, pero la exhaustividad es baja (3.25%), lo que sugiere una capacidad limitada para detectar transacciones fraudulentas. El puntaje F1 ponderado es de 0.96516, reflejando el rendimiento global del modelo después del ajuste de hiperparámetros.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> 
    <span class="p">{</span><span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Ridge&#39;</span><span class="p">,</span> <span class="s1">&#39;precision 0&#39;</span><span class="p">:</span> <span class="mf">0.97618</span><span class="p">,</span> <span class="s1">&#39;precision 1&#39;</span><span class="p">:</span> <span class="mf">0.9411</span><span class="p">,</span><span class="s1">&#39;recall 0&#39;</span><span class="p">:</span> <span class="mf">0.9995</span> <span class="p">,</span> <span class="s1">&#39;recall 1&#39;</span><span class="p">:</span> <span class="mf">0.0325</span><span class="p">,</span> <span class="s1">&#39;f1-score 0&#39;</span><span class="p">:</span> <span class="mf">0.98792</span><span class="p">,</span> <span class="s1">&#39;f1-score 1&#39;</span><span class="p">:</span> <span class="mf">0.06287</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="mf">0.78</span><span class="p">},)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_scores_ridge</span> <span class="o">=</span> <span class="n">best_pipe_ridge</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_scores_ridge</span><span class="p">)</span>
<span class="n">roc_auc</span><span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Curva ROC (área = </span><span class="si">%0.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">roc_auc</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC - Ridge&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b7b575edee69902c875f91ea2a8ef3659040311f0836a94be7172fa81208fc14.png" src="_images/b7b575edee69902c875f91ea2a8ef3659040311f0836a94be7172fa81208fc14.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ridge_score</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_ridge</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RIDGE AUC-ROC Score:&quot;</span><span class="p">,</span> <span class="n">ridge_score</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RIDGE AUC-ROC Score: 0.7863638598965443
</pre></div>
</div>
</div>
</div>
<p>El puntaje AUC-ROC para el modelo Ridge es de aproximadamente 0.763, lo que indica su capacidad para distinguir entre clases positivas y negativas. Aunque 0.763 no es óptimo, sigue siendo una métrica razonable en la clasificación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm_ridge</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm_ridge</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">},</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matriz de confusión Ridge&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a85c6ec74162467b65e948642ee94327cb0c6b0cdeb05e3684363785f7bb3323.png" src="_images/a85c6ec74162467b65e948642ee94327cb0c6b0cdeb05e3684363785f7bb3323.png" />
</div>
</div>
<p>La matriz de confusión del modelo Ridge es similar a la del modelo Lasso, pero el modelo Ridge muestra un mejor desempeño en la clasificación de transacciones no fraudulentas y comete menos errores en este aspecto en comparación con el modelo Lasso. Esto sugiere que el modelo Ridge es más preciso en identificar transacciones no fraudulentas, mientras que ambos modelos tienen dificultades en detectar transacciones fraudulentas.</p>
<p>MODELO KNN</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_knn</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">))])</span>
<span class="n">pipe_knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pipe_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.98273   0.99759   0.99010     19508
           1    0.76142   0.30488   0.43541       492

    accuracy                        0.98055     20000
   macro avg    0.87208   0.65123   0.71276     20000
weighted avg    0.97729   0.98055   0.97646     20000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid_knn</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
                    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_knn</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span><span class="n">KNeighborsClassifier</span><span class="p">())])</span>
<span class="n">grid_knn</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe_knn</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid_knn</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">grid_knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-5 {color: black;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;knn&#x27;, KNeighborsClassifier())]),
             n_jobs=-1, param_grid={&#x27;knn__n_neighbors&#x27;: [7, 10]},
             scoring=&#x27;roc_auc&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-15" type="checkbox" ><label for="sk-estimator-id-15" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;knn&#x27;, KNeighborsClassifier())]),
             n_jobs=-1, param_grid={&#x27;knn__n_neighbors&#x27;: [7, 10]},
             scoring=&#x27;roc_auc&#x27;)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-16" type="checkbox" ><label for="sk-estimator-id-16" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()), (&#x27;knn&#x27;, KNeighborsClassifier())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-17" type="checkbox" ><label for="sk-estimator-id-17" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-18" type="checkbox" ><label for="sk-estimator-id-18" class="sk-toggleable__label sk-toggleable__label-arrow">KNeighborsClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsClassifier()</pre></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_params_knn</span> <span class="o">=</span> <span class="n">grid_knn</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">params_knn</span> <span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">param</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">best_params_knn</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> 
<span class="n">best_pipe_knn</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span><span class="n">KNeighborsClassifier</span><span class="p">(</span> <span class="o">**</span><span class="n">params_knn</span><span class="p">))])</span>
<span class="n">best_pipe_knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-6 {color: black;}#sk-container-id-6 pre{padding: 0;}#sk-container-id-6 div.sk-toggleable {background-color: white;}#sk-container-id-6 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-6 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-6 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-6 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-6 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-6 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-6 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-6 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-6 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-6 div.sk-item {position: relative;z-index: 1;}#sk-container-id-6 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-6 div.sk-item::before, #sk-container-id-6 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-6 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-6 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-6 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-6 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-6 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-6 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-6 div.sk-label-container {text-align: center;}#sk-container-id-6 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-6 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-6" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;knn&#x27;, KNeighborsClassifier(n_neighbors=10))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-19" type="checkbox" ><label for="sk-estimator-id-19" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;knn&#x27;, KNeighborsClassifier(n_neighbors=10))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-20" type="checkbox" ><label for="sk-estimator-id-20" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-21" type="checkbox" ><label for="sk-estimator-id-21" class="sk-toggleable__label sk-toggleable__label-arrow">KNeighborsClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsClassifier(n_neighbors=10)</pre></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.98004   0.99913   0.98949     19508
           1    0.84821   0.19309   0.31457       492

    accuracy                        0.97930     20000
   macro avg    0.91413   0.59611   0.65203     20000
weighted avg    0.97680   0.97930   0.97289     20000
</pre></div>
</div>
</div>
</div>
<p>El modelo KNN ajustado con hiperparámetros muestra mejoras en la detección de la clase minoritaria (Fraude 1), con una precisión del 84.82%, un recall del 19.30%, y un valor F1 de 31.45%. La precisión en la clase mayoritaria (0) es del 98.004%, con un recall del 99.91% y un valor F1 de 98.94%.  una precisión global del 97.28%</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> 
    <span class="p">{</span><span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;KNN&#39;</span><span class="p">,</span> <span class="s1">&#39;precision 0&#39;</span><span class="p">:</span> <span class="mf">0.98004</span><span class="p">,</span> <span class="s1">&#39;precision 1&#39;</span><span class="p">:</span> <span class="mf">0.84821</span><span class="p">,</span><span class="s1">&#39;recall 0&#39;</span><span class="p">:</span> <span class="mf">0.99913</span> <span class="p">,</span> <span class="s1">&#39;recall 1&#39;</span><span class="p">:</span> <span class="mf">0.19309</span><span class="p">,</span> <span class="s1">&#39;f1-score 0&#39;</span><span class="p">:</span> <span class="mf">0.98949</span><span class="p">,</span> <span class="s1">&#39;f1-score 1&#39;</span><span class="p">:</span> <span class="mf">0.31457</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="mf">0.81</span><span class="p">},)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_scores_knn</span><span class="o">=</span> <span class="n">best_pipe_knn</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_scores_knn</span><span class="p">)</span>
<span class="n">roc_auc</span><span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Curva ROC (área = </span><span class="si">%0.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">roc_auc</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC - KNN&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b7ffa1940a41bcad2b892fe603be3e1047d0c3f322bdacd32f69bb54baa7a2eb.png" src="_images/b7ffa1940a41bcad2b892fe603be3e1047d0c3f322bdacd32f69bb54baa7a2eb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn_score</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_knn</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KNN AUC-ROC Score:&quot;</span><span class="p">,</span> <span class="n">knn_score</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KNN AUC-ROC Score: 0.8134144674438338
</pre></div>
</div>
</div>
</div>
<p>El valor del área bajo la curva ROC (AUC-ROC) para el modelo KNN es 0.813, lo que sugiere que el modelo tiene una capacidad moderada para distinguir entre las clases, lo que es un indicio positivo de su desempeño.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm_knn</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm_knn</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">},</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matriz de confusión KNN&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/040fe348eb76e1b9451f26a52d950de926771bc09cec8921d34ac2b869e808ba.png" src="_images/040fe348eb76e1b9451f26a52d950de926771bc09cec8921d34ac2b869e808ba.png" />
</div>
</div>
<p>Según la matriz de confusión el modelo KNN es bueno para clasificar las transacciones no fraudulentas.</p>
<p>MODELO SVM</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_svm</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span><span class="n">SVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">cache_size</span><span class="o">=</span><span class="mi">150</span><span class="p">))])</span>
<span class="n">pipe_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pipe_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.97533   0.99103   0.98312     19508
           1    0.01685   0.00610   0.00896       492

    accuracy                        0.96680     20000
   macro avg    0.49609   0.49856   0.49604     20000
weighted avg    0.95175   0.96680   0.95915     20000
</pre></div>
</div>
</div>
</div>
<p>El modelo SVM sin ajuste (tunning) muestra un rendimiento deficiente en la clasificación de transacciones fraudulentas (clase 1) con una baja precisión (1.68%) y un “recall” limitado (6.10%). Por otro lado, el modelo tiene un rendimiento relativamente mejor en la clasificación de transacciones no fraudulentas (clase 0) con una precisión del 97.53% y un “recall” del 99.10%. En general, el modelo tiene una puntuación F1 baja para la clase 1 (transacciones fraudulentas) y una precisión global del 96.68%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid_svm</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;svm__gamma&#39;</span><span class="p">:[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span>
                    <span class="s1">&#39;svm__C&#39;</span><span class="p">:[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
                    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_svm</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span><span class="n">SVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">cache_size</span><span class="o">=</span><span class="mi">150</span><span class="p">))])</span>
<span class="n">grid_svm</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe_svm</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid_svm</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">grid_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 5 folds for each of 4 candidates, totalling 20 fits
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-7 {color: black;}#sk-container-id-7 pre{padding: 0;}#sk-container-id-7 div.sk-toggleable {background-color: white;}#sk-container-id-7 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-7 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-7 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-7 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-7 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-7 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-7 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-7 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-7 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-7 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-7 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-7 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-7 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-7 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-7 div.sk-item {position: relative;z-index: 1;}#sk-container-id-7 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-7 div.sk-item::before, #sk-container-id-7 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-7 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-7 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-7 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-7 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-7 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-7 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-7 div.sk-label-container {text-align: center;}#sk-container-id-7 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-7 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-7" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;svm&#x27;,
                                        SVC(cache_size=150, max_iter=100,
                                            random_state=123))]),
             n_jobs=-1,
             param_grid={&#x27;svm__C&#x27;: [0.01, 0.1], &#x27;svm__gamma&#x27;: [0.01, 0.1]},
             scoring=&#x27;roc_auc&#x27;, verbose=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-22" type="checkbox" ><label for="sk-estimator-id-22" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;svm&#x27;,
                                        SVC(cache_size=150, max_iter=100,
                                            random_state=123))]),
             n_jobs=-1,
             param_grid={&#x27;svm__C&#x27;: [0.01, 0.1], &#x27;svm__gamma&#x27;: [0.01, 0.1]},
             scoring=&#x27;roc_auc&#x27;, verbose=2)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-23" type="checkbox" ><label for="sk-estimator-id-23" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;svm&#x27;, SVC(cache_size=150, max_iter=100, random_state=123))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-24" type="checkbox" ><label for="sk-estimator-id-24" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-25" type="checkbox" ><label for="sk-estimator-id-25" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC(cache_size=150, max_iter=100, random_state=123)</pre></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best params:</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_svm</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best cross-validation score: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_svm</span><span class="o">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test-set score: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_svm</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best params:
{&#39;svm__C&#39;: 0.1, &#39;svm__gamma&#39;: 0.1}

Best cross-validation score: 0.58
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test-set score: 0.97
</pre></div>
</div>
</div>
</div>
<p>Los mejores parámetros ajustados para el modelo SVM son C = 0.1 y gamma = 0.1. Con estos valores de hiperparámetros, el modelo SVM ha logrado una puntuación inadecuada en la validación cruzada del 58% y un rendimiento notable en el conjunto de prueba, con una puntuación del 97%. Estos resultados sugieren que el ajuste de los hiperparámetros mejorarían el rendimiento del modelo SVM en comparación con la versión sin ajuste.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_params_svm</span> <span class="o">=</span> <span class="n">grid_svm</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">params_svm</span> <span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">param</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">best_params_svm</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> 
<span class="n">best_pipe_svm</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span><span class="n">SVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">cache_size</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="o">**</span><span class="n">params_svm</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">))])</span>
<span class="n">best_pipe_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-8 {color: black;}#sk-container-id-8 pre{padding: 0;}#sk-container-id-8 div.sk-toggleable {background-color: white;}#sk-container-id-8 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-8 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-8 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-8 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-8 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-8 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-8 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-8 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-8 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-8 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-8 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-8 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-8 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-8 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-8 div.sk-item {position: relative;z-index: 1;}#sk-container-id-8 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-8 div.sk-item::before, #sk-container-id-8 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-8 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-8 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-8 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-8 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-8 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-8 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-8 div.sk-label-container {text-align: center;}#sk-container-id-8 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-8 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-8" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;svm&#x27;,
                 SVC(C=0.1, cache_size=150, gamma=0.1, max_iter=100,
                     probability=True, random_state=123))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-26" type="checkbox" ><label for="sk-estimator-id-26" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;svm&#x27;,
                 SVC(C=0.1, cache_size=150, gamma=0.1, max_iter=100,
                     probability=True, random_state=123))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-27" type="checkbox" ><label for="sk-estimator-id-27" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-28" type="checkbox" ><label for="sk-estimator-id-28" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC(C=0.1, cache_size=150, gamma=0.1, max_iter=100, probability=True,
    random_state=123)</pre></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.97537   0.99482   0.98500     19508
           1    0.01942   0.00407   0.00672       492

    accuracy                        0.97045     20000
   macro avg    0.49740   0.49944   0.49586     20000
weighted avg    0.95186   0.97045   0.96094     20000
</pre></div>
</div>
</div>
</div>
<p>Después de ajustar los hiperparámetros del modelo SVM, observamos mejoras en la precisión y recall para las transacciones no fraudulentas, con una precisión del 97.53% y un recall del 99.48%. Sin embargo, la detección de transacciones fraudulentas sigue siendo problemática, con una precisión de solo 0.01% y un recall del 0.004%.  En general, a pesar de las mejoras, el modelo SVM aún no es eficaz o bueno en la detección de fraudes y necesita una mayor optimización para abordar este desafío.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_scores_svm</span> <span class="o">=</span> <span class="n">best_pipe_svm</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_scores_svm</span><span class="p">)</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Curva ROC (área = </span><span class="si">%0.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">roc_auc</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC - SVM&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6e50819957c504a287b368921e7c5ad4fc65261343a36f57833084f395e50b81.png" src="_images/6e50819957c504a287b368921e7c5ad4fc65261343a36f57833084f395e50b81.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> 
    <span class="p">{</span><span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;SVM&#39;</span><span class="p">,</span> <span class="s1">&#39;precision 0&#39;</span><span class="p">:</span> <span class="mf">0.9753</span><span class="p">,</span> <span class="s1">&#39;precision 1&#39;</span><span class="p">:</span> <span class="mf">0.0194</span><span class="p">,</span><span class="s1">&#39;recall 0&#39;</span><span class="p">:</span> <span class="mf">0.9948</span> <span class="p">,</span> <span class="s1">&#39;recall 1&#39;</span><span class="p">:</span> <span class="mf">0.0040</span><span class="p">,</span> <span class="s1">&#39;f1-score 0&#39;</span><span class="p">:</span> <span class="mf">0.9850</span><span class="p">,</span> <span class="s1">&#39;f1-score 1&#39;</span><span class="p">:</span> <span class="mf">0.0067</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="mf">0.56</span><span class="p">},)</span>
</pre></div>
</div>
</div>
</div>
<p>El modelo de clasificación SVM muestra un puntaje AUC-ROC de 0.56, lo que indica un rendimiento limitado en la capacidad de distinguir entre clases en el conjunto de datos. Puntujaes de AUC-ROC alredor de 0.5 sugeriría un rendimiento aleatorio, lo que significa que el modelo no es mucho mejor que una elección aleatoria.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm_svm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm_svm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">},</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matriz de confusión SVM&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1c0d4df22caf569eb348094b05691eb5a67079bae25fd69409d8ffcdce930560.png" src="_images/1c0d4df22caf569eb348094b05691eb5a67079bae25fd69409d8ffcdce930560.png" />
</div>
</div>
<p>Acerca de la matriz de confunción, se muestra que el modelo le cuesta dectectar lo que no son fraude y también los fraudes.</p>
<p>MODELO NAIVE BAYES</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_nb</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;nb&#39;</span><span class="p">,</span><span class="n">GaussianNB</span><span class="p">())])</span>
<span class="n">pipe_nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pipe_nb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.98951   0.66721   0.79701     19508
           1    0.05171   0.71951   0.09648       492

    accuracy                        0.66850     20000
   macro avg    0.52061   0.69336   0.44675     20000
weighted avg    0.96644   0.66850   0.77978     20000
</pre></div>
</div>
</div>
</div>
<p>El modelo Naive Bayes sin ajuste de hiperparámetros presenta un desempeño deficiente en la detección de transacciones fraudulentas, con una baja precisión de 0.0517 y un F1-score de 0.09648 para la clase de transacciones fraudulentas.  lo que indica un bajo rendimiento en la clasificación de fraudes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid_nb</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;nb__var_smoothing&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">]</span>
                    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_nb</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;nb&#39;</span><span class="p">,</span><span class="n">GaussianNB</span><span class="p">())])</span>
<span class="n">grid_nb</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe_nb</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid_nb</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">grid_nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 5 folds for each of 4 candidates, totalling 20 fits
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-9 {color: black;}#sk-container-id-9 pre{padding: 0;}#sk-container-id-9 div.sk-toggleable {background-color: white;}#sk-container-id-9 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-9 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-9 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-9 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-9 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-9 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-9 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-9 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-9 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-9 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-9 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-9 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-9 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-9 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-9 div.sk-item {position: relative;z-index: 1;}#sk-container-id-9 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-9 div.sk-item::before, #sk-container-id-9 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-9 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-9 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-9 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-9 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-9 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-9 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-9 div.sk-label-container {text-align: center;}#sk-container-id-9 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-9 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-9" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;nb&#x27;, GaussianNB())]),
             n_jobs=-1,
             param_grid={&#x27;nb__var_smoothing&#x27;: [1e-09, 1e-08, 1e-07, 1e-06]},
             scoring=&#x27;roc_auc&#x27;, verbose=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-29" type="checkbox" ><label for="sk-estimator-id-29" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;nb&#x27;, GaussianNB())]),
             n_jobs=-1,
             param_grid={&#x27;nb__var_smoothing&#x27;: [1e-09, 1e-08, 1e-07, 1e-06]},
             scoring=&#x27;roc_auc&#x27;, verbose=2)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-30" type="checkbox" ><label for="sk-estimator-id-30" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()), (&#x27;nb&#x27;, GaussianNB())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-31" type="checkbox" ><label for="sk-estimator-id-31" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-32" type="checkbox" ><label for="sk-estimator-id-32" class="sk-toggleable__label sk-toggleable__label-arrow">GaussianNB</label><div class="sk-toggleable__content"><pre>GaussianNB()</pre></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best params:</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_nb</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best cross-validation score: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_nb</span><span class="o">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test-set score: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_nb</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best params:
{&#39;nb__var_smoothing&#39;: 1e-06}

Best cross-validation score: 0.76
Test-set score: 0.80
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_params_nb</span> <span class="o">=</span> <span class="n">grid_nb</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">params_nb</span> <span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">param</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">best_params_nb</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> 
<span class="n">best_pipe_nb</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;nb&#39;</span><span class="p">,</span><span class="n">GaussianNB</span><span class="p">(</span><span class="o">**</span><span class="n">params_nb</span><span class="p">))])</span>
<span class="n">best_pipe_nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-10 {color: black;}#sk-container-id-10 pre{padding: 0;}#sk-container-id-10 div.sk-toggleable {background-color: white;}#sk-container-id-10 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-10 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-10 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-10 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-10 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-10 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-10 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-10 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-10 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-10 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-10 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-10 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-10 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-10 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-10 div.sk-item {position: relative;z-index: 1;}#sk-container-id-10 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-10 div.sk-item::before, #sk-container-id-10 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-10 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-10 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-10 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-10 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-10 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-10 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-10 div.sk-label-container {text-align: center;}#sk-container-id-10 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-10 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-10" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;nb&#x27;, GaussianNB(var_smoothing=1e-06))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-33" type="checkbox" ><label for="sk-estimator-id-33" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;nb&#x27;, GaussianNB(var_smoothing=1e-06))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-34" type="checkbox" ><label for="sk-estimator-id-34" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-35" type="checkbox" ><label for="sk-estimator-id-35" class="sk-toggleable__label sk-toggleable__label-arrow">GaussianNB</label><div class="sk-toggleable__content"><pre>GaussianNB(var_smoothing=1e-06)</pre></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_nb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.98676   0.80982   0.88958     19508
           1    0.07018   0.56911   0.12494       492

    accuracy                        0.80390     20000
   macro avg    0.52847   0.68946   0.50726     20000
weighted avg    0.96421   0.80390   0.87077     20000
</pre></div>
</div>
</div>
</div>
<p>Después de ajustar los hiperparámetros, el modelo Naive Bayes mejoró su precisión general al 56%, pero todavía muestra un rendimiento deficiente en la detección de transacciones fraudulentas con una precisión de solo 0.07 y un F1-score de 0.12 para esta clase.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_scores_nb</span> <span class="o">=</span> <span class="n">best_pipe_nb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_scores_nb</span><span class="p">)</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Curva ROC (área = </span><span class="si">%0.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">roc_auc</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC - Naive Bayes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dc738f248170e6feccf2914daf55e8cc8e3f9852790ec9c0233ced3e02722c8f.png" src="_images/dc738f248170e6feccf2914daf55e8cc8e3f9852790ec9c0233ced3e02722c8f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> 
    <span class="p">{</span><span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Naive Bayes&#39;</span><span class="p">,</span> <span class="s1">&#39;precision 0&#39;</span><span class="p">:</span> <span class="mf">0.9867</span><span class="p">,</span> <span class="s1">&#39;precision 1&#39;</span><span class="p">:</span> <span class="mf">0.07018</span><span class="p">,</span><span class="s1">&#39;recall 0&#39;</span><span class="p">:</span> <span class="mf">0.8098</span> <span class="p">,</span> <span class="s1">&#39;recall 1&#39;</span><span class="p">:</span> <span class="mf">0.56911</span><span class="p">,</span> <span class="s1">&#39;f1-score 0&#39;</span><span class="p">:</span> <span class="mf">0.88958</span><span class="p">,</span> <span class="s1">&#39;f1-score 1&#39;</span><span class="p">:</span> <span class="mf">0.12494</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="mf">0.74</span><span class="p">},)</span>
</pre></div>
</div>
</div>
</div>
<p>El modelo Naive Bayes ha logrado un AUC-ROC Score de 0.7388, lo que sugiere que tiene un rendimiento razonable en la clasificación de las transacciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm_nb</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_nb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm_nb</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">},</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matriz de confusión Naive Bayes&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05bdb297cc8288637dfa9cab5d8ecf38ecf0b882966003c1407695a6ae787a4a.png" src="_images/05bdb297cc8288637dfa9cab5d8ecf38ecf0b882966003c1407695a6ae787a4a.png" />
</div>
</div>
<p>La matriz de confusión muestra que el modelo implementado le cuesta dectectar los que no son Fraude, pero también los que realmente son fraudes.</p>
<p>MODELO XG BOOST</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_xb</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;xb&#39;</span><span class="p">,</span><span class="n">XGBClassifier</span><span class="p">())])</span>
<span class="n">pipe_xb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pipe_xb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.98553   0.99867   0.99206     19508
           1    0.88793   0.41870   0.56906       492

    accuracy                        0.98440     20000
   macro avg    0.93673   0.70868   0.78056     20000
weighted avg    0.98313   0.98440   0.98165     20000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid_xb</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xb__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>  <span class="c1"># Estimadores</span>
                 <span class="s1">&#39;xb__learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>  <span class="c1"># alphas,</span>
                 <span class="s1">&#39;xb__booster&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gblinear&#39;</span><span class="p">,</span> <span class="s1">&#39;gbtree&#39;</span><span class="p">]}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_xb</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;xb&#39;</span><span class="p">,</span><span class="n">XGBClassifier</span><span class="p">())])</span>
<span class="n">grid_xb</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe_xb</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid_xb</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">grid_xb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 5 folds for each of 8 candidates, totalling 40 fits
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-11 {color: black;}#sk-container-id-11 pre{padding: 0;}#sk-container-id-11 div.sk-toggleable {background-color: white;}#sk-container-id-11 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-11 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-11 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-11 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-11 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-11 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-11 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-11 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-11 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-11 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-11 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-11 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-11 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-11 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-11 div.sk-item {position: relative;z-index: 1;}#sk-container-id-11 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-11 div.sk-item::before, #sk-container-id-11 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-11 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-11 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-11 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-11 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-11 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-11 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-11 div.sk-label-container {text-align: center;}#sk-container-id-11 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-11 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-11" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;xb&#x27;,
                                        XGBClassifier(base_score=None,
                                                      booster=None,
                                                      callbacks=None,
                                                      colsample_bylevel=None,
                                                      colsample_bynode=None,
                                                      colsample_bytree=None,
                                                      device=None,
                                                      early_stopping_rounds=None,
                                                      enable_categorical=False,
                                                      eval_metric=None,
                                                      feature_types=None,
                                                      gamma=None,
                                                      grow_policy=None,
                                                      importance_type=Non...
                                                      max_delta_step=None,
                                                      max_depth=None,
                                                      max_leaves=None,
                                                      min_child_weight=None,
                                                      missing=nan,
                                                      monotone_constraints=None,
                                                      multi_strategy=None,
                                                      n_estimators=None,
                                                      n_jobs=None,
                                                      num_parallel_tree=None,
                                                      random_state=None, ...))]),
             n_jobs=-1,
             param_grid={&#x27;xb__booster&#x27;: [&#x27;gblinear&#x27;, &#x27;gbtree&#x27;],
                         &#x27;xb__learning_rate&#x27;: [0.01, 0.1],
                         &#x27;xb__n_estimators&#x27;: [100, 200]},
             scoring=&#x27;roc_auc&#x27;, verbose=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-36" type="checkbox" ><label for="sk-estimator-id-36" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;xb&#x27;,
                                        XGBClassifier(base_score=None,
                                                      booster=None,
                                                      callbacks=None,
                                                      colsample_bylevel=None,
                                                      colsample_bynode=None,
                                                      colsample_bytree=None,
                                                      device=None,
                                                      early_stopping_rounds=None,
                                                      enable_categorical=False,
                                                      eval_metric=None,
                                                      feature_types=None,
                                                      gamma=None,
                                                      grow_policy=None,
                                                      importance_type=Non...
                                                      max_delta_step=None,
                                                      max_depth=None,
                                                      max_leaves=None,
                                                      min_child_weight=None,
                                                      missing=nan,
                                                      monotone_constraints=None,
                                                      multi_strategy=None,
                                                      n_estimators=None,
                                                      n_jobs=None,
                                                      num_parallel_tree=None,
                                                      random_state=None, ...))]),
             n_jobs=-1,
             param_grid={&#x27;xb__booster&#x27;: [&#x27;gblinear&#x27;, &#x27;gbtree&#x27;],
                         &#x27;xb__learning_rate&#x27;: [0.01, 0.1],
                         &#x27;xb__n_estimators&#x27;: [100, 200]},
             scoring=&#x27;roc_auc&#x27;, verbose=2)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-37" type="checkbox" ><label for="sk-estimator-id-37" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;xb&#x27;,
                 XGBClassifier(base_score=None, booster=None, callbacks=None,
                               colsample_bylevel=None, colsample_bynode=None,
                               colsample_bytree=None, device=None,
                               early_stopping_rounds=None,
                               enable_categorical=False, eval_metric=None,
                               feature_types=None, gamma=None, grow_policy=None,
                               importance_type=None,
                               interaction_constraints=None, learning_rate=None,
                               max_bin=None, max_cat_threshold=None,
                               max_cat_to_onehot=None, max_delta_step=None,
                               max_depth=None, max_leaves=None,
                               min_child_weight=None, missing=nan,
                               monotone_constraints=None, multi_strategy=None,
                               n_estimators=None, n_jobs=None,
                               num_parallel_tree=None, random_state=None, ...))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-38" type="checkbox" ><label for="sk-estimator-id-38" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-39" type="checkbox" ><label for="sk-estimator-id-39" class="sk-toggleable__label sk-toggleable__label-arrow">XGBClassifier</label><div class="sk-toggleable__content"><pre>XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=None,
              num_parallel_tree=None, random_state=None, ...)</pre></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best params:</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_xb</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best cross-validation score: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_xb</span><span class="o">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test-set score: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_xb</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best params:
{&#39;xb__booster&#39;: &#39;gbtree&#39;, &#39;xb__learning_rate&#39;: 0.1, &#39;xb__n_estimators&#39;: 200}

Best cross-validation score: 0.92
Test-set score: 0.98
</pre></div>
</div>
</div>
</div>
<p>Con la optimización de hiperparámetros, el modelo XGBoost mejora significativamente. Los mejores parámetros son booster=’gbtree’, learning_rate=0.1 y n_estimators=200. El rendimiento en el set de prueba aumenta a un 98% de precisión y un 92% en la mejor validación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_params_xb</span> <span class="o">=</span> <span class="n">grid_xb</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">params_xb</span> <span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">param</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">best_params_xb</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> 
<span class="n">best_pipe_xb</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;xb&#39;</span><span class="p">,</span><span class="n">XGBClassifier</span><span class="p">())])</span>
<span class="n">best_pipe_xb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-12 {color: black;}#sk-container-id-12 pre{padding: 0;}#sk-container-id-12 div.sk-toggleable {background-color: white;}#sk-container-id-12 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-12 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-12 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-12 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-12 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-12 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-12 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-12 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-12 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-12 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-12 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-12 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-12 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-12 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-12 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-12 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-12 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-12 div.sk-item {position: relative;z-index: 1;}#sk-container-id-12 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-12 div.sk-item::before, #sk-container-id-12 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-12 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-12 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-12 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-12 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-12 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-12 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-12 div.sk-label-container {text-align: center;}#sk-container-id-12 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-12 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-12" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;xb&#x27;,
                 XGBClassifier(base_score=None, booster=None, callbacks=None,
                               colsample_bylevel=None, colsample_bynode=None,
                               colsample_bytree=None, device=None,
                               early_stopping_rounds=None,
                               enable_categorical=False, eval_metric=None,
                               feature_types=None, gamma=None, grow_policy=None,
                               importance_type=None,
                               interaction_constraints=None, learning_rate=None,
                               max_bin=None, max_cat_threshold=None,
                               max_cat_to_onehot=None, max_delta_step=None,
                               max_depth=None, max_leaves=None,
                               min_child_weight=None, missing=nan,
                               monotone_constraints=None, multi_strategy=None,
                               n_estimators=None, n_jobs=None,
                               num_parallel_tree=None, random_state=None, ...))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-40" type="checkbox" ><label for="sk-estimator-id-40" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;xb&#x27;,
                 XGBClassifier(base_score=None, booster=None, callbacks=None,
                               colsample_bylevel=None, colsample_bynode=None,
                               colsample_bytree=None, device=None,
                               early_stopping_rounds=None,
                               enable_categorical=False, eval_metric=None,
                               feature_types=None, gamma=None, grow_policy=None,
                               importance_type=None,
                               interaction_constraints=None, learning_rate=None,
                               max_bin=None, max_cat_threshold=None,
                               max_cat_to_onehot=None, max_delta_step=None,
                               max_depth=None, max_leaves=None,
                               min_child_weight=None, missing=nan,
                               monotone_constraints=None, multi_strategy=None,
                               n_estimators=None, n_jobs=None,
                               num_parallel_tree=None, random_state=None, ...))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-41" type="checkbox" ><label for="sk-estimator-id-41" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-42" type="checkbox" ><label for="sk-estimator-id-42" class="sk-toggleable__label sk-toggleable__label-arrow">XGBClassifier</label><div class="sk-toggleable__content"><pre>XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=None,
              num_parallel_tree=None, random_state=None, ...)</pre></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_xb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.98553   0.99867   0.99206     19508
           1    0.88793   0.41870   0.56906       492

    accuracy                        0.98440     20000
   macro avg    0.93673   0.70868   0.78056     20000
weighted avg    0.98313   0.98440   0.98165     20000
</pre></div>
</div>
</div>
</div>
<p>El modelo XGBoost, después de tener en cuenta sus mejores hiperparámetros, logra un rendimiento significativamente mejor con una precisión del 88.79% y una capacidad de detección (recall) del 41.87% en la clasificación de fraudes. Esto se muestra en el puntaje F1 de 56.90, lo que demuestra un equilibrio mejorado entre la precisión y la capacidad de detección de fraudes en comparación con el modelo sin ajuste de hiperparámetros.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_scores_xb</span> <span class="o">=</span> <span class="n">best_pipe_xb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_scores_xb</span><span class="p">)</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Curva ROC (área = </span><span class="si">%0.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">roc_auc</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC-XGBoost&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1076e9f82a0ed5b906f109b663a50ae55e36a3800c65a47ee2bbf7b1b212c269.png" src="_images/1076e9f82a0ed5b906f109b663a50ae55e36a3800c65a47ee2bbf7b1b212c269.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> 
    <span class="p">{</span><span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;XGBoost&#39;</span><span class="p">,</span> <span class="s1">&#39;precision 0&#39;</span><span class="p">:</span> <span class="mf">0.9855</span><span class="p">,</span> <span class="s1">&#39;precision 1&#39;</span><span class="p">:</span> <span class="mf">0.8879</span><span class="p">,</span><span class="s1">&#39;recall 0&#39;</span><span class="p">:</span> <span class="mf">0.9986</span> <span class="p">,</span> <span class="s1">&#39;recall 1&#39;</span><span class="p">:</span> <span class="mf">0.4187</span><span class="p">,</span> <span class="s1">&#39;f1-score 0&#39;</span><span class="p">:</span> <span class="mf">0.9920</span><span class="p">,</span> <span class="s1">&#39;f1-score 1&#39;</span><span class="p">:</span> <span class="mf">0.5690</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="mf">0.92</span><span class="p">},)</span>
</pre></div>
</div>
</div>
</div>
<p>El modelo XGBoost tiene un adecuado puntaje AUC-ROC de 0.92, lo que indica que tiene una buena capacidad para clasificar transacciones fraudulentas y no fraudulentas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm_xb</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_xb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm_xb</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">},</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matriz de confusión XGBoost&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2cdb71e010a2be3b86944a76795a6c928b2a41ee4222c5e31e52bff28f7c5c79.png" src="_images/2cdb71e010a2be3b86944a76795a6c928b2a41ee4222c5e31e52bff28f7c5c79.png" />
</div>
</div>
<p>En la matriz de confusión podemos observar que el modelo XGboost es bueno para clasificar la Clase 0 (no fraude) como también la clase 1 (Fraude).</p>
<p>MODELO MLP</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_mlp</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;mlp&#39;</span><span class="p">,</span><span class="n">MLPClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">early_stopping</span><span class="o">=</span><span class="kc">True</span><span class="p">))])</span>
<span class="n">pipe_mlp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pipe_mlp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.98328   0.99764   0.99041     19508
           1    0.77778   0.32724   0.46066       492

    accuracy                        0.98115     20000
   macro avg    0.88053   0.66244   0.72553     20000
weighted avg    0.97822   0.98115   0.97738     20000
</pre></div>
</div>
</div>
</div>
<p>El modelo MLP (Multilayer Perceptron) sin ajuste de hiperparámetros muestra un rendimiento sólido en la clasificación de transacciones no fraudulentas (clase 0) con una alta precisión y recall. Sin embargo, su rendimiento en la clasificación de transacciones fraudulentas (clase 1) es inferior, lo que se refleja en una precisión más baja y un puntaje F1 más bajo para esta clase. El puntaje F1 general del modelo es de 0.7255, lo que indica un rendimiento razonable en la clasificación binaria. La precisión general del modelo es del 97.82%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid_mlp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mlp__hidden_layer_sizes&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span>
    <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span> <span class="s1">&#39;mlp__activation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;logistic&quot;</span><span class="p">,</span> <span class="s2">&quot;tanh&quot;</span><span class="p">,</span> <span class="s2">&quot;relu&quot;</span><span class="p">]}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_mlp</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;mlp&#39;</span><span class="p">,</span><span class="n">MLPClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">early_stopping</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">300</span><span class="p">))])</span>
<span class="n">grid_mlp</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe_mlp</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid_mlp</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">grid_mlp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 5 folds for each of 6 candidates, totalling 30 fits
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-13 {color: black;}#sk-container-id-13 pre{padding: 0;}#sk-container-id-13 div.sk-toggleable {background-color: white;}#sk-container-id-13 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-13 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-13 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-13 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-13 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-13 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-13 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-13 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-13 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-13 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-13 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-13 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-13 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-13 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-13 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-13 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-13 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-13 div.sk-item {position: relative;z-index: 1;}#sk-container-id-13 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-13 div.sk-item::before, #sk-container-id-13 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-13 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-13 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-13 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-13 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-13 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-13 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-13 div.sk-label-container {text-align: center;}#sk-container-id-13 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-13 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-13" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;mlp&#x27;,
                                        MLPClassifier(batch_size=300,
                                                      early_stopping=True,
                                                      max_iter=100,
                                                      random_state=123))]),
             n_jobs=-1,
             param_grid={&#x27;mlp__activation&#x27;: [&#x27;logistic&#x27;, &#x27;tanh&#x27;, &#x27;relu&#x27;],
                         &#x27;mlp__hidden_layer_sizes&#x27;: [[10, 10], [10, 10, 10]]},
             scoring=&#x27;roc_auc&#x27;, verbose=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-43" type="checkbox" ><label for="sk-estimator-id-43" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;mlp&#x27;,
                                        MLPClassifier(batch_size=300,
                                                      early_stopping=True,
                                                      max_iter=100,
                                                      random_state=123))]),
             n_jobs=-1,
             param_grid={&#x27;mlp__activation&#x27;: [&#x27;logistic&#x27;, &#x27;tanh&#x27;, &#x27;relu&#x27;],
                         &#x27;mlp__hidden_layer_sizes&#x27;: [[10, 10], [10, 10, 10]]},
             scoring=&#x27;roc_auc&#x27;, verbose=2)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-44" type="checkbox" ><label for="sk-estimator-id-44" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;mlp&#x27;,
                 MLPClassifier(batch_size=300, early_stopping=True,
                               max_iter=100, random_state=123))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-45" type="checkbox" ><label for="sk-estimator-id-45" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-46" type="checkbox" ><label for="sk-estimator-id-46" class="sk-toggleable__label sk-toggleable__label-arrow">MLPClassifier</label><div class="sk-toggleable__content"><pre>MLPClassifier(batch_size=300, early_stopping=True, max_iter=100,
              random_state=123)</pre></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best params:</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_mlp</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best cross-validation score: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_mlp</span><span class="o">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test-set score: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_mlp</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best params:
{&#39;mlp__activation&#39;: &#39;relu&#39;, &#39;mlp__hidden_layer_sizes&#39;: [10, 10]}

Best cross-validation score: 0.86
Test-set score: 0.98
</pre></div>
</div>
</div>
</div>
<p>El modelo MLP con ajuste de hiperparámetros muestra un rendimiento general adecuado. En el mejor modelo se utilizaron tres capas ocultas con 10 neuronas cada una y la función de activación ‘ReLU’. Esto representa un score del 98% en los datos de prueba y un 86% en la validación cruzada. El modelo presenta un equilibrio razonable entre precisión y recall para ambas clases, aunque puede haber margen para mejorar aún más el rendimiento en la clasificación de transacciones fraudulentas (clase 1) si se considera necesario.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_params_mlp</span> <span class="o">=</span> <span class="n">grid_mlp</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">params_mlp</span> <span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">param</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">best_params_mlp</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> 
<span class="n">best_pipe_mlp</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;mlp&#39;</span><span class="p">,</span><span class="n">MLPClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">early_stopping</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">300</span><span class="p">))])</span>
<span class="n">best_pipe_mlp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-14 {color: black;}#sk-container-id-14 pre{padding: 0;}#sk-container-id-14 div.sk-toggleable {background-color: white;}#sk-container-id-14 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-14 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-14 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-14 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-14 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-14 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-14 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-14 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-14 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-14 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-14 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-14 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-14 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-14 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-14 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-14 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-14 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-14 div.sk-item {position: relative;z-index: 1;}#sk-container-id-14 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-14 div.sk-item::before, #sk-container-id-14 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-14 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-14 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-14 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-14 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-14 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-14 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-14 div.sk-label-container {text-align: center;}#sk-container-id-14 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-14 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-14" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;mlp&#x27;,
                 MLPClassifier(batch_size=300, early_stopping=True,
                               max_iter=100, random_state=123))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-47" type="checkbox" ><label for="sk-estimator-id-47" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;mlp&#x27;,
                 MLPClassifier(batch_size=300, early_stopping=True,
                               max_iter=100, random_state=123))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-48" type="checkbox" ><label for="sk-estimator-id-48" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-49" type="checkbox" ><label for="sk-estimator-id-49" class="sk-toggleable__label sk-toggleable__label-arrow">MLPClassifier</label><div class="sk-toggleable__content"><pre>MLPClassifier(batch_size=300, early_stopping=True, max_iter=100,
              random_state=123)</pre></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_mlp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0    0.98318   0.99774   0.99041     19508
           1    0.78325   0.32317   0.45755       492

    accuracy                        0.98115     20000
   macro avg    0.88322   0.66046   0.72398     20000
weighted avg    0.97826   0.98115   0.97730     20000
</pre></div>
</div>
</div>
</div>
<p>El modelo MLP ajustado logra una precisión general del 98.31%, con un recall del 99.774% para la clase no fraudulenta (0). Por otro lado, una presición d 78.325% y un recall del 32.31% para la clase fraudulenta (1). Esto significa que el modelo tiene un alto rendimiento en la detección de transacciones no fraudulentas, pero un rendimiento inferior en la detección de transacciones fraudulentas. La puntuación F1-score en general es del 97.730%</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_scores_mlp</span> <span class="o">=</span> <span class="n">best_pipe_mlp</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_scores_mlp</span><span class="p">)</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Curva ROC (área = </span><span class="si">%0.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">roc_auc</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC MLP&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4901dc3d5dc3eb0dc608fa17fcfbf2041135e77efe9225f0195802065c162d62.png" src="_images/4901dc3d5dc3eb0dc608fa17fcfbf2041135e77efe9225f0195802065c162d62.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> 
    <span class="p">{</span><span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;MLP&#39;</span><span class="p">,</span> <span class="s1">&#39;precision 0&#39;</span><span class="p">:</span> <span class="mf">0.98318</span><span class="p">,</span> <span class="s1">&#39;precision 1&#39;</span><span class="p">:</span> <span class="mf">0.78325</span><span class="p">,</span><span class="s1">&#39;recall 0&#39;</span><span class="p">:</span> <span class="mf">0.9977</span> <span class="p">,</span> <span class="s1">&#39;recall 1&#39;</span><span class="p">:</span> <span class="mf">0.3231</span><span class="p">,</span> <span class="s1">&#39;f1-score 0&#39;</span><span class="p">:</span> <span class="mf">0.9904</span><span class="p">,</span> <span class="s1">&#39;f1-score 1&#39;</span><span class="p">:</span> <span class="mf">0.4575</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="mf">0.87</span><span class="p">},)</span>
</pre></div>
</div>
</div>
</div>
<p>El modelo MLP obtiene un AUC-ROC Score de 0.87, lo que sugiere un buen rendimiento en la clasificación de las transacciones en términos de la curva ROC.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm_mlp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_pipe_mlp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm_mlp</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">},</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Fraude&quot;</span><span class="p">,</span> <span class="s2">&quot;Fraude&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matriz de confusión MLP&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5a850e9efb7407acbc53577aecce20c114e8394eb09fae527dcb331ac99eeb36.png" src="_images/5a850e9efb7407acbc53577aecce20c114e8394eb09fae527dcb331ac99eeb36.png" />
</div>
</div>
<p>Similar al modelo XGBoost el modelo MLP sirve para clasificar balanceadamente las clases 0 y 1.</p>
<p>COMPARACION DE LOS MODELOS DE CLASIFICACION</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;AUC&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>precision 0</th>
      <th>precision 1</th>
      <th>recall 0</th>
      <th>recall 1</th>
      <th>f1-score 0</th>
      <th>f1-score 1</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>XGBoost</td>
      <td>0.98550</td>
      <td>0.88790</td>
      <td>0.99860</td>
      <td>0.41870</td>
      <td>0.99200</td>
      <td>0.56900</td>
      <td>0.9200</td>
    </tr>
    <tr>
      <th>6</th>
      <td>MLP</td>
      <td>0.98318</td>
      <td>0.78325</td>
      <td>0.99770</td>
      <td>0.32310</td>
      <td>0.99040</td>
      <td>0.45750</td>
      <td>0.8700</td>
    </tr>
    <tr>
      <th>2</th>
      <td>KNN</td>
      <td>0.98004</td>
      <td>0.84821</td>
      <td>0.99913</td>
      <td>0.19309</td>
      <td>0.98949</td>
      <td>0.31457</td>
      <td>0.8100</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Lasso</td>
      <td>0.97800</td>
      <td>0.76620</td>
      <td>0.99920</td>
      <td>0.11170</td>
      <td>0.98850</td>
      <td>0.19570</td>
      <td>0.8056</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ridge</td>
      <td>0.97618</td>
      <td>0.94110</td>
      <td>0.99950</td>
      <td>0.03250</td>
      <td>0.98792</td>
      <td>0.06287</td>
      <td>0.7800</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Naive Bayes</td>
      <td>0.98670</td>
      <td>0.07018</td>
      <td>0.80980</td>
      <td>0.56911</td>
      <td>0.88958</td>
      <td>0.12494</td>
      <td>0.7400</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SVM</td>
      <td>0.97530</td>
      <td>0.01940</td>
      <td>0.99480</td>
      <td>0.00400</td>
      <td>0.98500</td>
      <td>0.00670</td>
      <td>0.5600</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Teniendo en cuenta las métricas de rendimiento y el AUC de los diferentes modelos de clasificación, podemos observar lo siguiente:</p>
<p>En primer lugar, XGBoost y MLP son los modelos que muestran el mejor rendimiento general. XGBoost tiene la mayor precisión en la clase 0 (transacciones no fraudulentas) y el mayor valor de F1-score en la clase 1 (transacciones fraudulentas), es decir que tiene una capacidad sólida para clasificar ambas clases. Además, XGBoost presenta el AUC más alto, lo que sugiere una excelente capacidad para distinguir entre las clases. Por otro lado, KNN también se desempeña bien, con una alta precisión en la clase 0 y un F1-score decente en la clase 1. Sin embargo, su AUC es un poco más bajo en comparación con XGBoost y MLP. Ahora bien, los modelos Lasso y Ridge, aunque tienen una alta precisión en la clase 0, tienen un bajo rendimiento en términos de recall y F1-score en la clase 1, lo que indica dificultades para detectar transacciones fraudulentas. Además, sus AUC son más bajos en comparación con los modelos XGBoost y MLP. Naive Bayes muestra un buen rendimiento en términos de recall en la clase 1, pero su precisión en esa clase es muy baja, lo que lleva a un F1-score bajo. Su AUC está en un rango regular en comparación con los otros modelos. Finalmente, el modelo SVM presenta la precisión más baja en la clase 1, lo que resulta en un F1-score muy bajo en esa clase. Además, su AUC es el más bajo entre todos los modelos, lo que sugiere dificultades en distinguir entre las clases.</p>
<p>Wind Speed Data: EDA</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">wind_speed_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/hp/Downloads/data_treino_dv_df_2000_2010.csv&quot;</span><span class="p">)</span>

<span class="n">wind_speed_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>HORA (UTC)</th>
      <th>VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))</th>
      <th>VENTO, VELOCIDADE HORARIA (m/s)</th>
      <th>UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)</th>
      <th>UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)</th>
      <th>TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)</th>
      <th>TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)</th>
      <th>UMIDADE RELATIVA DO AR, HORARIA (%)</th>
      <th>PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)</th>
      <th>PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)</th>
      <th>VENTO, RAJADA MAXIMA (m/s)</th>
      <th>PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)</th>
      <th>PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>El dataset contiene información de la velocidad del viento en determinada hora, en conjunto con otras variables descriptivas tal como temperatura y humedad del aire. En ese sentido, el dataset es utilizado en este caso para predecir la velocidad del viento en función de otras variables.</p>
<p>REDUCCION DE NOMBRES EXTENSOS DE COLUMNAS</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">column_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;HORA (UTC)&#39;</span><span class="p">:</span> <span class="s1">&#39;Hora (UTC)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))&#39;</span><span class="p">:</span> <span class="s1">&#39;Dirección del Viento (grados)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VENTO, VELOCIDADE HORARIA (m/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;Velocidad del Viento (m/s)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)&#39;</span><span class="p">:</span> <span class="s1">&#39;Humedad Relativa Máxima (AUT) (%)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)&#39;</span><span class="p">:</span> <span class="s1">&#39;Humedad Relativa Mínima (AUT) (%)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperatura Máxima (AUT) (°C)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperatura Mínima (AUT) (°C)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UMIDADE RELATIVA DO AR, HORARIA (%)&#39;</span><span class="p">:</span> <span class="s1">&#39;Humedad Relativa del Aire (%)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)&#39;</span><span class="p">:</span> <span class="s1">&#39;Presión Atmosférica Horaria (mB)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)&#39;</span><span class="p">:</span> <span class="s1">&#39;Precipitación Total Horaria (mm)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VENTO, RAJADA MAXIMA (m/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;Rajada Máxima del Viento (m/s)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)&#39;</span><span class="p">:</span> <span class="s1">&#39;Presión Atmosférica Máxima Anterior (AUT) (mB)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)&#39;</span><span class="p">:</span> <span class="s1">&#39;Presión Atmosférica Mínima Anterior (AUT) (mB)&#39;</span>
<span class="p">}</span>

<span class="n">wind_speed_data</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind_speed_data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Hora (UTC)&#39;, &#39;Dirección del Viento (grados)&#39;,
       &#39;Velocidad del Viento (m/s)&#39;, &#39;Humedad Relativa Máxima (AUT) (%)&#39;,
       &#39;Humedad Relativa Mínima (AUT) (%)&#39;, &#39;Temperatura Máxima (AUT) (°C)&#39;,
       &#39;Temperatura Mínima (AUT) (°C)&#39;, &#39;Humedad Relativa del Aire (%)&#39;,
       &#39;Presión Atmosférica Horaria (mB)&#39;, &#39;Precipitación Total Horaria (mm)&#39;,
       &#39;Rajada Máxima del Viento (m/s)&#39;,
       &#39;Presión Atmosférica Máxima Anterior (AUT) (mB)&#39;,
       &#39;Presión Atmosférica Mínima Anterior (AUT) (mB)&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Número de observaciones, media, desviación, mínimo, máximo, cuartiles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind_speed_data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dirección del Viento (grados)</th>
      <th>Velocidad del Viento (m/s)</th>
      <th>Humedad Relativa Máxima (AUT) (%)</th>
      <th>Humedad Relativa Mínima (AUT) (%)</th>
      <th>Temperatura Máxima (AUT) (°C)</th>
      <th>Temperatura Mínima (AUT) (°C)</th>
      <th>Humedad Relativa del Aire (%)</th>
      <th>Presión Atmosférica Horaria (mB)</th>
      <th>Precipitación Total Horaria (mm)</th>
      <th>Rajada Máxima del Viento (m/s)</th>
      <th>Presión Atmosférica Máxima Anterior (AUT) (mB)</th>
      <th>Presión Atmosférica Mínima Anterior (AUT) (mB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.405810</td>
      <td>2.466192</td>
      <td>69.058465</td>
      <td>63.176194</td>
      <td>21.921264</td>
      <td>20.684570</td>
      <td>66.146682</td>
      <td>887.251925</td>
      <td>0.160907</td>
      <td>5.161076</td>
      <td>887.580724</td>
      <td>886.891093</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.686247</td>
      <td>1.313968</td>
      <td>19.640222</td>
      <td>20.166336</td>
      <td>3.721386</td>
      <td>3.513744</td>
      <td>19.992327</td>
      <td>4.012404</td>
      <td>1.307515</td>
      <td>2.311157</td>
      <td>3.646750</td>
      <td>3.564539</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.000000</td>
      <td>0.000000</td>
      <td>12.000000</td>
      <td>10.000000</td>
      <td>9.200000</td>
      <td>8.400000</td>
      <td>10.000000</td>
      <td>863.400000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>865.300000</td>
      <td>862.800000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.156434</td>
      <td>1.500000</td>
      <td>54.000000</td>
      <td>48.000000</td>
      <td>19.200000</td>
      <td>18.400000</td>
      <td>51.000000</td>
      <td>885.300000</td>
      <td>0.000000</td>
      <td>3.400000</td>
      <td>885.600000</td>
      <td>885.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.788011</td>
      <td>2.400000</td>
      <td>72.000000</td>
      <td>64.000000</td>
      <td>21.400000</td>
      <td>20.200000</td>
      <td>68.000000</td>
      <td>887.200000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>887.500000</td>
      <td>886.900000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.970296</td>
      <td>3.400000</td>
      <td>87.000000</td>
      <td>80.000000</td>
      <td>24.700000</td>
      <td>23.100000</td>
      <td>84.000000</td>
      <td>889.100000</td>
      <td>0.000000</td>
      <td>6.800000</td>
      <td>889.300000</td>
      <td>888.800000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>10.000000</td>
      <td>100.000000</td>
      <td>98.000000</td>
      <td>35.300000</td>
      <td>34.400000</td>
      <td>99.000000</td>
      <td>1023.500000</td>
      <td>70.800000</td>
      <td>24.300000</td>
      <td>913.100000</td>
      <td>910.900000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Los datos presentados muestran estadísticas relacionadas a cada variable:</p>
<p>La dirección del viento se expresa en grados, con un valor mínimo de -1 y máximo de 1, lo que indica la variabilidad en la dirección.</p>
<p>La velocidad del viento, medida en metros por segundo, tiene un promedio de 2.47 m/s, con una desviación estándar de 1.31 m/s.</p>
<p>La humedad relativa máxima y mínima alcanzan valores promedio de alrededor del 69% y 63%, respectivamente.</p>
<p>Las temperaturas máxima y mínima promedio son de aproximadamente 21.92 °C y 20.68 °C, respectivamente.</p>
<p>La humedad relativa del aire presenta un promedio del 66.15%, con una desviación estándar de 19.99%.</p>
<p>La presión atmosférica horaria tiene un promedio de 887.25 mB, con variaciones entre 863.4 mB y 1023.5 mB.</p>
<p>La precipitación total horaria tiene un valor promedio de 0.16 mm, con un máximo de 70.8 mm.</p>
<p>La rajada máxima del viento alcanza un promedio de 5.16 m/s, con una desviación estándar de 2.31 m/s.</p>
<p>Las presiones atmosféricas máxima y mínima anteriores tienen un rango de variación entre 862.8 mB y 913.1 mB.</p>
<p>CONTEO DE DATOS FALTANTES</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind_speed_data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hora (UTC)                                        0
Dirección del Viento (grados)                     0
Velocidad del Viento (m/s)                        0
Humedad Relativa Máxima (AUT) (%)                 0
Humedad Relativa Mínima (AUT) (%)                 0
Temperatura Máxima (AUT) (°C)                     0
Temperatura Mínima (AUT) (°C)                     0
Humedad Relativa del Aire (%)                     0
Presión Atmosférica Horaria (mB)                  0
Precipitación Total Horaria (mm)                  0
Rajada Máxima del Viento (m/s)                    0
Presión Atmosférica Máxima Anterior (AUT) (mB)    0
Presión Atmosférica Mínima Anterior (AUT) (mB)    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Se evidencia entonces que no hay datos nulos en ninguna variable, lo cuál indica que el dataset ha sido procesado previamente.</p>
<p>HISTOGRAMA DE LAS VARAIBLES EXPLICATIVAS Y LA VARIABLE A PREDECIR.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">wind_speed_data</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c5fb66abf33a466b570c1dad7974e135b54c83b1536f46497cb090b2969a93df.png" src="_images/c5fb66abf33a466b570c1dad7974e135b54c83b1536f46497cb090b2969a93df.png" />
</div>
</div>
<p>COMENTARIOS:</p>
<p>Dirección del viento: El histograma de la dirección del viento muestra una distribución relativamente uniforme, con un ligero pico a 180 grados (sur). Esto sugiere que la dirección del viento en el dataset es relativamente variable, sin una dirección única que domine salvo por la que se mencionó previamente.</p>
<p>Velocidad del viento: El histograma de la velocidad del viento muestra una distribución sesgada a la derecha, con un pico alrededor de 2 m/s y una larga cola que se extiende a velocidades del viento más altas. Esto sugiere que la mayoría del tiempo, la velocidad del viento es relativamente baja, pero también hay períodos ocasionales de vientos fuertes.</p>
<p>Temperatura: Los histogramas de la temperatura máxima y mínima muestran ambas distribuciones normales, con picos alrededor de 20°C. Esto sugiere que la temperatura en el dataset es relativamente cálida, con períodos ocasionales de calor o frío extremo. Pero aún así, no cambia significativamente entre una hora y otra</p>
<p>Presión atmosférica: El histograma de la presión atmosférica horaria muestra una distribución normal, con un pico alrededor de 890 mB. Esto está cerca de la presión atmosférica media al nivel del mar de 1013,25 mB, lo que sugiere que las mediciones se tomaron a una elevación relativamente baja.</p>
<p>BOXPLOT</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a boxplot for all numerical variables</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">wind_speed_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span>
    <span class="s1">&#39;Presión Atmosférica Máxima Anterior (AUT) (mB)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Presión Atmosférica Mínima Anterior (AUT) (mB)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Presión Atmosférica Horaria (mB)&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot of Numerical Variables&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/301a83baaa78ac9c696a30321a8e5b773a522cf305d4ecdc46dc3951eae97bdb.png" src="_images/301a83baaa78ac9c696a30321a8e5b773a522cf305d4ecdc46dc3951eae97bdb.png" />
</div>
</div>
<p>COMENTARIOS:</p>
<p>Velocidad del viento: La mediana de la velocidad del viento es de alrededor de 2 m/s, lo que sugiere que la mayoría del tiempo, la velocidad del viento es relativamente baja. Sin embargo, el diagrama de caja también muestra que hay una variabilidad significativa en la velocidad del viento, con algunos valores atípicos que superan los 10 m/s. Hay ocasiones en las que la velocidad del viento puede ser muy alta.</p>
<p>Humedad relativa: La mediana de la humedad relativa es de alrededor del 70%, lo que sugiere que el aire es relativamente húmedo la mayoría del tiempo. Sin embargo, el diagrama de caja también muestra que hay una variabilidad significativa en la humedad relativa, con algunos valores atípicos que caen por debajo del 40% o por encima del 80%. Esto sugiere que hay ocasiones en las que el aire puede ser muy seco o muy húmedo.</p>
<p>Temperatura: La mediana de la temperatura es de alrededor de 20°C, lo que sugiere que el clima es relativamente cálido. Sin embargo, el diagrama de caja también muestra que hay una variabilidad significativa en la temperatura, con algunos valores atípicos que caen por debajo de los 10°C o por encima de los 35°C.</p>
<p>MATRIZ DE CORRELACION</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Hora (UTC)&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlation Matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d8c482a2c56b24133a85c33577b475202ca38437285acd5116d2f1a65181ab82.png" src="_images/d8c482a2c56b24133a85c33577b475202ca38437285acd5116d2f1a65181ab82.png" />
</div>
</div>
<p>Las variables que están más fuertemente correlacionadas con la velocidad del viento son la rajada del viento y la humedad relativa del aire. Podría concluirse a priori, por ejemplo, que cuando la velocidad del viento aumenta, la humedad relativa tiende a disminuir, y viceversa.</p>
<p>SCATTERPLOT</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">wind_speed_data</span><span class="p">[[</span>
    <span class="s2">&quot;Velocidad del Viento (m/s)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Dirección del Viento (grados)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Horaria (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Humedad Relativa del Aire (%)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Rajada Máxima del Viento (m/s)&quot;</span>
    <span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ee282e7c107a55ca50174b59cf50ecc9cd268bee14f22d48dc4576be6daf880f.png" src="_images/ee282e7c107a55ca50174b59cf50ecc9cd268bee14f22d48dc4576be6daf880f.png" />
</div>
</div>
<p>Dado que el dataset tiene demasiados registros, se evidencian puntos en todo el gráfico de dispersión.
Entonces, se evidencia por ejemplo que la variable rajada máxima, predice casi que de manera lineal la velocidad del viento, no tan así con las otras variables, sin embargo al momento de modelar, se determinará cuáles son útiles y cuáles no.</p>
<p>SE ELIMINA MULTICOLINEALIDAD</p>
<p>En este paso se quita la variable de la hora y la variable dependiente para verificar el variance_inflation_factor.</p>
<p>Adicionalmente se retira la variable de precipitación, ya que esta no aporta varianza significativa al dataset y además se comprobó en el exploratorio que no explica de ninguna manera la velocidad del viento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>

<span class="c1"># se quita la variable de la hora y la variable dependiente para verificar el variance_inflation_factor</span>
<span class="n">predictive_variables</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span>
    <span class="s2">&quot;Hora (UTC)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Velocidad del Viento (m/s)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Precipitación Total Horaria (mm)&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictive_variables</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Display the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                         Variable            VIF
0                   Dirección del Viento (grados)       1.714619
1               Humedad Relativa Máxima (AUT) (%)    1027.260514
2               Humedad Relativa Mínima (AUT) (%)     868.656360
3                   Temperatura Máxima (AUT) (°C)    2385.341209
4                   Temperatura Mínima (AUT) (°C)    1994.193860
5                   Humedad Relativa del Aire (%)     578.778727
6                Presión Atmosférica Horaria (mB)  239543.952335
7                  Rajada Máxima del Viento (m/s)       7.292113
8  Presión Atmosférica Máxima Anterior (AUT) (mB)  942773.725851
9  Presión Atmosférica Mínima Anterior (AUT) (mB)  964504.355544
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictive_variables</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span>
    <span class="s2">&quot;Hora (UTC)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Velocidad del Viento (m/s)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Precipitación Total Horaria (mm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Mínima Anterior (AUT) (mB)&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictive_variables</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Display the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                         Variable            VIF
0                   Dirección del Viento (grados)       1.714581
1               Humedad Relativa Máxima (AUT) (%)    1027.197096
2               Humedad Relativa Mínima (AUT) (%)     867.958995
3                   Temperatura Máxima (AUT) (°C)    2356.378873
4                   Temperatura Mínima (AUT) (°C)    1971.814345
5                   Humedad Relativa del Aire (%)     578.563060
6                Presión Atmosférica Horaria (mB)  221568.810547
7                  Rajada Máxima del Viento (m/s)       7.283123
8  Presión Atmosférica Máxima Anterior (AUT) (mB)  222220.148467
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictive_variables</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span>
    <span class="s2">&quot;Hora (UTC)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Velocidad del Viento (m/s)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Precipitación Total Horaria (mm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Mínima Anterior (AUT) (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Máxima Anterior (AUT) (mB)&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictive_variables</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Display the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            Variable          VIF
0      Dirección del Viento (grados)     1.714458
1  Humedad Relativa Máxima (AUT) (%)  1027.196759
2  Humedad Relativa Mínima (AUT) (%)   867.882706
3      Temperatura Máxima (AUT) (°C)  2353.807880
4      Temperatura Mínima (AUT) (°C)  1971.095601
5      Humedad Relativa del Aire (%)   578.525551
6   Presión Atmosférica Horaria (mB)   161.461302
7     Rajada Máxima del Viento (m/s)     7.278441
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictive_variables</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span>
    <span class="s2">&quot;Hora (UTC)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Velocidad del Viento (m/s)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Precipitación Total Horaria (mm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Mínima Anterior (AUT) (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Máxima Anterior (AUT) (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Temperatura Máxima (AUT) (°C)&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictive_variables</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Display the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            Variable         VIF
0      Dirección del Viento (grados)    1.697671
1  Humedad Relativa Máxima (AUT) (%)  471.299209
2  Humedad Relativa Mínima (AUT) (%)  366.285572
3      Temperatura Mínima (AUT) (°C)   65.560108
4      Humedad Relativa del Aire (%)  576.593547
5   Presión Atmosférica Horaria (mB)  140.499072
6     Rajada Máxima del Viento (m/s)    7.189978
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictive_variables</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span>
    <span class="s2">&quot;Hora (UTC)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Velocidad del Viento (m/s)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Precipitación Total Horaria (mm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Mínima Anterior (AUT) (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Máxima Anterior (AUT) (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Temperatura Máxima (AUT) (°C)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Humedad Relativa del Aire (%)&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictive_variables</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Display the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            Variable         VIF
0      Dirección del Viento (grados)    1.679825
1  Humedad Relativa Máxima (AUT) (%)  304.394037
2  Humedad Relativa Mínima (AUT) (%)  248.400731
3      Temperatura Mínima (AUT) (°C)   65.410392
4   Presión Atmosférica Horaria (mB)  140.020889
5     Rajada Máxima del Viento (m/s)    7.189099
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictive_variables</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span>
    <span class="s2">&quot;Hora (UTC)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Velocidad del Viento (m/s)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Precipitación Total Horaria (mm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Mínima Anterior (AUT) (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Máxima Anterior (AUT) (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Temperatura Máxima (AUT) (°C)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Humedad Relativa del Aire (%)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Humedad Relativa Máxima (AUT) (%)&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictive_variables</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Display the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            Variable         VIF
0      Dirección del Viento (grados)    1.627305
1  Humedad Relativa Mínima (AUT) (%)   21.103437
2      Temperatura Mínima (AUT) (°C)   65.014149
3   Presión Atmosférica Horaria (mB)  131.875734
4     Rajada Máxima del Viento (m/s)    7.079493
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictive_variables</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span>
    <span class="s2">&quot;Hora (UTC)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Velocidad del Viento (m/s)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Precipitación Total Horaria (mm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Mínima Anterior (AUT) (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Máxima Anterior (AUT) (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Temperatura Máxima (AUT) (°C)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Humedad Relativa del Aire (%)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Humedad Relativa Máxima (AUT) (%)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Horaria (mB)&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictive_variables</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Display the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            Variable        VIF
0      Dirección del Viento (grados)   1.398797
1  Humedad Relativa Mínima (AUT) (%)   5.749193
2      Temperatura Mínima (AUT) (°C)  12.294688
3     Rajada Máxima del Viento (m/s)   6.996362
</pre></div>
</div>
</div>
</div>
<p>Después de eliminar variables iterativamente, se llegó a este conjunto de variables que deacuerdo al variance inflation factor no presentan un VIF mayor que 5, por lo cuál no hay multicolinealidad presente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictive_variables</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span>
    <span class="s2">&quot;Hora (UTC)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Velocidad del Viento (m/s)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Precipitación Total Horaria (mm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Mínima Anterior (AUT) (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Máxima Anterior (AUT) (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Temperatura Máxima (AUT) (°C)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Humedad Relativa del Aire (%)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Humedad Relativa Máxima (AUT) (%)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Presión Atmosférica Horaria (mB)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Temperatura Mínima (AUT) (°C)&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictive_variables</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">predictive_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Display the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            Variable       VIF
0      Dirección del Viento (grados)  1.374806
1  Humedad Relativa Mínima (AUT) (%)  3.182363
2     Rajada Máxima del Viento (m/s)  3.644319
</pre></div>
</div>
</div>
</div>
<p>PUNTO 6 (REGRESSION)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">column_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;HORA (UTC)&#39;</span><span class="p">:</span> <span class="s1">&#39;Hora (UTC)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))&#39;</span><span class="p">:</span> <span class="s1">&#39;Dirección del Viento (grados)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VENTO, VELOCIDADE HORARIA (m/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;Velocidad del Viento (m/s)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)&#39;</span><span class="p">:</span> <span class="s1">&#39;Humedad Relativa Máxima (AUT) (%)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)&#39;</span><span class="p">:</span> <span class="s1">&#39;Humedad Relativa Mínima (AUT) (%)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperatura Máxima (AUT) (°C)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperatura Mínima (AUT) (°C)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UMIDADE RELATIVA DO AR, HORARIA (%)&#39;</span><span class="p">:</span> <span class="s1">&#39;Humedad Relativa del Aire (%)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)&#39;</span><span class="p">:</span> <span class="s1">&#39;Presión Atmosférica Horaria (mB)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)&#39;</span><span class="p">:</span> <span class="s1">&#39;Precipitación Total Horaria (mm)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VENTO, RAJADA MAXIMA (m/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;Rajada Máxima del Viento (m/s)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)&#39;</span><span class="p">:</span> <span class="s1">&#39;Presión Atmosférica Máxima Anterior (AUT) (mB)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)&#39;</span><span class="p">:</span> <span class="s1">&#39;Presión Atmosférica Mínima Anterior (AUT) (mB)&#39;</span>
<span class="p">}</span>

<span class="n">wind_speed_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/hp/Downloads/data_treino_dv_df_2000_2010.csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">)</span>

<span class="n">wind_speed_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Hora (UTC)</th>
      <th>Dirección del Viento (grados)</th>
      <th>Velocidad del Viento (m/s)</th>
      <th>Humedad Relativa Máxima (AUT) (%)</th>
      <th>Humedad Relativa Mínima (AUT) (%)</th>
      <th>Temperatura Máxima (AUT) (°C)</th>
      <th>Temperatura Mínima (AUT) (°C)</th>
      <th>Humedad Relativa del Aire (%)</th>
      <th>Presión Atmosférica Horaria (mB)</th>
      <th>Precipitación Total Horaria (mm)</th>
      <th>Rajada Máxima del Viento (m/s)</th>
      <th>Presión Atmosférica Máxima Anterior (AUT) (mB)</th>
      <th>Presión Atmosférica Mínima Anterior (AUT) (mB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="p">[[</span><span class="s2">&quot;Dirección del Viento (grados)&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Humedad Relativa del Aire (%)&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Precipitación Total Horaria (mm)&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Rajada Máxima del Viento (m/s)&quot;</span><span class="p">]]</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="p">[[</span><span class="s2">&quot;Velocidad del Viento (m/s)&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>DIVISION DE LA BASE DE DATOS EN ENTRENAMIENTO Y VALIDACION.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># aqui range indica el numero de folds que se va a crear,</span>
<span class="c1"># se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
<span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

    <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
    
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
    <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
    
    <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">fold</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X_train shape:&quot;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y_train shape:&quot;</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X_test shape:&quot;</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y_test shape:&quot;</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration 1:
X_train shape: (24, 4)
y_train shape: (24, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 2:
X_train shape: (48, 4)
y_train shape: (48, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 3:
X_train shape: (72, 4)
y_train shape: (72, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 4:
X_train shape: (96, 4)
y_train shape: (96, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 5:
X_train shape: (120, 4)
y_train shape: (120, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 6:
X_train shape: (144, 4)
y_train shape: (144, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 7:
X_train shape: (168, 4)
y_train shape: (168, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 8:
X_train shape: (192, 4)
y_train shape: (192, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 9:
X_train shape: (216, 4)
y_train shape: (216, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 10:
X_train shape: (240, 4)
y_train shape: (240, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
</pre></div>
</div>
</div>
</div>
<p>COMPARACION DE MODELOS</p>
<p>KNN</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neighbors_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># grilla de parametros a probar en knn regressor</span>
<span class="n">neighbors_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>

<span class="c1"># aqui range indica el numero de folds que se va a crear, se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="k">for</span> <span class="n">n_neighbors</span> <span class="ow">in</span> <span class="n">neighbors_grid</span><span class="p">:</span>
    
    <span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
    <span class="c1"># lista para guardar las metricas en cada fold</span>
    <span class="n">rmse_in_fold</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
        
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># entrenamiento del modelo</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">n_neighbors</span><span class="p">)</span>
        <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># calculando RMSE</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>      
        <span class="n">rmse_in_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
    <span class="n">rmse_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_in_fold</span><span class="p">)</span>
    
    <span class="k">if</span><span class="p">(</span><span class="n">rmse_mean</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">):</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">n_neighbors</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">rmse_mean</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Número óptimo de vecinos: </span><span class="si">{</span><span class="n">best_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor RMSE: </span><span class="si">{</span><span class="n">lowest_rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número óptimo de vecinos: 20
Mejor RMSE: 0.8228921248988412
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">best_params</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7899717535076868
</pre></div>
</div>
</div>
</div>
<p>Con base en los resultados, se puede concluir:</p>
<p>El RMSE más bajo fué 0.8228 con 20 vecinos.</p>
<p>El R CUADRADO fué de 0.789, lo cuál indica que proximadamente el 78.99% de la variabilidad en la variable dependiente se puede explicar mediante las variables independientes.</p>
<p>Ridge Regression</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>

<span class="c1"># grilla de parametros a probar en Ridge</span>
<span class="n">alpha_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>

<span class="c1"># aqui range indica el numero de folds que se va a crear, se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alpha_grid</span><span class="p">:</span>
    
    <span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
    <span class="c1"># lista para guardar las metricas en cada fold</span>
    <span class="n">rmse_in_fold</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
        
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># entrenamiento del modelo</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># calculando RMSE</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">rmse_in_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
    <span class="n">rmse_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_in_fold</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">rmse_mean</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">:</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">rmse_mean</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parámetro de regularización óptimo: </span><span class="si">{</span><span class="n">best_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor RMSE: </span><span class="si">{</span><span class="n">lowest_rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parámetro de regularización óptimo: 100
Mejor RMSE: 0.8568079989572535
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">best_params</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7736647361714808
</pre></div>
</div>
</div>
</div>
<p>Nótese que en este caso, el mejor parámetro de regularización es 100, con un RMSE de 0.85 y un r cuadrado
de 0.77.</p>
<p>Lasso Regression</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span>

<span class="c1"># grilla de parametros a probar en Lasso</span>
<span class="n">alpha_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>

<span class="c1"># aqui range indica el numero de folds que se va a crear, se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alpha_grid</span><span class="p">:</span>
    
    <span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
    <span class="c1"># lista para guardar las metricas en cada fold</span>
    <span class="n">rmse_in_fold</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
        
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># entrenamiento del modelo</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># calculando RMSE</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">rmse_in_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
    <span class="n">rmse_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_in_fold</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">rmse_mean</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">:</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">rmse_mean</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parámetro de regularización óptimo: </span><span class="si">{</span><span class="n">best_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor RMSE: </span><span class="si">{</span><span class="n">lowest_rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parámetro de regularización óptimo: 0.1
Mejor RMSE: 0.8576640106793569
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">best_params</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7551466718568816
</pre></div>
</div>
</div>
</div>
<p>En este caso, el mejor parámetro de regularización es 0.1, con un RMSE de 0.857 y
el r cuadrado de 0.755.</p>
<p>XG Boost</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>

<span class="c1"># grilla de parametros a probar en XGBoost</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># aqui range indica el numero de folds que se va a crear, se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="c1"># Se crea una lista de diccionarios representando todas las posibles combinaciones</span>
<span class="n">param_combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">param_grid</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">param_combinations</span><span class="p">:</span>
    <span class="c1"># Desempaquetando los parámetros</span>
    <span class="n">n_estimators</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="n">params</span>
    
    <span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
    <span class="c1"># lista para guardar las metricas en cada fold</span>
    <span class="n">rmse_in_fold</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
        
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># entrenamiento del modelo</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span>
            <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
            <span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span>
            <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span>
        <span class="p">)</span>
        <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># calculando RMSE</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">rmse_in_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
    <span class="n">rmse_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_in_fold</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">rmse_mean</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">:</span>
        <span class="n">optim_n_estimators</span><span class="p">,</span> <span class="n">optim_learning_rate</span><span class="p">,</span> <span class="n">optim_max_depth</span> <span class="o">=</span> <span class="n">params</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">rmse_mean</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parámetros mas optimos:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Número de árboles: </span><span class="si">{</span><span class="n">optim_n_estimators</span><span class="si">}</span><span class="s2"> , learning_rate </span><span class="si">{</span><span class="n">optim_learning_rate</span><span class="si">}</span><span class="s2"> , max_depth </span><span class="si">{</span><span class="n">optim_max_depth</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor RMSE: </span><span class="si">{</span><span class="n">lowest_rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parámetros mas optimos:
Número de árboles: 50 , learning_rate 0.1 , max_depth 3
Mejor RMSE: 0.856827578604703
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span>
            <span class="n">n_estimators</span><span class="o">=</span><span class="n">optim_n_estimators</span><span class="p">,</span>
            <span class="n">learning_rate</span><span class="o">=</span><span class="n">optim_learning_rate</span><span class="p">,</span>
            <span class="n">max_depth</span><span class="o">=</span><span class="n">optim_max_depth</span>
        <span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7962835744986132
</pre></div>
</div>
</div>
</div>
<p>El mejor modelo resulta de tener 50 árboles, con un learning rate de 0.1 y una profundidad máxima de 3 nodos. Para un RMSE de 0.856 y un r cuadrado de 0.796.</p>
<p>SVM</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svr_grid</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;rbf&#39;</span><span class="p">],</span>
               <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
               <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
               <span class="s1">&#39;epsilon&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]},</span>
              
              <span class="p">{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">],</span>
               <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
               <span class="s1">&#39;epsilon&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}]</span>
</pre></div>
</div>
</div>
</div>
<p>En este caso se es consciente que no tienen ningún sentido utilizar el parámetro gamma cuando el kernel es ‘linear’.
Sin embargo no se diseña el grid tal como el que se acaba de mostrar, porque se tuvo un problema en el desempaquetado de las variables al momento de diseñar los loops, por lo cuál se procede a resolver este tema con un condicional.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>

<span class="c1"># grilla de parametros a probar en SVM</span>
<span class="n">svr_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">],</span>
            <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s1">&#39;epsilon&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="p">}</span>

<span class="c1"># aqui range indica el numero de folds que se va a crear, se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="c1"># Se crea una lista de diccionarios representando todas las posibles combinaciones</span>
<span class="n">param_combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">svr_grid</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">param_combinations</span><span class="p">:</span>
    <span class="c1"># Desempaquetando los parámetros</span>
    <span class="n">kernel</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="n">params</span>
    
    <span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
    <span class="c1"># lista para guardar las metricas en cada fold</span>
    <span class="n">rmse_in_fold</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
        
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># entrenamiento del modelo</span>
        <span class="k">if</span><span class="p">(</span><span class="n">kernel</span> <span class="o">==</span> <span class="s1">&#39;rbf&#39;</span><span class="p">):</span>
            <span class="n">reg</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span>
                <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span>
                <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span>
                <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span>
                <span class="n">epsilon</span><span class="o">=</span><span class="n">epsilon</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">reg</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span>
                <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span>
                <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span>
                <span class="n">epsilon</span><span class="o">=</span><span class="n">epsilon</span>
            <span class="p">)</span>
            
        <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># calculando RMSE</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">rmse_in_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
    <span class="n">rmse_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_in_fold</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">rmse_mean</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">:</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">rmse_mean</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parámetros mas optimos:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor RMSE: </span><span class="si">{</span><span class="n">lowest_rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parámetros mas optimos:
(&#39;rbf&#39;, 0.1, 0.1, 0.1)
Mejor RMSE: 0.8153139388461801
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">C</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">gamma</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">epsilon</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7927637862454311
</pre></div>
</div>
</div>
</div>
<p>Con lo cuál el mejor modelo resulta de tener un kernel gaussiano, con un término de regularización, valor de gamma y valor de épsilon de 0.1. Para un RMSE de 0.8153 y un r cuadrado de 0.7927.</p>
<p>MLP</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="c1"># grilla de parametros a probar en SVM</span>
<span class="n">mlp_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;neurons_layer_1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
            <span class="s1">&#39;neurons_layer_2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
            <span class="p">}</span>

<span class="c1"># aqui range indica el numero de folds que se va a crear, se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="n">n_cols</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Se crea una lista de diccionarios representando todas las posibles combinaciones</span>
<span class="n">param_combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">mlp_grid</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">param_combinations</span><span class="p">:</span>
    <span class="c1"># Desempaquetando los parámetros</span>
    <span class="n">neurons_layer_1</span><span class="p">,</span> <span class="n">neurons_layer_2</span> <span class="o">=</span> <span class="n">params</span>
    
    <span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
    <span class="c1"># lista para guardar las metricas en cada fold</span>
    <span class="n">rmse_in_fold</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
        
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># Set up the model: model</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>

        <span class="c1"># Add the first layer</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">neurons_layer_1</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_cols</span><span class="p">,)))</span>

        <span class="c1"># Add the second layer</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">neurons_layer_2</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))</span>

        <span class="c1"># Add the output layer</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

        <span class="c1"># Compile the model</span>
        <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>

        <span class="c1"># Fit the model</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># calculando RMSE</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">rmse_in_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
    <span class="n">rmse_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_in_fold</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">rmse_mean</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">:</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">rmse_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - 1s 1s/step - loss: 2.8551
1/1 [==============================] - 0s 144ms/step
2/2 [==============================] - 1s 16ms/step - loss: 3.4280
1/1 [==============================] - 0s 171ms/step
3/3 [==============================] - 2s 752us/step - loss: 4.3609
1/1 [==============================] - 0s 84ms/step
3/3 [==============================] - 1s 0s/step - loss: 2.8108
1/1 [==============================] - 0s 252ms/step
WARNING:tensorflow:5 out of the last 10 calls to &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x000002CC21F08040&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
4/4 [==============================] - 1s 7ms/step - loss: 6.0412
WARNING:tensorflow:5 out of the last 5 calls to &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x000002CCA12958B0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
1/1 [==============================] - 0s 122ms/step
5/5 [==============================] - 1s 4ms/step - loss: 5.8353
WARNING:tensorflow:6 out of the last 6 calls to &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x000002CCA2912820&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
1/1 [==============================] - 0s 86ms/step
6/6 [==============================] - 1s 6ms/step - loss: 6.7159
1/1 [==============================] - 0s 153ms/step
6/6 [==============================] - 1s 3ms/step - loss: 5.0891
1/1 [==============================] - 0s 65ms/step
7/7 [==============================] - 1s 3ms/step - loss: 7.6428
1/1 [==============================] - 0s 62ms/step
8/8 [==============================] - 1s 4ms/step - loss: 11.9890
1/1 [==============================] - 0s 160ms/step
9/9 [==============================] - 1s 5ms/step - loss: 5.8886
1/1 [==============================] - 0s 62ms/step
9/9 [==============================] - 1s 4ms/step - loss: 5.3832
1/1 [==============================] - 0s 70ms/step
10/10 [==============================] - 1s 4ms/step - loss: 6.1587
1/1 [==============================] - 0s 71ms/step
11/11 [==============================] - 1s 5ms/step - loss: 6.3973
1/1 [==============================] - 0s 54ms/step
12/12 [==============================] - 1s 3ms/step - loss: 5.1652
1/1 [==============================] - 0s 74ms/step
12/12 [==============================] - 1s 4ms/step - loss: 6.7325
1/1 [==============================] - 0s 73ms/step
13/13 [==============================] - 1s 4ms/step - loss: 7.8977
1/1 [==============================] - 0s 54ms/step
14/14 [==============================] - 1s 5ms/step - loss: 5.1399
1/1 [==============================] - 0s 81ms/step
15/15 [==============================] - 2s 5ms/step - loss: 6.1830
1/1 [==============================] - 0s 72ms/step
15/15 [==============================] - 1s 5ms/step - loss: 5.8121
1/1 [==============================] - 0s 85ms/step
16/16 [==============================] - 1s 4ms/step - loss: 5.7884
1/1 [==============================] - 0s 69ms/step
17/17 [==============================] - 1s 4ms/step - loss: 7.8750
1/1 [==============================] - 0s 71ms/step
18/18 [==============================] - 1s 4ms/step - loss: 4.9186
1/1 [==============================] - 0s 75ms/step
18/18 [==============================] - 1s 4ms/step - loss: 5.0996
1/1 [==============================] - 0s 76ms/step
19/19 [==============================] - 1s 4ms/step - loss: 6.0459
1/1 [==============================] - 0s 53ms/step
20/20 [==============================] - 1s 4ms/step - loss: 7.2680
1/1 [==============================] - 0s 81ms/step
21/21 [==============================] - 1s 4ms/step - loss: 4.2198
1/1 [==============================] - 0s 57ms/step
21/21 [==============================] - 1s 4ms/step - loss: 6.6954
1/1 [==============================] - 0s 62ms/step
22/22 [==============================] - 1s 4ms/step - loss: 6.5051
1/1 [==============================] - 0s 46ms/step
23/23 [==============================] - 1s 5ms/step - loss: 6.9342
1/1 [==============================] - 0s 73ms/step
24/24 [==============================] - 1s 5ms/step - loss: 6.7126
1/1 [==============================] - 0s 71ms/step
24/24 [==============================] - 1s 4ms/step - loss: 8.2726
1/1 [==============================] - 0s 86ms/step
25/25 [==============================] - 1s 5ms/step - loss: 7.3252
1/1 [==============================] - 0s 67ms/step
26/26 [==============================] - 1s 4ms/step - loss: 6.6127
1/1 [==============================] - 0s 60ms/step
27/27 [==============================] - 1s 4ms/step - loss: 6.7171
1/1 [==============================] - 0s 55ms/step
27/27 [==============================] - 1s 4ms/step - loss: 8.7253
1/1 [==============================] - 0s 61ms/step
28/28 [==============================] - 1s 4ms/step - loss: 5.6893
1/1 [==============================] - 0s 56ms/step
29/29 [==============================] - 1s 4ms/step - loss: 5.9112
1/1 [==============================] - 0s 71ms/step
30/30 [==============================] - 1s 4ms/step - loss: 5.8652
1/1 [==============================] - 0s 56ms/step
30/30 [==============================] - 1s 4ms/step - loss: 9.0780
1/1 [==============================] - 0s 78ms/step
31/31 [==============================] - 1s 3ms/step - loss: 3.5163
1/1 [==============================] - 0s 83ms/step
32/32 [==============================] - 1s 4ms/step - loss: 7.7493
1/1 [==============================] - 0s 159ms/step
33/33 [==============================] - 1s 4ms/step - loss: 6.8581
1/1 [==============================] - 0s 64ms/step
33/33 [==============================] - 1s 4ms/step - loss: 9.4104
1/1 [==============================] - 0s 72ms/step
34/34 [==============================] - 1s 4ms/step - loss: 8.8627
1/1 [==============================] - 0s 63ms/step
35/35 [==============================] - 1s 3ms/step - loss: 5.5345
1/1 [==============================] - 0s 72ms/step
36/36 [==============================] - 2s 7ms/step - loss: 3.5739
1/1 [==============================] - 0s 127ms/step
36/36 [==============================] - 1s 4ms/step - loss: 4.2491
1/1 [==============================] - 0s 92ms/step
37/37 [==============================] - 1s 4ms/step - loss: 4.6819
1/1 [==============================] - 0s 75ms/step
38/38 [==============================] - 1s 3ms/step - loss: 7.1148
1/1 [==============================] - 0s 67ms/step
1/1 [==============================] - 1s 771ms/step - loss: 3.1461
1/1 [==============================] - 0s 74ms/step
2/2 [==============================] - 1s 0s/step - loss: 4.2815
1/1 [==============================] - 0s 78ms/step
3/3 [==============================] - 1s 0s/step - loss: 4.5474
1/1 [==============================] - 0s 62ms/step
WARNING:tensorflow:5 out of the last 45 calls to &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x000002CD4281A5E0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
3/3 [==============================] - 1s 8ms/step - loss: 4.0823
1/1 [==============================] - 0s 63ms/step
4/4 [==============================] - 1s 0s/step - loss: 5.2811
1/1 [==============================] - 0s 50ms/step
5/5 [==============================] - 1s 0s/step - loss: 5.8471
1/1 [==============================] - 0s 56ms/step
6/6 [==============================] - 1s 4ms/step - loss: 7.4439
1/1 [==============================] - 0s 63ms/step
6/6 [==============================] - 1s 5ms/step - loss: 7.9010
1/1 [==============================] - 0s 70ms/step
7/7 [==============================] - 1s 1ms/step - loss: 6.3893
1/1 [==============================] - 0s 61ms/step
8/8 [==============================] - 1s 6ms/step - loss: 4.6637
1/1 [==============================] - 0s 66ms/step
9/9 [==============================] - 1s 4ms/step - loss: 7.1944
1/1 [==============================] - 0s 65ms/step
9/9 [==============================] - 1s 4ms/step - loss: 4.1954
1/1 [==============================] - 0s 81ms/step
10/10 [==============================] - 1s 5ms/step - loss: 4.5772
1/1 [==============================] - 0s 62ms/step
11/11 [==============================] - 1s 4ms/step - loss: 5.2923
1/1 [==============================] - 0s 70ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.6127
1/1 [==============================] - 0s 117ms/step
12/12 [==============================] - 1s 5ms/step - loss: 9.2329
1/1 [==============================] - 0s 64ms/step
13/13 [==============================] - 1s 5ms/step - loss: 9.8179
1/1 [==============================] - 0s 62ms/step
14/14 [==============================] - 1s 4ms/step - loss: 5.3576
1/1 [==============================] - 0s 78ms/step
15/15 [==============================] - 1s 4ms/step - loss: 4.8419
1/1 [==============================] - 0s 62ms/step
15/15 [==============================] - 1s 3ms/step - loss: 5.1673
1/1 [==============================] - 0s 67ms/step
16/16 [==============================] - 1s 4ms/step - loss: 6.3781
1/1 [==============================] - 0s 56ms/step
17/17 [==============================] - 1s 4ms/step - loss: 5.1682
1/1 [==============================] - 0s 50ms/step
18/18 [==============================] - 1s 5ms/step - loss: 7.4782
1/1 [==============================] - 0s 72ms/step
18/18 [==============================] - 1s 4ms/step - loss: 6.0712
1/1 [==============================] - 0s 57ms/step
19/19 [==============================] - 1s 4ms/step - loss: 3.6883
1/1 [==============================] - 0s 66ms/step
20/20 [==============================] - 1s 4ms/step - loss: 4.4542
1/1 [==============================] - 0s 46ms/step
21/21 [==============================] - 1s 3ms/step - loss: 7.7365
1/1 [==============================] - 0s 47ms/step
21/21 [==============================] - 1s 4ms/step - loss: 7.7057
1/1 [==============================] - 0s 56ms/step
22/22 [==============================] - 1s 5ms/step - loss: 5.2705
1/1 [==============================] - 0s 72ms/step
23/23 [==============================] - 1s 4ms/step - loss: 7.2740
1/1 [==============================] - 0s 54ms/step
24/24 [==============================] - 1s 5ms/step - loss: 7.1343
1/1 [==============================] - 0s 65ms/step
24/24 [==============================] - 1s 5ms/step - loss: 6.5628
1/1 [==============================] - 0s 83ms/step
25/25 [==============================] - 1s 4ms/step - loss: 7.1400
1/1 [==============================] - 0s 66ms/step
26/26 [==============================] - 1s 4ms/step - loss: 6.3857
1/1 [==============================] - 0s 56ms/step
27/27 [==============================] - 2s 4ms/step - loss: 6.7708
1/1 [==============================] - 0s 71ms/step
27/27 [==============================] - 1s 3ms/step - loss: 5.6352
1/1 [==============================] - 0s 59ms/step
28/28 [==============================] - 1s 4ms/step - loss: 5.9697
1/1 [==============================] - 0s 73ms/step
29/29 [==============================] - 1s 4ms/step - loss: 8.6498
1/1 [==============================] - 0s 62ms/step
30/30 [==============================] - 1s 4ms/step - loss: 4.3312
1/1 [==============================] - 0s 58ms/step
30/30 [==============================] - 1s 4ms/step - loss: 7.8079
1/1 [==============================] - 0s 57ms/step
31/31 [==============================] - 1s 5ms/step - loss: 7.2308
1/1 [==============================] - 0s 84ms/step
32/32 [==============================] - 1s 4ms/step - loss: 6.6019
1/1 [==============================] - 0s 68ms/step
33/33 [==============================] - 1s 4ms/step - loss: 5.3080
1/1 [==============================] - 0s 65ms/step
33/33 [==============================] - 1s 4ms/step - loss: 6.3987
1/1 [==============================] - 0s 61ms/step
34/34 [==============================] - 1s 4ms/step - loss: 6.6436
1/1 [==============================] - 0s 88ms/step
35/35 [==============================] - 1s 4ms/step - loss: 5.7421
1/1 [==============================] - 0s 69ms/step
36/36 [==============================] - 1s 4ms/step - loss: 6.4678
1/1 [==============================] - 0s 60ms/step
36/36 [==============================] - 1s 3ms/step - loss: 6.9991
1/1 [==============================] - 0s 58ms/step
37/37 [==============================] - 1s 3ms/step - loss: 6.7621
1/1 [==============================] - 0s 74ms/step
38/38 [==============================] - 1s 4ms/step - loss: 8.1129
1/1 [==============================] - 0s 79ms/step
1/1 [==============================] - 1s 748ms/step - loss: 1.9900
1/1 [==============================] - 0s 71ms/step
2/2 [==============================] - 1s 15ms/step - loss: 2.2654
1/1 [==============================] - 0s 70ms/step
3/3 [==============================] - 1s 8ms/step - loss: 1.8104
1/1 [==============================] - 0s 70ms/step
3/3 [==============================] - 1s 0s/step - loss: 4.9108
1/1 [==============================] - 0s 78ms/step
4/4 [==============================] - 1s 0s/step - loss: 3.1504
1/1 [==============================] - 0s 62ms/step
5/5 [==============================] - 1s 4ms/step - loss: 4.5597
1/1 [==============================] - 0s 60ms/step
6/6 [==============================] - 1s 6ms/step - loss: 6.7038
1/1 [==============================] - 0s 68ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.4825
1/1 [==============================] - 0s 69ms/step
7/7 [==============================] - 1s 4ms/step - loss: 5.1971
1/1 [==============================] - 0s 68ms/step
8/8 [==============================] - 1s 5ms/step - loss: 7.0638
1/1 [==============================] - 0s 56ms/step
9/9 [==============================] - 1s 5ms/step - loss: 6.4414
1/1 [==============================] - 0s 96ms/step
9/9 [==============================] - 1s 4ms/step - loss: 3.5083
1/1 [==============================] - 0s 68ms/step
10/10 [==============================] - 1s 4ms/step - loss: 6.2225
1/1 [==============================] - 0s 85ms/step
11/11 [==============================] - 2s 4ms/step - loss: 7.5067
1/1 [==============================] - 0s 68ms/step
12/12 [==============================] - 1s 4ms/step - loss: 7.0577
1/1 [==============================] - 0s 64ms/step
12/12 [==============================] - 1s 4ms/step - loss: 7.1009
1/1 [==============================] - 0s 81ms/step
13/13 [==============================] - 1s 3ms/step - loss: 6.5475
1/1 [==============================] - 0s 61ms/step
14/14 [==============================] - 1s 4ms/step - loss: 8.1272
1/1 [==============================] - 0s 66ms/step
15/15 [==============================] - 1s 3ms/step - loss: 5.7315
1/1 [==============================] - 0s 57ms/step
15/15 [==============================] - 1s 4ms/step - loss: 6.6000
1/1 [==============================] - 0s 53ms/step
16/16 [==============================] - 1s 3ms/step - loss: 5.2691
1/1 [==============================] - 0s 74ms/step
17/17 [==============================] - 1s 5ms/step - loss: 4.8850
1/1 [==============================] - 0s 53ms/step
18/18 [==============================] - 2s 5ms/step - loss: 7.3935
1/1 [==============================] - 0s 72ms/step
18/18 [==============================] - 1s 8ms/step - loss: 4.9977
1/1 [==============================] - 0s 66ms/step
19/19 [==============================] - 2s 5ms/step - loss: 4.9792
1/1 [==============================] - 0s 104ms/step
20/20 [==============================] - 1s 4ms/step - loss: 5.4072
1/1 [==============================] - 0s 166ms/step
21/21 [==============================] - 1s 6ms/step - loss: 5.6825
1/1 [==============================] - 0s 127ms/step
21/21 [==============================] - 1s 4ms/step - loss: 5.4777
1/1 [==============================] - 0s 77ms/step
22/22 [==============================] - 1s 4ms/step - loss: 6.2949
1/1 [==============================] - 0s 61ms/step
23/23 [==============================] - 1s 5ms/step - loss: 5.4608
1/1 [==============================] - 0s 73ms/step
24/24 [==============================] - 1s 5ms/step - loss: 7.5794
1/1 [==============================] - 0s 82ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.6368
1/1 [==============================] - 0s 86ms/step
25/25 [==============================] - 1s 5ms/step - loss: 6.0414
1/1 [==============================] - 0s 72ms/step
26/26 [==============================] - 1s 3ms/step - loss: 4.0011
1/1 [==============================] - 0s 70ms/step
27/27 [==============================] - 1s 4ms/step - loss: 2.7970
1/1 [==============================] - 0s 71ms/step
27/27 [==============================] - 1s 4ms/step - loss: 7.0540
1/1 [==============================] - 0s 66ms/step
28/28 [==============================] - 1s 5ms/step - loss: 5.3286
1/1 [==============================] - 0s 63ms/step
29/29 [==============================] - 1s 4ms/step - loss: 5.2917
1/1 [==============================] - 0s 57ms/step
30/30 [==============================] - 1s 4ms/step - loss: 8.9789
1/1 [==============================] - 0s 71ms/step
30/30 [==============================] - 1s 4ms/step - loss: 7.8463
1/1 [==============================] - 0s 98ms/step
31/31 [==============================] - 1s 6ms/step - loss: 5.4625
1/1 [==============================] - 0s 127ms/step
32/32 [==============================] - 1s 5ms/step - loss: 6.1398
1/1 [==============================] - 0s 106ms/step
33/33 [==============================] - 1s 4ms/step - loss: 5.8477
1/1 [==============================] - 0s 62ms/step
33/33 [==============================] - 1s 4ms/step - loss: 6.0549
1/1 [==============================] - 0s 71ms/step
34/34 [==============================] - 1s 4ms/step - loss: 6.2436
1/1 [==============================] - 0s 77ms/step
35/35 [==============================] - 1s 4ms/step - loss: 6.4894
1/1 [==============================] - 0s 62ms/step
36/36 [==============================] - 1s 4ms/step - loss: 5.9686
1/1 [==============================] - 0s 72ms/step
36/36 [==============================] - 4s 4ms/step - loss: 6.4350
1/1 [==============================] - 0s 84ms/step
37/37 [==============================] - 1s 5ms/step - loss: 7.6237
1/1 [==============================] - 0s 102ms/step
38/38 [==============================] - 1s 6ms/step - loss: 4.4706
1/1 [==============================] - 0s 70ms/step
1/1 [==============================] - 1s 780ms/step - loss: 2.2689
1/1 [==============================] - 0s 63ms/step
2/2 [==============================] - 1s 0s/step - loss: 3.4775
1/1 [==============================] - 0s 88ms/step
3/3 [==============================] - 1s 5ms/step - loss: 3.4630
1/1 [==============================] - 0s 69ms/step
3/3 [==============================] - 1s 8ms/step - loss: 4.0381
1/1 [==============================] - 0s 65ms/step
4/4 [==============================] - 1s 8ms/step - loss: 4.9504
1/1 [==============================] - 0s 52ms/step
5/5 [==============================] - 1s 5ms/step - loss: 5.6583
1/1 [==============================] - 0s 90ms/step
6/6 [==============================] - 1s 3ms/step - loss: 7.5816
1/1 [==============================] - 0s 83ms/step
6/6 [==============================] - 1s 4ms/step - loss: 5.9773
1/1 [==============================] - 0s 70ms/step
7/7 [==============================] - 1s 5ms/step - loss: 6.8916
1/1 [==============================] - 0s 66ms/step
8/8 [==============================] - 1s 5ms/step - loss: 6.8623
1/1 [==============================] - 0s 95ms/step
9/9 [==============================] - 1s 9ms/step - loss: 5.7593
1/1 [==============================] - 0s 78ms/step
9/9 [==============================] - 1s 4ms/step - loss: 5.5968
1/1 [==============================] - 0s 70ms/step
10/10 [==============================] - 1s 11ms/step - loss: 5.5804
1/1 [==============================] - 0s 73ms/step
11/11 [==============================] - 1s 7ms/step - loss: 5.5943
1/1 [==============================] - 0s 94ms/step
12/12 [==============================] - 1s 4ms/step - loss: 4.6815
1/1 [==============================] - 0s 90ms/step
12/12 [==============================] - 1s 4ms/step - loss: 5.6365
1/1 [==============================] - 0s 64ms/step
13/13 [==============================] - 1s 4ms/step - loss: 8.4257
1/1 [==============================] - 0s 101ms/step
14/14 [==============================] - 1s 5ms/step - loss: 5.6005
1/1 [==============================] - 0s 70ms/step
15/15 [==============================] - 1s 8ms/step - loss: 6.3802
1/1 [==============================] - 0s 140ms/step
15/15 [==============================] - 1s 5ms/step - loss: 4.8228
1/1 [==============================] - 0s 102ms/step
16/16 [==============================] - 1s 4ms/step - loss: 4.4901
1/1 [==============================] - 0s 94ms/step
17/17 [==============================] - 1s 4ms/step - loss: 4.6238
1/1 [==============================] - 0s 76ms/step
18/18 [==============================] - 1s 4ms/step - loss: 3.9479
1/1 [==============================] - 0s 67ms/step
18/18 [==============================] - 1s 5ms/step - loss: 5.2267
1/1 [==============================] - 0s 62ms/step
19/19 [==============================] - 1s 4ms/step - loss: 4.7855
1/1 [==============================] - 0s 77ms/step
20/20 [==============================] - 1s 4ms/step - loss: 6.3392
1/1 [==============================] - 0s 56ms/step
21/21 [==============================] - 1s 4ms/step - loss: 6.0454
1/1 [==============================] - 0s 64ms/step
21/21 [==============================] - 1s 4ms/step - loss: 5.3729
1/1 [==============================] - 0s 54ms/step
22/22 [==============================] - 1s 7ms/step - loss: 4.7743
1/1 [==============================] - 0s 224ms/step
23/23 [==============================] - 1s 4ms/step - loss: 5.2594
1/1 [==============================] - 0s 82ms/step
24/24 [==============================] - 1s 4ms/step - loss: 5.4815
1/1 [==============================] - 0s 89ms/step
24/24 [==============================] - 1s 5ms/step - loss: 6.9730
1/1 [==============================] - 0s 124ms/step
25/25 [==============================] - 1s 5ms/step - loss: 5.5164
1/1 [==============================] - 0s 60ms/step
26/26 [==============================] - 1s 4ms/step - loss: 6.3098
1/1 [==============================] - 0s 79ms/step
27/27 [==============================] - 1s 4ms/step - loss: 6.8558
1/1 [==============================] - 0s 83ms/step
27/27 [==============================] - 1s 4ms/step - loss: 7.9539
1/1 [==============================] - 0s 79ms/step
28/28 [==============================] - 6s 6ms/step - loss: 5.9575
1/1 [==============================] - 0s 93ms/step
29/29 [==============================] - 1s 4ms/step - loss: 7.6570
1/1 [==============================] - 0s 62ms/step
30/30 [==============================] - 1s 4ms/step - loss: 4.2375
1/1 [==============================] - 0s 91ms/step
30/30 [==============================] - 1s 5ms/step - loss: 4.5480
1/1 [==============================] - 0s 78ms/step
31/31 [==============================] - 1s 5ms/step - loss: 6.8194
1/1 [==============================] - 0s 74ms/step
32/32 [==============================] - 1s 4ms/step - loss: 6.0512
1/1 [==============================] - 0s 74ms/step
33/33 [==============================] - 1s 4ms/step - loss: 6.2994
1/1 [==============================] - 0s 79ms/step
33/33 [==============================] - 1s 4ms/step - loss: 5.5723
1/1 [==============================] - 0s 90ms/step
34/34 [==============================] - 1s 4ms/step - loss: 6.7224
1/1 [==============================] - 0s 67ms/step
35/35 [==============================] - 1s 4ms/step - loss: 5.0344
1/1 [==============================] - 0s 79ms/step
36/36 [==============================] - 1s 4ms/step - loss: 6.4235
1/1 [==============================] - 0s 77ms/step
36/36 [==============================] - 1s 4ms/step - loss: 6.0722
1/1 [==============================] - 0s 65ms/step
37/37 [==============================] - 1s 4ms/step - loss: 5.8340
1/1 [==============================] - 0s 78ms/step
38/38 [==============================] - 1s 3ms/step - loss: 4.7510
1/1 [==============================] - 0s 80ms/step
1/1 [==============================] - 1s 853ms/step - loss: 2.4476
1/1 [==============================] - 0s 80ms/step
2/2 [==============================] - 1s 15ms/step - loss: 3.3199
1/1 [==============================] - 0s 69ms/step
3/3 [==============================] - 1s 9ms/step - loss: 3.7293
1/1 [==============================] - 0s 72ms/step
3/3 [==============================] - 1s 0s/step - loss: 6.6779
1/1 [==============================] - 0s 85ms/step
4/4 [==============================] - 1s 0s/step - loss: 6.5740
1/1 [==============================] - 0s 79ms/step
5/5 [==============================] - 1s 4ms/step - loss: 5.1524
1/1 [==============================] - 0s 65ms/step
6/6 [==============================] - 1s 4ms/step - loss: 6.8201
1/1 [==============================] - 0s 84ms/step
6/6 [==============================] - 1s 3ms/step - loss: 4.4139
1/1 [==============================] - 0s 63ms/step
7/7 [==============================] - 1s 5ms/step - loss: 7.4928
1/1 [==============================] - 0s 76ms/step
8/8 [==============================] - 1s 6ms/step - loss: 6.1994
1/1 [==============================] - 0s 77ms/step
9/9 [==============================] - 1s 5ms/step - loss: 7.9522
1/1 [==============================] - 0s 99ms/step
9/9 [==============================] - 1s 6ms/step - loss: 4.9494
1/1 [==============================] - 0s 96ms/step
10/10 [==============================] - 1s 6ms/step - loss: 4.9892
1/1 [==============================] - 0s 141ms/step
11/11 [==============================] - 1s 3ms/step - loss: 4.8619
1/1 [==============================] - 0s 109ms/step
12/12 [==============================] - 1s 3ms/step - loss: 7.3795
1/1 [==============================] - 0s 77ms/step
12/12 [==============================] - 1s 3ms/step - loss: 3.5374
1/1 [==============================] - 0s 76ms/step
13/13 [==============================] - 1s 5ms/step - loss: 6.0328
1/1 [==============================] - 0s 89ms/step
14/14 [==============================] - 1s 4ms/step - loss: 3.2689
1/1 [==============================] - 0s 64ms/step
15/15 [==============================] - 1s 4ms/step - loss: 7.7914
1/1 [==============================] - 0s 70ms/step
15/15 [==============================] - 1s 5ms/step - loss: 4.0015
1/1 [==============================] - 0s 77ms/step
16/16 [==============================] - 1s 5ms/step - loss: 6.6950
1/1 [==============================] - 0s 64ms/step
17/17 [==============================] - 1s 3ms/step - loss: 4.3912
1/1 [==============================] - 0s 65ms/step
18/18 [==============================] - 1s 4ms/step - loss: 5.2124
1/1 [==============================] - 0s 112ms/step
18/18 [==============================] - 1s 5ms/step - loss: 3.6663
1/1 [==============================] - 0s 96ms/step
19/19 [==============================] - 1s 4ms/step - loss: 7.3166
1/1 [==============================] - 0s 71ms/step
20/20 [==============================] - 1s 4ms/step - loss: 6.8328
1/1 [==============================] - 0s 73ms/step
21/21 [==============================] - 1s 3ms/step - loss: 6.2700
1/1 [==============================] - 0s 61ms/step
21/21 [==============================] - 1s 4ms/step - loss: 4.1825
1/1 [==============================] - 0s 61ms/step
22/22 [==============================] - 1s 5ms/step - loss: 7.3121
1/1 [==============================] - 0s 80ms/step
23/23 [==============================] - 1s 4ms/step - loss: 7.8821
1/1 [==============================] - 0s 70ms/step
24/24 [==============================] - 1s 6ms/step - loss: 6.6339
1/1 [==============================] - 0s 64ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.3957
1/1 [==============================] - 0s 96ms/step
25/25 [==============================] - 1s 6ms/step - loss: 7.4096
1/1 [==============================] - 0s 78ms/step
26/26 [==============================] - 1s 4ms/step - loss: 6.3326
1/1 [==============================] - 0s 62ms/step
27/27 [==============================] - 1s 4ms/step - loss: 8.9644
1/1 [==============================] - 0s 89ms/step
27/27 [==============================] - 1s 4ms/step - loss: 3.7168
1/1 [==============================] - 0s 65ms/step
28/28 [==============================] - 1s 6ms/step - loss: 8.5694
1/1 [==============================] - 0s 89ms/step
29/29 [==============================] - 1s 4ms/step - loss: 5.4752
1/1 [==============================] - 0s 83ms/step
30/30 [==============================] - 1s 4ms/step - loss: 4.4378
1/1 [==============================] - 0s 71ms/step
30/30 [==============================] - 1s 4ms/step - loss: 6.9910
1/1 [==============================] - 0s 94ms/step
31/31 [==============================] - 1s 4ms/step - loss: 3.9407
1/1 [==============================] - 0s 57ms/step
32/32 [==============================] - 1s 4ms/step - loss: 7.0905
1/1 [==============================] - 0s 73ms/step
33/33 [==============================] - 1s 4ms/step - loss: 5.4756
1/1 [==============================] - 0s 94ms/step
33/33 [==============================] - 1s 3ms/step - loss: 7.5692
1/1 [==============================] - 0s 63ms/step
34/34 [==============================] - 1s 4ms/step - loss: 6.4843
1/1 [==============================] - 0s 66ms/step
35/35 [==============================] - 1s 3ms/step - loss: 7.0445
1/1 [==============================] - 0s 70ms/step
36/36 [==============================] - 1s 4ms/step - loss: 5.1828
1/1 [==============================] - 0s 74ms/step
36/36 [==============================] - 1s 3ms/step - loss: 6.5802
1/1 [==============================] - 0s 95ms/step
37/37 [==============================] - 1s 4ms/step - loss: 7.1567
1/1 [==============================] - 0s 76ms/step
38/38 [==============================] - 1s 5ms/step - loss: 7.4571
1/1 [==============================] - 0s 79ms/step
1/1 [==============================] - 1s 911ms/step - loss: 1.7043
1/1 [==============================] - 0s 133ms/step
2/2 [==============================] - 1s 22ms/step - loss: 3.1360
1/1 [==============================] - 0s 104ms/step
3/3 [==============================] - 1s 8ms/step - loss: 4.9147
1/1 [==============================] - 0s 152ms/step
3/3 [==============================] - 1s 7ms/step - loss: 5.8970
1/1 [==============================] - 0s 75ms/step
4/4 [==============================] - 1s 4ms/step - loss: 4.6271
1/1 [==============================] - 0s 98ms/step
5/5 [==============================] - 1s 4ms/step - loss: 5.5281
1/1 [==============================] - 0s 78ms/step
6/6 [==============================] - 1s 1ms/step - loss: 7.4432
1/1 [==============================] - 0s 63ms/step
6/6 [==============================] - 1s 5ms/step - loss: 4.8968
1/1 [==============================] - 0s 63ms/step
7/7 [==============================] - 1s 3ms/step - loss: 6.8113
1/1 [==============================] - 0s 95ms/step
8/8 [==============================] - 1s 5ms/step - loss: 5.2123
1/1 [==============================] - 0s 81ms/step
9/9 [==============================] - 1s 5ms/step - loss: 5.5051
1/1 [==============================] - 0s 63ms/step
9/9 [==============================] - 1s 5ms/step - loss: 6.5113
1/1 [==============================] - 0s 89ms/step
10/10 [==============================] - 1s 6ms/step - loss: 7.5737
1/1 [==============================] - 0s 90ms/step
11/11 [==============================] - 1s 4ms/step - loss: 4.0035
1/1 [==============================] - 0s 72ms/step
12/12 [==============================] - 1s 3ms/step - loss: 5.6891
1/1 [==============================] - 0s 74ms/step
12/12 [==============================] - 1s 3ms/step - loss: 7.2574
1/1 [==============================] - 0s 81ms/step
13/13 [==============================] - 1s 5ms/step - loss: 6.5755
1/1 [==============================] - 0s 92ms/step
14/14 [==============================] - 1s 3ms/step - loss: 3.6480
1/1 [==============================] - 0s 90ms/step
15/15 [==============================] - 1s 4ms/step - loss: 7.3552
1/1 [==============================] - 0s 72ms/step
15/15 [==============================] - 1s 3ms/step - loss: 5.2932
1/1 [==============================] - 0s 72ms/step
16/16 [==============================] - 1s 3ms/step - loss: 5.8682
1/1 [==============================] - 0s 75ms/step
17/17 [==============================] - 1s 5ms/step - loss: 7.4066
1/1 [==============================] - 0s 75ms/step
18/18 [==============================] - 1s 7ms/step - loss: 5.7524
1/1 [==============================] - 0s 126ms/step
18/18 [==============================] - 1s 4ms/step - loss: 7.6534
1/1 [==============================] - 0s 86ms/step
19/19 [==============================] - 1s 5ms/step - loss: 4.2028
1/1 [==============================] - 0s 80ms/step
20/20 [==============================] - 1s 5ms/step - loss: 6.1712
1/1 [==============================] - 0s 116ms/step
21/21 [==============================] - 1s 4ms/step - loss: 4.4348
1/1 [==============================] - 0s 81ms/step
21/21 [==============================] - 1s 4ms/step - loss: 5.8045
1/1 [==============================] - 0s 73ms/step
22/22 [==============================] - 1s 4ms/step - loss: 6.3260
1/1 [==============================] - 0s 80ms/step
23/23 [==============================] - 1s 4ms/step - loss: 6.5288
1/1 [==============================] - 0s 92ms/step
24/24 [==============================] - 1s 5ms/step - loss: 7.0058
1/1 [==============================] - 0s 58ms/step
24/24 [==============================] - 1s 4ms/step - loss: 4.3434
1/1 [==============================] - 0s 75ms/step
25/25 [==============================] - 1s 4ms/step - loss: 6.8760
1/1 [==============================] - 0s 93ms/step
26/26 [==============================] - 1s 4ms/step - loss: 10.9126
1/1 [==============================] - 0s 95ms/step
27/27 [==============================] - 12s 7ms/step - loss: 6.1358
1/1 [==============================] - 0s 238ms/step
27/27 [==============================] - 2s 4ms/step - loss: 6.8268
1/1 [==============================] - 0s 319ms/step
28/28 [==============================] - 2s 6ms/step - loss: 6.4914
1/1 [==============================] - 0s 237ms/step
29/29 [==============================] - 2s 5ms/step - loss: 4.6770
1/1 [==============================] - 0s 101ms/step
30/30 [==============================] - 1s 4ms/step - loss: 5.8045
1/1 [==============================] - 0s 100ms/step
30/30 [==============================] - 1s 4ms/step - loss: 6.4788
1/1 [==============================] - 0s 63ms/step
31/31 [==============================] - 2s 5ms/step - loss: 6.2095
1/1 [==============================] - 0s 126ms/step
32/32 [==============================] - 1s 5ms/step - loss: 4.9217
1/1 [==============================] - 0s 77ms/step
33/33 [==============================] - 1s 4ms/step - loss: 6.0358
1/1 [==============================] - 0s 62ms/step
33/33 [==============================] - 1s 3ms/step - loss: 7.2603
1/1 [==============================] - 0s 66ms/step
34/34 [==============================] - 1s 4ms/step - loss: 6.2599
1/1 [==============================] - 0s 61ms/step
35/35 [==============================] - 1s 4ms/step - loss: 8.4310
1/1 [==============================] - 0s 143ms/step
36/36 [==============================] - 1s 3ms/step - loss: 5.5138
1/1 [==============================] - 0s 82ms/step
36/36 [==============================] - 1s 4ms/step - loss: 3.5339
1/1 [==============================] - 0s 64ms/step
37/37 [==============================] - 1s 4ms/step - loss: 7.4774
1/1 [==============================] - 0s 82ms/step
38/38 [==============================] - 1s 5ms/step - loss: 4.9471
1/1 [==============================] - 0s 64ms/step
1/1 [==============================] - 1s 835ms/step - loss: 2.6830
1/1 [==============================] - 0s 102ms/step
2/2 [==============================] - 1s 0s/step - loss: 3.0489
1/1 [==============================] - 0s 70ms/step
3/3 [==============================] - 1s 11ms/step - loss: 3.9960
1/1 [==============================] - 0s 58ms/step
3/3 [==============================] - 1s 8ms/step - loss: 3.2817
1/1 [==============================] - 0s 72ms/step
4/4 [==============================] - 1s 8ms/step - loss: 5.2120
1/1 [==============================] - 0s 73ms/step
5/5 [==============================] - 1s 4ms/step - loss: 8.3185
1/1 [==============================] - 0s 86ms/step
6/6 [==============================] - 1s 6ms/step - loss: 6.5609
1/1 [==============================] - 0s 62ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.2824
1/1 [==============================] - 0s 117ms/step
7/7 [==============================] - 1s 3ms/step - loss: 6.9963
1/1 [==============================] - 0s 71ms/step
8/8 [==============================] - 1s 5ms/step - loss: 10.4382
1/1 [==============================] - 0s 67ms/step
9/9 [==============================] - 1s 2ms/step - loss: 6.5750
1/1 [==============================] - 0s 71ms/step
9/9 [==============================] - 1s 4ms/step - loss: 6.5004
1/1 [==============================] - 0s 55ms/step
10/10 [==============================] - 1s 3ms/step - loss: 4.2106
1/1 [==============================] - 0s 78ms/step
11/11 [==============================] - 1s 4ms/step - loss: 9.6806
1/1 [==============================] - 0s 61ms/step
12/12 [==============================] - 1s 5ms/step - loss: 5.9781
1/1 [==============================] - 0s 61ms/step
12/12 [==============================] - 1s 3ms/step - loss: 10.7978
1/1 [==============================] - 0s 61ms/step
13/13 [==============================] - 1s 5ms/step - loss: 6.8166
1/1 [==============================] - 0s 67ms/step
14/14 [==============================] - 1s 4ms/step - loss: 4.8005
1/1 [==============================] - 0s 51ms/step
15/15 [==============================] - 1s 5ms/step - loss: 4.7369
1/1 [==============================] - 0s 66ms/step
15/15 [==============================] - 1s 3ms/step - loss: 6.5488
1/1 [==============================] - 0s 78ms/step
16/16 [==============================] - 1s 4ms/step - loss: 5.5306
1/1 [==============================] - 0s 74ms/step
17/17 [==============================] - 1s 4ms/step - loss: 6.0149
1/1 [==============================] - 0s 76ms/step
18/18 [==============================] - 1s 3ms/step - loss: 4.9319
1/1 [==============================] - 0s 151ms/step
18/18 [==============================] - 1s 5ms/step - loss: 5.2230
1/1 [==============================] - 0s 52ms/step
19/19 [==============================] - 1s 4ms/step - loss: 5.9266
1/1 [==============================] - 0s 52ms/step
20/20 [==============================] - 1s 5ms/step - loss: 6.7335
1/1 [==============================] - 0s 73ms/step
21/21 [==============================] - 1s 4ms/step - loss: 5.9600
1/1 [==============================] - 0s 75ms/step
21/21 [==============================] - 1s 5ms/step - loss: 5.6837
1/1 [==============================] - 0s 67ms/step
22/22 [==============================] - 1s 5ms/step - loss: 6.7233
1/1 [==============================] - 0s 52ms/step
23/23 [==============================] - 1s 4ms/step - loss: 6.5193
1/1 [==============================] - 0s 60ms/step
24/24 [==============================] - 1s 4ms/step - loss: 6.1151
1/1 [==============================] - 0s 78ms/step
24/24 [==============================] - 1s 5ms/step - loss: 4.9109
1/1 [==============================] - 0s 61ms/step
25/25 [==============================] - 1s 4ms/step - loss: 6.0885
1/1 [==============================] - 0s 65ms/step
26/26 [==============================] - 1s 4ms/step - loss: 6.9753
1/1 [==============================] - 0s 82ms/step
27/27 [==============================] - 1s 4ms/step - loss: 4.6488
1/1 [==============================] - 0s 63ms/step
27/27 [==============================] - 1s 4ms/step - loss: 6.3178
1/1 [==============================] - 0s 78ms/step
28/28 [==============================] - 1s 4ms/step - loss: 6.6565
1/1 [==============================] - 0s 77ms/step
29/29 [==============================] - 1s 4ms/step - loss: 4.5251
1/1 [==============================] - 0s 73ms/step
30/30 [==============================] - 1s 4ms/step - loss: 5.4575
1/1 [==============================] - 0s 85ms/step
30/30 [==============================] - 1s 4ms/step - loss: 7.4242
1/1 [==============================] - 0s 65ms/step
31/31 [==============================] - 1s 4ms/step - loss: 5.3019
1/1 [==============================] - 0s 67ms/step
32/32 [==============================] - 1s 4ms/step - loss: 6.1590
1/1 [==============================] - 0s 74ms/step
33/33 [==============================] - 1s 5ms/step - loss: 6.5983
1/1 [==============================] - 0s 100ms/step
33/33 [==============================] - 1s 4ms/step - loss: 7.3896
1/1 [==============================] - 0s 73ms/step
34/34 [==============================] - 1s 4ms/step - loss: 4.2493
1/1 [==============================] - 0s 67ms/step
35/35 [==============================] - 53s 13ms/step - loss: 8.3381
1/1 [==============================] - 0s 198ms/step
36/36 [==============================] - 2s 4ms/step - loss: 4.9534
1/1 [==============================] - 0s 95ms/step
36/36 [==============================] - 1s 4ms/step - loss: 6.7263
1/1 [==============================] - 0s 90ms/step
37/37 [==============================] - 1s 4ms/step - loss: 4.5483
1/1 [==============================] - 0s 92ms/step
38/38 [==============================] - 1s 4ms/step - loss: 6.4406
1/1 [==============================] - 0s 94ms/step
1/1 [==============================] - 1s 965ms/step - loss: 1.9600
1/1 [==============================] - 0s 111ms/step
2/2 [==============================] - 1s 0s/step - loss: 3.6464
1/1 [==============================] - 0s 99ms/step
3/3 [==============================] - 1s 5ms/step - loss: 3.4605
1/1 [==============================] - 0s 168ms/step
3/3 [==============================] - 1s 0s/step - loss: 3.6341
1/1 [==============================] - 0s 134ms/step
4/4 [==============================] - 1s 9ms/step - loss: 4.4735
1/1 [==============================] - 0s 187ms/step
5/5 [==============================] - 1s 5ms/step - loss: 6.6743
1/1 [==============================] - 0s 91ms/step
6/6 [==============================] - 1s 4ms/step - loss: 6.2942
1/1 [==============================] - 0s 73ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.5225
1/1 [==============================] - 0s 61ms/step
7/7 [==============================] - 1s 4ms/step - loss: 5.7216
1/1 [==============================] - 0s 88ms/step
8/8 [==============================] - 1s 4ms/step - loss: 5.9376
1/1 [==============================] - 0s 107ms/step
9/9 [==============================] - 1s 8ms/step - loss: 4.9170
1/1 [==============================] - 0s 60ms/step
9/9 [==============================] - 1s 4ms/step - loss: 5.6475
1/1 [==============================] - 0s 79ms/step
10/10 [==============================] - 1s 2ms/step - loss: 7.4387
1/1 [==============================] - 0s 78ms/step
11/11 [==============================] - 1s 6ms/step - loss: 6.4273
1/1 [==============================] - 0s 69ms/step
12/12 [==============================] - 1s 6ms/step - loss: 6.4238
1/1 [==============================] - 0s 76ms/step
12/12 [==============================] - 1s 10ms/step - loss: 7.4751
1/1 [==============================] - 0s 67ms/step
13/13 [==============================] - 1s 8ms/step - loss: 5.3599
1/1 [==============================] - 0s 76ms/step
14/14 [==============================] - 1s 4ms/step - loss: 5.9858
1/1 [==============================] - 0s 127ms/step
15/15 [==============================] - 1s 5ms/step - loss: 4.9659
1/1 [==============================] - 0s 128ms/step
15/15 [==============================] - 1s 3ms/step - loss: 5.1271
1/1 [==============================] - 0s 170ms/step
16/16 [==============================] - 1s 4ms/step - loss: 6.5653
1/1 [==============================] - 0s 114ms/step
17/17 [==============================] - 1s 5ms/step - loss: 5.6116
1/1 [==============================] - 0s 66ms/step
18/18 [==============================] - 1s 3ms/step - loss: 6.2013
1/1 [==============================] - 0s 70ms/step
18/18 [==============================] - 1s 4ms/step - loss: 4.5920
1/1 [==============================] - 0s 58ms/step
19/19 [==============================] - 1s 5ms/step - loss: 4.8787
1/1 [==============================] - 0s 86ms/step
20/20 [==============================] - 1s 7ms/step - loss: 5.3708
1/1 [==============================] - 0s 92ms/step
21/21 [==============================] - 1s 4ms/step - loss: 8.4348
1/1 [==============================] - 0s 144ms/step
21/21 [==============================] - 1s 4ms/step - loss: 5.6825
1/1 [==============================] - 0s 63ms/step
22/22 [==============================] - 1s 4ms/step - loss: 7.6851
1/1 [==============================] - 0s 63ms/step
23/23 [==============================] - 1s 4ms/step - loss: 5.8658
1/1 [==============================] - 0s 144ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.7721
1/1 [==============================] - 0s 70ms/step
24/24 [==============================] - 1s 5ms/step - loss: 5.2723
1/1 [==============================] - 0s 96ms/step
25/25 [==============================] - 1s 3ms/step - loss: 6.5891
1/1 [==============================] - 0s 83ms/step
26/26 [==============================] - 1s 4ms/step - loss: 6.3538
1/1 [==============================] - 0s 95ms/step
27/27 [==============================] - 1s 5ms/step - loss: 4.5111
1/1 [==============================] - 0s 66ms/step
27/27 [==============================] - 1s 3ms/step - loss: 5.9412
1/1 [==============================] - 0s 76ms/step
28/28 [==============================] - 1s 3ms/step - loss: 6.0892
1/1 [==============================] - 0s 84ms/step
29/29 [==============================] - 1s 4ms/step - loss: 5.1963
1/1 [==============================] - 0s 79ms/step
30/30 [==============================] - 1s 3ms/step - loss: 5.5366
1/1 [==============================] - 0s 101ms/step
30/30 [==============================] - 1s 4ms/step - loss: 5.9407
1/1 [==============================] - 0s 103ms/step
31/31 [==============================] - 1s 3ms/step - loss: 4.8451
1/1 [==============================] - 0s 63ms/step
32/32 [==============================] - 1s 3ms/step - loss: 5.8407
1/1 [==============================] - 0s 76ms/step
33/33 [==============================] - 1s 4ms/step - loss: 6.9820
1/1 [==============================] - 0s 59ms/step
33/33 [==============================] - 1s 3ms/step - loss: 4.2769
1/1 [==============================] - 0s 96ms/step
34/34 [==============================] - 1s 5ms/step - loss: 4.3085
1/1 [==============================] - 0s 190ms/step
35/35 [==============================] - 1s 4ms/step - loss: 5.7776
1/1 [==============================] - 0s 65ms/step
36/36 [==============================] - 1s 6ms/step - loss: 7.1128
1/1 [==============================] - 0s 86ms/step
36/36 [==============================] - 1s 7ms/step - loss: 5.3668
1/1 [==============================] - 0s 82ms/step
37/37 [==============================] - 1s 5ms/step - loss: 6.1670
1/1 [==============================] - 0s 73ms/step
38/38 [==============================] - 1s 4ms/step - loss: 5.5674
1/1 [==============================] - 0s 74ms/step
1/1 [==============================] - 1s 898ms/step - loss: 5.4646
1/1 [==============================] - 0s 177ms/step
2/2 [==============================] - 1s 11ms/step - loss: 3.4543
1/1 [==============================] - 0s 66ms/step
3/3 [==============================] - 1s 12ms/step - loss: 4.2606
1/1 [==============================] - 0s 173ms/step
3/3 [==============================] - 1s 0s/step - loss: 2.3449
1/1 [==============================] - 0s 78ms/step
4/4 [==============================] - 1s 5ms/step - loss: 6.6056
1/1 [==============================] - 0s 92ms/step
5/5 [==============================] - 1s 4ms/step - loss: 7.1310
1/1 [==============================] - 0s 107ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.6359
1/1 [==============================] - 0s 116ms/step
6/6 [==============================] - 1s 3ms/step - loss: 5.9806
1/1 [==============================] - 0s 151ms/step
7/7 [==============================] - 1s 5ms/step - loss: 6.3926
1/1 [==============================] - 0s 113ms/step
8/8 [==============================] - 1s 2ms/step - loss: 5.7971
1/1 [==============================] - 0s 86ms/step
9/9 [==============================] - 1s 11ms/step - loss: 4.3336
1/1 [==============================] - 0s 89ms/step
9/9 [==============================] - 1s 4ms/step - loss: 6.5168
1/1 [==============================] - 0s 136ms/step
10/10 [==============================] - 1s 5ms/step - loss: 5.3024
1/1 [==============================] - 0s 69ms/step
11/11 [==============================] - 1s 3ms/step - loss: 6.6162
1/1 [==============================] - 0s 102ms/step
12/12 [==============================] - 1s 4ms/step - loss: 6.5106
1/1 [==============================] - 0s 73ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.0617
1/1 [==============================] - 0s 80ms/step
13/13 [==============================] - 30s 8ms/step - loss: 4.9249
1/1 [==============================] - 0s 157ms/step
14/14 [==============================] - 2s 6ms/step - loss: 7.1512
1/1 [==============================] - 0s 237ms/step
15/15 [==============================] - 1s 5ms/step - loss: 4.6833
1/1 [==============================] - 0s 162ms/step
15/15 [==============================] - 1s 5ms/step - loss: 7.8911
1/1 [==============================] - 0s 117ms/step
16/16 [==============================] - 2s 9ms/step - loss: 7.6381
1/1 [==============================] - 0s 126ms/step
17/17 [==============================] - 1s 6ms/step - loss: 5.1811
1/1 [==============================] - 0s 111ms/step
18/18 [==============================] - 2s 7ms/step - loss: 2.3729
1/1 [==============================] - 0s 244ms/step
18/18 [==============================] - 2s 4ms/step - loss: 6.3414
1/1 [==============================] - 0s 70ms/step
19/19 [==============================] - 2s 7ms/step - loss: 7.6675
1/1 [==============================] - 0s 108ms/step
20/20 [==============================] - 1s 4ms/step - loss: 5.9722
1/1 [==============================] - 0s 89ms/step
21/21 [==============================] - 1s 5ms/step - loss: 6.5497
1/1 [==============================] - 0s 76ms/step
21/21 [==============================] - 1s 6ms/step - loss: 3.9744
1/1 [==============================] - 0s 101ms/step
22/22 [==============================] - 2s 5ms/step - loss: 5.4528
1/1 [==============================] - 0s 86ms/step
23/23 [==============================] - 1s 5ms/step - loss: 7.7681
1/1 [==============================] - 0s 114ms/step
24/24 [==============================] - 1s 6ms/step - loss: 8.3101
1/1 [==============================] - 0s 88ms/step
24/24 [==============================] - 1s 4ms/step - loss: 6.4366
1/1 [==============================] - 0s 79ms/step
25/25 [==============================] - 1s 3ms/step - loss: 3.9508
1/1 [==============================] - 0s 120ms/step
26/26 [==============================] - 2s 8ms/step - loss: 6.1514
1/1 [==============================] - 0s 119ms/step
27/27 [==============================] - 1s 4ms/step - loss: 5.0932
1/1 [==============================] - 0s 103ms/step
27/27 [==============================] - 1s 4ms/step - loss: 7.4466
1/1 [==============================] - 0s 97ms/step
28/28 [==============================] - 1s 5ms/step - loss: 5.7103
1/1 [==============================] - 0s 133ms/step
29/29 [==============================] - 1s 4ms/step - loss: 7.1684
1/1 [==============================] - 0s 82ms/step
30/30 [==============================] - 1s 4ms/step - loss: 6.7780
1/1 [==============================] - 0s 87ms/step
30/30 [==============================] - 1s 6ms/step - loss: 7.0202
1/1 [==============================] - 0s 80ms/step
31/31 [==============================] - 1s 4ms/step - loss: 5.8359
1/1 [==============================] - 0s 94ms/step
32/32 [==============================] - 1s 6ms/step - loss: 3.9138
1/1 [==============================] - 0s 102ms/step
33/33 [==============================] - 1s 7ms/step - loss: 6.1151
1/1 [==============================] - 0s 88ms/step
33/33 [==============================] - 1s 4ms/step - loss: 5.0890
1/1 [==============================] - 0s 78ms/step
34/34 [==============================] - 2s 5ms/step - loss: 6.9522
1/1 [==============================] - 0s 76ms/step
35/35 [==============================] - 1s 5ms/step - loss: 6.6676
1/1 [==============================] - 0s 73ms/step
36/36 [==============================] - 1s 4ms/step - loss: 5.2075
1/1 [==============================] - 0s 105ms/step
36/36 [==============================] - 2s 7ms/step - loss: 4.8601
1/1 [==============================] - 0s 111ms/step
37/37 [==============================] - 1s 5ms/step - loss: 7.8561
1/1 [==============================] - 0s 80ms/step
38/38 [==============================] - 1s 5ms/step - loss: 4.2627
1/1 [==============================] - 0s 82ms/step
1/1 [==============================] - 1s 1s/step - loss: 2.5096
1/1 [==============================] - 0s 118ms/step
2/2 [==============================] - 1s 0s/step - loss: 4.5648
1/1 [==============================] - 0s 116ms/step
3/3 [==============================] - 1s 7ms/step - loss: 8.5472
1/1 [==============================] - 0s 87ms/step
3/3 [==============================] - 1s 8ms/step - loss: 4.8848
1/1 [==============================] - 0s 123ms/step
4/4 [==============================] - 1s 7ms/step - loss: 4.8106
1/1 [==============================] - 0s 100ms/step
5/5 [==============================] - 2s 12ms/step - loss: 6.2806
1/1 [==============================] - 0s 233ms/step
6/6 [==============================] - 2s 6ms/step - loss: 5.8815
1/1 [==============================] - 0s 114ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.0346
1/1 [==============================] - 0s 102ms/step
7/7 [==============================] - 1s 6ms/step - loss: 6.6591
1/1 [==============================] - 0s 87ms/step
8/8 [==============================] - 1s 2ms/step - loss: 6.6146
1/1 [==============================] - 0s 102ms/step
9/9 [==============================] - 1s 4ms/step - loss: 7.0928
1/1 [==============================] - 0s 84ms/step
9/9 [==============================] - 1s 9ms/step - loss: 5.7022
1/1 [==============================] - 0s 104ms/step
10/10 [==============================] - 1s 4ms/step - loss: 5.0124
1/1 [==============================] - 0s 130ms/step
11/11 [==============================] - 1s 4ms/step - loss: 9.7482
1/1 [==============================] - 0s 100ms/step
12/12 [==============================] - 1s 4ms/step - loss: 6.7747
1/1 [==============================] - 0s 105ms/step
12/12 [==============================] - 1s 6ms/step - loss: 5.7941
1/1 [==============================] - 0s 115ms/step
13/13 [==============================] - 1s 8ms/step - loss: 6.1657
1/1 [==============================] - 0s 123ms/step
14/14 [==============================] - 1s 4ms/step - loss: 6.7641
1/1 [==============================] - 0s 131ms/step
15/15 [==============================] - 1s 4ms/step - loss: 5.4292
1/1 [==============================] - 0s 96ms/step
15/15 [==============================] - 2s 5ms/step - loss: 5.4891
1/1 [==============================] - 0s 146ms/step
16/16 [==============================] - 2s 6ms/step - loss: 4.2875
1/1 [==============================] - 0s 136ms/step
17/17 [==============================] - 2s 5ms/step - loss: 4.8841
1/1 [==============================] - 0s 120ms/step
18/18 [==============================] - 1s 5ms/step - loss: 3.5598
1/1 [==============================] - 0s 119ms/step
18/18 [==============================] - 2s 5ms/step - loss: 5.0160
1/1 [==============================] - 0s 102ms/step
19/19 [==============================] - 2s 5ms/step - loss: 5.2686
1/1 [==============================] - 0s 129ms/step
20/20 [==============================] - 2s 5ms/step - loss: 2.2527
1/1 [==============================] - 0s 110ms/step
21/21 [==============================] - 2s 5ms/step - loss: 6.0404
1/1 [==============================] - 0s 74ms/step
21/21 [==============================] - 1s 7ms/step - loss: 10.2320
1/1 [==============================] - 0s 91ms/step
22/22 [==============================] - 1s 6ms/step - loss: 6.7301
1/1 [==============================] - 0s 82ms/step
23/23 [==============================] - 1s 5ms/step - loss: 6.7053
1/1 [==============================] - 0s 87ms/step
24/24 [==============================] - 1s 5ms/step - loss: 6.4234
1/1 [==============================] - 0s 93ms/step
24/24 [==============================] - 1s 4ms/step - loss: 7.5753
1/1 [==============================] - 0s 108ms/step
25/25 [==============================] - 2s 4ms/step - loss: 6.7065
1/1 [==============================] - 0s 86ms/step
26/26 [==============================] - 1s 5ms/step - loss: 5.2672
1/1 [==============================] - 0s 94ms/step
27/27 [==============================] - 2s 5ms/step - loss: 4.5172
1/1 [==============================] - 0s 118ms/step
27/27 [==============================] - 1s 7ms/step - loss: 6.8541
1/1 [==============================] - 0s 87ms/step
28/28 [==============================] - 1s 4ms/step - loss: 7.4813
1/1 [==============================] - 0s 97ms/step
29/29 [==============================] - 1s 4ms/step - loss: 5.8993
1/1 [==============================] - 0s 88ms/step
30/30 [==============================] - 1s 5ms/step - loss: 6.2127
1/1 [==============================] - 0s 80ms/step
30/30 [==============================] - 1s 5ms/step - loss: 5.9244
1/1 [==============================] - 0s 151ms/step
31/31 [==============================] - 1s 6ms/step - loss: 6.8752
1/1 [==============================] - 0s 93ms/step
32/32 [==============================] - 1s 4ms/step - loss: 6.4995
1/1 [==============================] - 0s 102ms/step
33/33 [==============================] - 1s 4ms/step - loss: 6.7626
1/1 [==============================] - 0s 82ms/step
33/33 [==============================] - 1s 4ms/step - loss: 4.6947
1/1 [==============================] - 0s 84ms/step
34/34 [==============================] - 2s 5ms/step - loss: 5.6542
1/1 [==============================] - 0s 87ms/step
35/35 [==============================] - 2s 4ms/step - loss: 4.2318
1/1 [==============================] - 0s 101ms/step
36/36 [==============================] - 1s 4ms/step - loss: 6.3393
1/1 [==============================] - 0s 90ms/step
36/36 [==============================] - 1s 5ms/step - loss: 4.1079
1/1 [==============================] - 0s 80ms/step
37/37 [==============================] - 2s 5ms/step - loss: 6.1508
1/1 [==============================] - 0s 119ms/step
38/38 [==============================] - 38s 9ms/step - loss: 7.3229
1/1 [==============================] - 0s 252ms/step
1/1 [==============================] - 1s 1s/step - loss: 4.2789
1/1 [==============================] - 0s 115ms/step
2/2 [==============================] - 2s 0s/step - loss: 4.4654
1/1 [==============================] - 0s 90ms/step
3/3 [==============================] - 2s 10ms/step - loss: 3.2255
1/1 [==============================] - 0s 83ms/step
3/3 [==============================] - 1s 3ms/step - loss: 3.7830
1/1 [==============================] - 0s 65ms/step
4/4 [==============================] - 2s 5ms/step - loss: 6.2311
1/1 [==============================] - 0s 98ms/step
5/5 [==============================] - 1s 1ms/step - loss: 6.6394
1/1 [==============================] - 0s 75ms/step
6/6 [==============================] - 1s 6ms/step - loss: 6.5445
1/1 [==============================] - 0s 131ms/step
6/6 [==============================] - 2s 5ms/step - loss: 7.1697
1/1 [==============================] - 0s 126ms/step
7/7 [==============================] - 1s 5ms/step - loss: 5.8840
1/1 [==============================] - 0s 155ms/step
8/8 [==============================] - 1s 2ms/step - loss: 6.7593
1/1 [==============================] - 0s 88ms/step
9/9 [==============================] - 1s 8ms/step - loss: 6.0566
1/1 [==============================] - 0s 86ms/step
9/9 [==============================] - 1s 4ms/step - loss: 7.0264
1/1 [==============================] - 0s 106ms/step
10/10 [==============================] - 1s 5ms/step - loss: 6.2073
1/1 [==============================] - 0s 76ms/step
11/11 [==============================] - 1s 4ms/step - loss: 6.6339
1/1 [==============================] - 0s 75ms/step
12/12 [==============================] - 1s 4ms/step - loss: 7.0518
1/1 [==============================] - 0s 82ms/step
12/12 [==============================] - 1s 4ms/step - loss: 7.8098
1/1 [==============================] - 0s 105ms/step
13/13 [==============================] - 1s 5ms/step - loss: 7.0331
1/1 [==============================] - 0s 101ms/step
14/14 [==============================] - 1s 3ms/step - loss: 7.0433
1/1 [==============================] - 0s 112ms/step
15/15 [==============================] - 1s 3ms/step - loss: 6.0592
1/1 [==============================] - 0s 153ms/step
15/15 [==============================] - 1s 3ms/step - loss: 6.5970
1/1 [==============================] - 0s 74ms/step
16/16 [==============================] - 1s 5ms/step - loss: 5.1976
1/1 [==============================] - 0s 113ms/step
17/17 [==============================] - 1s 4ms/step - loss: 3.8755
1/1 [==============================] - 0s 94ms/step
18/18 [==============================] - 2s 8ms/step - loss: 5.6224
1/1 [==============================] - 0s 75ms/step
18/18 [==============================] - 2s 6ms/step - loss: 6.8518
1/1 [==============================] - 0s 93ms/step
19/19 [==============================] - 1s 3ms/step - loss: 3.5197
1/1 [==============================] - 0s 87ms/step
20/20 [==============================] - 1s 4ms/step - loss: 5.2155
1/1 [==============================] - 0s 164ms/step
21/21 [==============================] - 1s 5ms/step - loss: 6.0612
1/1 [==============================] - 0s 144ms/step
21/21 [==============================] - 1s 4ms/step - loss: 6.1871
1/1 [==============================] - 0s 93ms/step
22/22 [==============================] - 1s 4ms/step - loss: 7.6540
1/1 [==============================] - 0s 108ms/step
23/23 [==============================] - 2s 8ms/step - loss: 4.7921
1/1 [==============================] - 0s 99ms/step
24/24 [==============================] - 1s 5ms/step - loss: 5.4762
1/1 [==============================] - 0s 81ms/step
24/24 [==============================] - 1s 4ms/step - loss: 6.0000
1/1 [==============================] - 0s 133ms/step
25/25 [==============================] - 1s 3ms/step - loss: 5.7678
1/1 [==============================] - 0s 79ms/step
26/26 [==============================] - 1s 5ms/step - loss: 6.7152
1/1 [==============================] - 0s 106ms/step
27/27 [==============================] - 1s 4ms/step - loss: 4.8854
1/1 [==============================] - 0s 96ms/step
27/27 [==============================] - 1s 5ms/step - loss: 5.7483
1/1 [==============================] - 0s 120ms/step
28/28 [==============================] - 1s 4ms/step - loss: 6.3644
1/1 [==============================] - 0s 151ms/step
29/29 [==============================] - 1s 4ms/step - loss: 6.0039
1/1 [==============================] - 0s 146ms/step
30/30 [==============================] - 1s 4ms/step - loss: 6.6594
1/1 [==============================] - 0s 145ms/step
30/30 [==============================] - 1s 3ms/step - loss: 6.5099
1/1 [==============================] - 0s 72ms/step
31/31 [==============================] - 1s 4ms/step - loss: 6.9458
1/1 [==============================] - 0s 69ms/step
32/32 [==============================] - 1s 5ms/step - loss: 6.5025
1/1 [==============================] - 0s 177ms/step
33/33 [==============================] - 1s 4ms/step - loss: 4.6471
1/1 [==============================] - 0s 90ms/step
33/33 [==============================] - 1s 4ms/step - loss: 6.3390
1/1 [==============================] - 0s 93ms/step
34/34 [==============================] - 1s 3ms/step - loss: 5.0300
1/1 [==============================] - 0s 89ms/step
35/35 [==============================] - 1s 3ms/step - loss: 4.3713
1/1 [==============================] - 0s 62ms/step
36/36 [==============================] - 1s 5ms/step - loss: 4.0548
1/1 [==============================] - 0s 171ms/step
36/36 [==============================] - 1s 3ms/step - loss: 4.3735
1/1 [==============================] - 0s 88ms/step
37/37 [==============================] - 1s 4ms/step - loss: 5.6448
1/1 [==============================] - 0s 130ms/step
38/38 [==============================] - 1s 3ms/step - loss: 6.4332
1/1 [==============================] - 0s 86ms/step
1/1 [==============================] - 1s 1s/step - loss: 3.0476
1/1 [==============================] - 0s 86ms/step
2/2 [==============================] - 1s 10ms/step - loss: 3.8251
1/1 [==============================] - 0s 117ms/step
3/3 [==============================] - 1s 0s/step - loss: 3.3943
1/1 [==============================] - 0s 89ms/step
3/3 [==============================] - 1s 8ms/step - loss: 4.7942
1/1 [==============================] - 0s 99ms/step
4/4 [==============================] - 1s 6ms/step - loss: 5.4100
1/1 [==============================] - 0s 101ms/step
5/5 [==============================] - 2s 4ms/step - loss: 4.2360
1/1 [==============================] - 0s 77ms/step
6/6 [==============================] - 1s 5ms/step - loss: 6.5242
1/1 [==============================] - 0s 103ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.6848
1/1 [==============================] - 0s 169ms/step
7/7 [==============================] - 1s 5ms/step - loss: 5.1131
1/1 [==============================] - 0s 91ms/step
8/8 [==============================] - 1s 7ms/step - loss: 5.5301
1/1 [==============================] - 0s 89ms/step
9/9 [==============================] - 1s 8ms/step - loss: 5.9003
1/1 [==============================] - 0s 156ms/step
9/9 [==============================] - 1s 8ms/step - loss: 5.5806
1/1 [==============================] - 0s 83ms/step
10/10 [==============================] - 1s 3ms/step - loss: 4.9103
1/1 [==============================] - 0s 90ms/step
11/11 [==============================] - 1s 4ms/step - loss: 5.7163
1/1 [==============================] - 0s 99ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.6659
1/1 [==============================] - 0s 87ms/step
12/12 [==============================] - 1s 3ms/step - loss: 8.1888
1/1 [==============================] - 0s 108ms/step
13/13 [==============================] - 1s 6ms/step - loss: 5.5107
1/1 [==============================] - 0s 100ms/step
14/14 [==============================] - 2s 5ms/step - loss: 4.1988
1/1 [==============================] - 0s 82ms/step
15/15 [==============================] - 2s 5ms/step - loss: 5.5309
1/1 [==============================] - 0s 95ms/step
15/15 [==============================] - 1s 4ms/step - loss: 5.5490
1/1 [==============================] - 0s 157ms/step
16/16 [==============================] - 2s 13ms/step - loss: 4.2486
1/1 [==============================] - 0s 151ms/step
17/17 [==============================] - 2s 5ms/step - loss: 4.7256
1/1 [==============================] - 0s 172ms/step
18/18 [==============================] - 2s 5ms/step - loss: 6.0958
1/1 [==============================] - 0s 173ms/step
18/18 [==============================] - 2s 4ms/step - loss: 4.8908
1/1 [==============================] - 0s 125ms/step
19/19 [==============================] - 2s 6ms/step - loss: 5.2627
1/1 [==============================] - 0s 178ms/step
20/20 [==============================] - 2s 4ms/step - loss: 5.0993
1/1 [==============================] - 0s 157ms/step
21/21 [==============================] - 2s 5ms/step - loss: 4.9594
1/1 [==============================] - 0s 157ms/step
21/21 [==============================] - 2s 4ms/step - loss: 5.7965
1/1 [==============================] - 0s 167ms/step
22/22 [==============================] - 2s 7ms/step - loss: 4.9498
1/1 [==============================] - 0s 137ms/step
23/23 [==============================] - 2s 6ms/step - loss: 6.4826
1/1 [==============================] - 0s 165ms/step
24/24 [==============================] - 3s 5ms/step - loss: 4.5981
1/1 [==============================] - 0s 158ms/step
24/24 [==============================] - 2s 8ms/step - loss: 5.8193
1/1 [==============================] - 0s 136ms/step
25/25 [==============================] - 3s 10ms/step - loss: 6.4681
1/1 [==============================] - 0s 242ms/step
26/26 [==============================] - 4s 8ms/step - loss: 6.8173
1/1 [==============================] - 0s 275ms/step
27/27 [==============================] - 3s 8ms/step - loss: 5.9768
1/1 [==============================] - 0s 142ms/step
27/27 [==============================] - 2s 4ms/step - loss: 5.4394
1/1 [==============================] - 0s 131ms/step
28/28 [==============================] - 2s 6ms/step - loss: 5.9651
1/1 [==============================] - 0s 206ms/step
29/29 [==============================] - 2s 4ms/step - loss: 5.9634
1/1 [==============================] - 0s 119ms/step
30/30 [==============================] - 2s 4ms/step - loss: 5.4011
1/1 [==============================] - 0s 161ms/step
30/30 [==============================] - 2s 4ms/step - loss: 7.3872
1/1 [==============================] - 0s 119ms/step
31/31 [==============================] - 2s 5ms/step - loss: 4.2866
1/1 [==============================] - 0s 98ms/step
32/32 [==============================] - 1s 4ms/step - loss: 5.5045
1/1 [==============================] - 0s 90ms/step
33/33 [==============================] - 2s 6ms/step - loss: 6.8318
1/1 [==============================] - 0s 149ms/step
33/33 [==============================] - 1s 6ms/step - loss: 5.9973
1/1 [==============================] - 0s 113ms/step
34/34 [==============================] - 1s 6ms/step - loss: 5.2417
1/1 [==============================] - 0s 90ms/step
35/35 [==============================] - 64s 21ms/step - loss: 4.4081
1/1 [==============================] - 0s 273ms/step
36/36 [==============================] - 3s 5ms/step - loss: 6.6063
1/1 [==============================] - 0s 135ms/step
36/36 [==============================] - 2s 5ms/step - loss: 5.8766
1/1 [==============================] - 0s 174ms/step
37/37 [==============================] - 2s 8ms/step - loss: 3.9826
1/1 [==============================] - 0s 153ms/step
38/38 [==============================] - 3s 5ms/step - loss: 6.4583
1/1 [==============================] - 0s 129ms/step
1/1 [==============================] - 2s 2s/step - loss: 2.4195
1/1 [==============================] - 0s 112ms/step
2/2 [==============================] - 2s 3ms/step - loss: 4.8642
1/1 [==============================] - 0s 161ms/step
3/3 [==============================] - 2s 2ms/step - loss: 3.3173
1/1 [==============================] - 0s 105ms/step
3/3 [==============================] - 2s 12ms/step - loss: 3.2875
1/1 [==============================] - 0s 105ms/step
4/4 [==============================] - 2s 2ms/step - loss: 6.2512
1/1 [==============================] - 0s 199ms/step
5/5 [==============================] - 2s 4ms/step - loss: 5.8195
1/1 [==============================] - 0s 131ms/step
6/6 [==============================] - 1s 4ms/step - loss: 8.1612
1/1 [==============================] - 0s 94ms/step
6/6 [==============================] - 1s 5ms/step - loss: 7.0019
1/1 [==============================] - 0s 118ms/step
7/7 [==============================] - 1s 6ms/step - loss: 6.1682
1/1 [==============================] - 0s 91ms/step
8/8 [==============================] - 2s 5ms/step - loss: 5.8749
1/1 [==============================] - 0s 152ms/step
9/9 [==============================] - 1s 8ms/step - loss: 6.0109
1/1 [==============================] - 0s 130ms/step
9/9 [==============================] - 2s 5ms/step - loss: 5.9922
1/1 [==============================] - 0s 89ms/step
10/10 [==============================] - 2s 4ms/step - loss: 5.5954
1/1 [==============================] - 0s 157ms/step
11/11 [==============================] - 2s 3ms/step - loss: 6.2625
1/1 [==============================] - 0s 75ms/step
12/12 [==============================] - 1s 7ms/step - loss: 5.8119
1/1 [==============================] - 0s 94ms/step
12/12 [==============================] - 1s 3ms/step - loss: 4.6037
1/1 [==============================] - 0s 79ms/step
13/13 [==============================] - 1s 6ms/step - loss: 7.2027
1/1 [==============================] - 0s 122ms/step
14/14 [==============================] - 2s 4ms/step - loss: 6.9502
1/1 [==============================] - 0s 165ms/step
15/15 [==============================] - 2s 8ms/step - loss: 4.8712
1/1 [==============================] - 0s 101ms/step
15/15 [==============================] - 1s 2ms/step - loss: 6.1284
1/1 [==============================] - 0s 113ms/step
16/16 [==============================] - 2s 3ms/step - loss: 4.6166
1/1 [==============================] - 0s 142ms/step
17/17 [==============================] - 2s 7ms/step - loss: 5.1739
1/1 [==============================] - 0s 152ms/step
18/18 [==============================] - 2s 4ms/step - loss: 5.3077
1/1 [==============================] - 0s 128ms/step
18/18 [==============================] - 2s 6ms/step - loss: 6.8379
1/1 [==============================] - 0s 117ms/step
19/19 [==============================] - 1s 3ms/step - loss: 4.1418
1/1 [==============================] - 0s 122ms/step
20/20 [==============================] - 2s 4ms/step - loss: 5.8840
1/1 [==============================] - 0s 183ms/step
21/21 [==============================] - 2s 3ms/step - loss: 5.6779
1/1 [==============================] - 0s 83ms/step
21/21 [==============================] - 1s 5ms/step - loss: 7.2813
1/1 [==============================] - 0s 234ms/step
22/22 [==============================] - 2s 4ms/step - loss: 6.7127
1/1 [==============================] - 0s 184ms/step
23/23 [==============================] - 2s 3ms/step - loss: 7.3255
1/1 [==============================] - 0s 172ms/step
24/24 [==============================] - 2s 5ms/step - loss: 6.1420
1/1 [==============================] - 0s 184ms/step
24/24 [==============================] - 2s 4ms/step - loss: 6.3701
1/1 [==============================] - 0s 134ms/step
25/25 [==============================] - 2s 4ms/step - loss: 4.0715
1/1 [==============================] - 0s 126ms/step
26/26 [==============================] - 2s 4ms/step - loss: 6.4470
1/1 [==============================] - 0s 107ms/step
27/27 [==============================] - 2s 6ms/step - loss: 7.6378
1/1 [==============================] - 0s 278ms/step
27/27 [==============================] - 3s 4ms/step - loss: 6.3135
1/1 [==============================] - 0s 218ms/step
28/28 [==============================] - 2s 4ms/step - loss: 5.8526
1/1 [==============================] - 0s 86ms/step
29/29 [==============================] - 1s 2ms/step - loss: 5.2236
1/1 [==============================] - 0s 174ms/step
30/30 [==============================] - 1s 3ms/step - loss: 6.7635
1/1 [==============================] - 0s 129ms/step
30/30 [==============================] - 1s 4ms/step - loss: 7.0004
1/1 [==============================] - 0s 103ms/step
31/31 [==============================] - 1s 3ms/step - loss: 3.2467
1/1 [==============================] - 0s 159ms/step
32/32 [==============================] - 2s 3ms/step - loss: 5.1964
1/1 [==============================] - 0s 132ms/step
33/33 [==============================] - 2s 3ms/step - loss: 9.2286
1/1 [==============================] - 0s 125ms/step
33/33 [==============================] - 1s 2ms/step - loss: 6.4207
1/1 [==============================] - 0s 87ms/step
34/34 [==============================] - 1s 4ms/step - loss: 6.7724
1/1 [==============================] - 0s 94ms/step
35/35 [==============================] - 2s 3ms/step - loss: 6.0067
1/1 [==============================] - 0s 139ms/step
36/36 [==============================] - 1s 3ms/step - loss: 5.9802
1/1 [==============================] - 0s 83ms/step
36/36 [==============================] - 1s 3ms/step - loss: 5.3353
1/1 [==============================] - 0s 103ms/step
</pre></div>
</div>
</div>
</div>
<p>best_params</p>
<p>(30, 30)</p>
<p>lowest_rmse</p>
<p>2.140124174789503</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Set up the model: model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>

<span class="c1"># Add the first layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_cols</span><span class="p">,)))</span>

<span class="c1"># Add the second layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))</span>

<span class="c1"># Add the output layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># Compile the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>

<span class="c1"># Fit the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">r2</span>
</pre></div>
</div>
</div>
</div>
<p>2056/2056 [==============================] - 6s 2ms/step - loss: 0.5126
686/686 [==============================] - 1s 2ms/step</p>
<p>0.789838058100607</p>
<p>CONCLUSIONES RESPECTO AL ESTUDIO ANTERIOR</p>
<p>Pese a que se pidió evaluar los modelos con MAPE, RMSE y
R cuadrado La métrica MAPE no fué calculada, a continuación las razones:</p>
<p>La variable velocidad del viento tiene valores de cero. Entonces cuando se calculaba el error porcentual entre el valor predicho y el valor real, en esos registros, el resultado de la división era indefinido</p>
<p>Otra opción era poner un número extramadamente pequeño en el denominador para que la operación fuese almenos posible. Pero eso ocasionaba valores de MAPE extremadamente altos que no tienen sentido desde el punto de vista de evaluación de modelo.</p>
<p>Teniendo en cuenta los resultados de cada modelo podemos concluir que el modelo con el mejor valor de RMSE es la regresión mediante support vector machine, el mismo modelo tiene el segundo mejor r cuadrado por lo cuál es el modelo que mejor generaliza a los datos de predicción del viento.</p>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="markdown.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Markdown Files</p>
      </div>
    </a>
    <a class="right-next"
       href="markdown-notebooks.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Notebooks with MyST Markdown</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="simple visible nav section-nav flex-column">
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>